<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>12 Days of Christmas – Reflections from a Pentester - TrebledJ's Pages</title><meta name="description" content="Secure Your Janky Systems, 2024 Edition"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,12 days of christmas – reflections from a pentester,secure your janky systems, 2024 edition,infosec,software-engineering,web,reflection,pentesting"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-5e8R4YC3Atf/5McNMkFk4TZYUtMEItdy9ikt1KUoPSc=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="12 Days of Christmas – Reflections from a Pentester - TrebledJ's Pages"><meta property="twitter:title" content="12 Days of Christmas – Reflections from a Pentester - TrebledJ's Pages"><meta property="og:description" content="Secure Your Janky Systems, 2024 Edition

Over the past year, I've been pentesting various systems, diving into a variety of web apps, mobile apps, IoT devices, desktop apps, and the occasional Active Directory network. Some were..."><meta property="twitter:description" content="Secure Your Janky Systems, 2024 Edition

Over the past year, I've been pentesting various systems, diving into a variety of web apps, mobile apps, IoT devices, desktop apps, and the occasional Active Directory network. Some were..."><meta property="og:url" content="https://trebledj.me/posts/twelve-days-to-secure-your-systems/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/infosec/secure-your-santa/assets/thumbnail-1024w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/infosec/secure-your-santa/assets/thumbnail-1024w.webp"><meta property="article:published_time" content="2024-12-25T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="cybersecurity"><meta property="article:tag" content="infosec"><meta property="article:tag" content="software-engineering"><meta property="article:tag" content="web"><meta property="article:tag" content="reflection"><meta property="article:tag" content="pentesting"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-6e60ae6c5e022aba.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><style></style><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;var reloadDisqus=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");"dark"===e?(setMode("light"),reloadDisqus&&reloadDisqus()):"light"===e?(setMode("dark"),reloadDisqus&&reloadDisqus()):setMode(defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#humans-and-processes-are-the-weakest-link">Humans (and processes) are the weakest link</a><ol><li><a href="#1-myth-modern-tech-is-secure-and-bug-free">1. Myth: Modern tech is secure and bug-free</a></li><li><a href="#2-an-application-is-as-secure-as-its-weakest-link">2. An application is as secure as its weakest link</a></li><li><a href="#3-copy-and-paste-invites-disaster">3. Copy and Paste invites Disaster</a></li></ol></li><li><a href="#general-comments">General comments</a><ol><li><a href="#4-encapsulation-is-good-for-security">4. Encapsulation is good for security</a></li><li><a href="#5-what-a-programmer-finds-useful-an-attacker-often-will-too">5. What a programmer finds useful, an attacker (often) will too</a></li><li><a href="#6-assume-breach">6. Assume breach</a></li></ol></li><li><a href="#software-components-and-the-supply-chain">Software components and the supply chain</a><ol><li><a href="#7-don-t-roll-your-own-auth">7. Don't roll your own auth</a></li><li><a href="#8-patch-your-systems">8. Patch your systems</a></li><li><a href="#9-don-t-solely-rely-on-wafs">9. Don't (solely) rely on WAFs</a></li></ol></li><li><a href="#common-bug-classes">Common bug classes</a><ol><li><a href="#10-string-concatenation-considered-dangerous-s">10. String concatenation considered dangerous /s</a></li><li><a href="#11-knowledge-is-power">11. Knowledge is power</a></li><li><a href="#12-elementary-dear-watson">12. Elementary, dear Watson</a></li></ol></li><li><a href="#tl-dr-and-takeaways">tl;dr and takeaways</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2024-12-25T08:00:00.000+08:00">2024‑12‑25</span></span></div><div class="d-flex flex-row align-items-center"></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">15 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/software-engineering/" itemprop="keywords">software-engineering</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a> </span><span><a class="jtag" href="/tags/reflection/" itemprop="keywords">reflection</a> </span><span><a class="jtag" href="/tags/pentesting/" itemprop="keywords">pentesting</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#humans-and-processes-are-the-weakest-link">Humans (and processes) are the weakest link</a><ol><li><a href="#1-myth-modern-tech-is-secure-and-bug-free">1. Myth: Modern tech is secure and bug-free</a></li><li><a href="#2-an-application-is-as-secure-as-its-weakest-link">2. An application is as secure as its weakest link</a></li><li><a href="#3-copy-and-paste-invites-disaster">3. Copy and Paste invites Disaster</a></li></ol></li><li><a href="#general-comments">General comments</a><ol><li><a href="#4-encapsulation-is-good-for-security">4. Encapsulation is good for security</a></li><li><a href="#5-what-a-programmer-finds-useful-an-attacker-often-will-too">5. What a programmer finds useful, an attacker (often) will too</a></li><li><a href="#6-assume-breach">6. Assume breach</a></li></ol></li><li><a href="#software-components-and-the-supply-chain">Software components and the supply chain</a><ol><li><a href="#7-don-t-roll-your-own-auth">7. Don't roll your own auth</a></li><li><a href="#8-patch-your-systems">8. Patch your systems</a></li><li><a href="#9-don-t-solely-rely-on-wafs">9. Don't (solely) rely on WAFs</a></li></ol></li><li><a href="#common-bug-classes">Common bug classes</a><ol><li><a href="#10-string-concatenation-considered-dangerous-s">10. String concatenation considered dangerous /s</a></li><li><a href="#11-knowledge-is-power">11. Knowledge is power</a></li><li><a href="#12-elementary-dear-watson">12. Elementary, dear Watson</a></li></ol></li><li><a href="#tl-dr-and-takeaways">tl;dr and takeaways</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">12 Days of Christmas – Reflections from a Pentester</h1><p class="post-desc" itemprop="alternativeHeadline">Secure Your Janky Systems, 2024 Edition</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2024-12-25T08:00:00.000+08:00">2024‑12‑25</span></span></div><div class="d-flex flex-row align-items-center"></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">15 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/software-engineering/" itemprop="keywords">software-engineering</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a> </span><span><a class="jtag" href="/tags/reflection/" itemprop="keywords">reflection</a> </span><span><a class="jtag" href="/tags/pentesting/" itemprop="keywords">pentesting</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/secure-your-santa/assets/thumbnail-1024w.webp" loading="eager" decoding="async" style="aspect-ratio: auto 1024 / 1024" alt="12 Days of Christmas – Reflections from a Pentester" title="12 Days of Christmas – Reflections from a Pentester" srcset="/img/posts/infosec/secure-your-santa/assets/thumbnail-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/thumbnail-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1024px"><p>Over the past year, I've been pentesting various systems, diving into a variety of web apps, mobile apps, IoT devices, desktop apps, and the occasional Active Directory network. Some were ancient projects wielding unmaintained code. Some were using popular modern tech stacks. Each software was unique, but a lot were plagued by common issues.</p><p>So to end this year, I thought it would be nice to reflect on the technical shenanigans I've experienced, and to share some observations with the IT industry. In this post, I’ll present 12 observations/tips to help you secure your systems, supplemented by anecdotes from breaking terrible software. We'll go from non-technical comments to more technical bugs. (But not too technical, I promise, I'll save those for other posts.)</p><ol><li><a href="#humans-are-the-weakest-link">Humans (and processes) are the weakest link.</a></li><li><a href="#general-comments">General Comments</a></li><li><a href="#software-components-and-the-supply-chain">Software Components and the Supply Chain</a></li><li><a href="#common-bug-classes">Common Bug Classes</a></li></ol><p><em>Disclaimer: All examples included below are based on examples from real-life penetration tests, but details have been fudged to protect confidential information <s>and ensure I don’t get fired</s>. No mention/screenshots of the original targets are included.</em></p><h2 id="humans-and-processes-are-the-weakest-link" tabindex="-1"><a class="md-anchor" href="#humans-and-processes-are-the-weakest-link" aria-hidden="true"></a> Humans (and processes) are the weakest link</h2><p>Here's a great quote by a well-known cybersecurity professional:</p><blockquote><p><em>People often represent the weakest link in the security chain and are chronically responsible for the failure of security systems.</em><br>- Bruce Schneier</p></blockquote><p>While this is a common occurrence with phishing attacks, sometimes I think this puts too much responsibility on humans. It's also crucial to develop processes to counter threats at the macro/institutional level, rather than just the micro level.</p><p>Let's start by busting a myth.</p><h3 id="1-myth-modern-tech-is-secure-and-bug-free" tabindex="-1"><a class="md-anchor" href="#1-myth-modern-tech-is-secure-and-bug-free" aria-hidden="true"></a> 1. Myth: Modern tech is secure and bug-free</h3><blockquote><p>Modern tech is secure and bug-free. A modern language/library/framework will handle security for us.</p></blockquote><p>Wrong! Modern tech isn't immune to security issues, let alone bugs. It may <em>employ more secure design principles</em>, but that doesn't eliminate every single class of security issues.</p><p>Here are a few examples:</p><ul><li>I’ve witnessed Vue, React, and NextJS apps riddled with bugs, including broken logic, broken authentication, and injection vulnerabilities. (ChatGPT? Is that you?)</li><li>HTMX, <a href="https://htmx.org/essays/web-security-basics-with-htmx/" rel="noreferrer" target="_blank">if used improperly</a>, exposes an app to cross-site scripting (XSS). This issue is further compounded by forcing <code>unsafe-eval</code> in your site's <a href="https://www.sjoerdlangkemper.nl/2024/06/26/htmx-content-security-policy/" rel="noreferrer" target="_blank">Content Security Policy</a>.</li><li>Rust has its fair share of <a href="https://www.cve.org/CVERecord?id=CVE-2023-50711" rel="noreferrer" target="_blank">deserialisation</a> and <a href="https://www.cvedetails.com/cve/CVE-2018-1000810/" rel="noreferrer" target="_blank">integer overflow</a> issues.</li></ul><p>Using modern technology is not an excuse to eliminate security programs.</p><p>But why is software still insecure even though the tech is new?</p><h3 id="2-an-application-is-as-secure-as-its-weakest-link" tabindex="-1"><a class="md-anchor" href="#2-an-application-is-as-secure-as-its-weakest-link" aria-hidden="true"></a> 2. An application is as secure as its weakest link</h3><p>A common saying in cybersecurity goes like this:</p><blockquote><p><em>Attackers only have to be right once. Security teams need to be right all the time.</em></p></blockquote><p>This isn’t exactly true, depending on how you apply defences and controls; but it does highlight how a <strong>single weak link compromises security</strong>, bypassing the hard work applied elsewhere.</p><p><a class="lightbox-single" title="Remember Log4Shell? Such an exciting Christmas." href="/img/posts/infosec/secure-your-santa/assets/vulnerable-component-625w.webp"><img class="mb-2 rw center jw-60" src="/img/posts/infosec/secure-your-santa/assets/vulnerable-component-625w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 625 / 500" alt="Remember Log4Shell? Such an exciting Christmas." title="Remember Log4Shell? Such an exciting Christmas." srcset="/img/posts/infosec/secure-your-santa/assets/vulnerable-component-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/vulnerable-component-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/vulnerable-component-625w.webp 625w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 625px"></a></p><p class="caption"><sup>Remember <a href="https://en.wikipedia.org/wiki/Log4Shell" rel="noreferrer" target="_blank">Log4Shell</a>? Such an exciting Christmas.</sup></p><p>Ultimately, this comes down to humans and processes.</p><ol><li><strong>Humans.</strong><ul><li>Many breaches start from an innocuous phishing email. A couple of clicks is all it takes to compromise a computer.</li><li>Insufficient training and cybersecurity awareness may lead to poor security practices, such as storing passwords in plain text or using weak passwords.</li><li>Driven by looming deadlines and milestones, devs may inadvertently overlook logical aspects, resulting in buggy software. Despite the advancements of modern technologies and AI, the human factor remains a fundamental component in software development.</li></ul></li><li><strong>Processes.</strong> These are your workflows, CI/CD pipelines, monthly access reviews, etc.<ul><li>Arguably, processes are also a human problem stemming from <strong>inadequate management and supervision</strong>. We humans are prone to forgetfulness, particularly when guidelines are communicated verbally rather than documented in writing. This underscores the significance of establishing structured processes.</li><li>Absence of a <strong>dependency management and maintenance process</strong> allows vulnerable components to linger in your codebase like a festering wound. Unmaintained code and technical debt pile up, ever-increasing the risk of a system. Consider using Software Component Analysis (SCA) to automate dependency checks.</li><li>Absence of <strong>DevSecOps and security in the Software Development Lifecycle (SDLC)</strong> increase the presence of easily exploitable vulnerabilities. These bugs, often considered low-hanging fruit, are favoured by ransomware groups seeking quick exploits. By using automated tools such as Static/Dynamic Application Security Testing (SASTs and DASTs), you can identify common bugs and thus enhance your application's security posture.</li><li>Lack of <strong>continuous auditing and oversight</strong> may inadvertently lead to breaches. Don’t be surprised when your <a href="https://www.bleepingcomputer.com/news/security/microsoft-reveals-how-hackers-breached-its-exchange-online-accounts/" rel="noreferrer" target="_blank">legacy test accounts bite you in the butt</a>!</li></ul></li></ol><p>You want your application secured? Invest in your talent. Review code. Improve your processes. Stay humble.</p><h3 id="3-copy-and-paste-invites-disaster" tabindex="-1"><a class="md-anchor" href="#3-copy-and-paste-invites-disaster" aria-hidden="true"></a> 3. Copy and Paste invites Disaster</h3><p><a class="lightbox-single" title="“Hi Disaster, I'm Paste! How do you do? And this is my friend Copy. We're so excited to work together on this project and to create great impact in the shortest amount of time possible!”" href="/img/posts/infosec/secure-your-santa/assets/copy-paste-disaster-749w.webp"><img class="mb-2 rw center jw-65" src="/img/posts/infosec/secure-your-santa/assets/copy-paste-disaster-749w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 749 / 500" alt="“Hi Disaster, I'm Paste! How do you do? And this is my friend Copy. We're so excited to work together on this project and to create great impact in the shortest amount of time possible!”" title="“Hi Disaster, I'm Paste! How do you do? And this is my friend Copy. We're so excited to work together on this project and to create great impact in the shortest amount of time possible!”" srcset="/img/posts/infosec/secure-your-santa/assets/copy-paste-disaster-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/copy-paste-disaster-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/copy-paste-disaster-749w.webp 749w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 749px"></a></p><p class="caption"><sup><em>"Hi Disaster, I'm Paste! How do you do? And this is my friend Copy. We're so excited to work with you on this project and create great impact together!"</em></sup></p><p>One recurring joke among programmers is “code is often copy and pasted”. As it turns out, this can lead to severe consequences.</p><details open><summary>Example: CMS</summary><div class="details-content"><p>One time I came across a custom <abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Content Management System, a platform for managing content such as blog posts, announcements, and news">CMS</abbr> with two roles (admin and user) and encountered the following endpoints:</p><ol><li><p>An admin endpoint which saves a draft, but optionally allows publishing by setting <code>"publish": true</code>.</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/api/v1/admin/post/save</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">redacted.com</span></span>
<span class="token header"><span class="token header-name keyword">Authorization</span><span class="token punctuation">:</span> <span class="token header-value">Bearer &lt;admin token&gt;</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">XXX</span></span>
<span class="token application-json">
<span class="token punctuation">{</span>
    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"The quick brown fox jumps over the lazy dog."</span><span class="token punctuation">,</span>
    <span class="token property">"publish"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div></li><li><p>A similar endpoint which only allows <em>normal users</em> to save a draft.</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/api/v1/user/post/save</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">redacted.com</span></span>
<span class="token header"><span class="token header-name keyword">Authorization</span><span class="token punctuation">:</span> <span class="token header-value">Bearer &lt;user token&gt;</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">XXX</span></span>
<span class="token application-json">
<span class="token punctuation">{</span>
    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"But the dog retaliated and jumped over the brown fox!"</span>
<span class="token punctuation">}</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>By design, all publishing should be done by the admin, <strong>normal users shouldn’t have rights to publish</strong> (hence, no <code>publish</code> parameter by default).</p></li></ol><p>On a whim, I copied the <code>"publish": true</code> parameter to <code>/user/post/save</code>.</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/api/v1/user/post/save</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">redacted.com</span></span>
<span class="token header"><span class="token header-name keyword">Authorization</span><span class="token punctuation">:</span> <span class="token header-value">Bearer &lt;user token&gt;</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">XXX</span></span>
<span class="token application-json">
<span class="token punctuation">{</span>
    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"But the dog retaliated and jumped over the brown fox!"</span><span class="token punctuation">,</span>
    <span class="token property">"publish"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Oops,&nbsp;disaster! The post got published! It's apparent both endpoints use the same underlying logic. The <code>publish</code> parameter should have only been implemented for admins. The implications are somewhat severe, if you have user access — say an intern, a secretary, or a test account — you could bypass the usual approval process and publish something damning like “Megacorp is Filing for Bankruptcy!”.</p><div class="details-collapse-bottom"><sub><a class="details-collapse-button">(collapse)</a></sub></div></div></details><p>This is just one illustration of the dangers of copy-and-paste. I’m sure there are graver examples out there.</p><h2 id="general-comments" tabindex="-1"><a class="md-anchor" href="#general-comments" aria-hidden="true"></a> General comments</h2><p>During my pentesting experience, I observed countless poor designs, but also some well-hardened ones! Here are three such observations, generalised and applicable across the industry.</p><h3 id="4-encapsulation-is-good-for-security" tabindex="-1"><a class="md-anchor" href="#4-encapsulation-is-good-for-security" aria-hidden="true"></a> 4. Encapsulation is good for security</h3><p>In software engineering, encapsulation refers to the practice of bundling data and methods within a class, allowing for better <em>access control over data</em> and preventing <em>unintended modifications</em>. In most object-oriented programming languages, you control access by declaring functions to be <code>public</code> (callable by anyone) or <code>private</code> (callable within the class).</p><details><summary>C++ Example</summary><div class="details-content"><p>As a recap, here's an example of a <code>BankAccount</code> class in C++. Notice how we applied encapsulation by restricting modifications to the balance. We’re not allowed to multiply it, bitshift it, or dereference it. We can only deposit and withdraw (with certain restrictions).</p><div class="code-toolbar"><pre class="language-cpp" tabindex="0"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">BankAccount</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> accountNumber<span class="token punctuation">;</span>
    <span class="token keyword">double</span> balance<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">BankAccount</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">accountNumber</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">balance</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        balance <span class="token operator">+=</span> amount<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Deposit of $"</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> <span class="token string">" successful."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>amount <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdrawal limit exceeded. Maximum withdrawal amount is $1000."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">-</span> amount <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Insufficient funds. Withdrawal not allowed."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            balance <span class="token operator">-=</span> amount<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdrawal of $"</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> <span class="token string">" successful."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">displayAccountDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Account Number: "</span> <span class="token operator">&lt;&lt;</span> accountNumber <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Balance: $"</span> <span class="token operator">&lt;&lt;</span> balance <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    BankAccount <span class="token function">myAccount</span><span class="token punctuation">(</span><span class="token number">123456</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myAccount<span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Balance: 500</span>
    myAccount<span class="token punctuation">.</span><span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Balance: 300</span>
    myAccount<span class="token punctuation">.</span><span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: insufficient funds.</span>
    myAccount<span class="token punctuation">.</span><span class="token function">displayAccountDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">C++</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>If our <code>balance</code> was <code>public</code>, what stops programmers who use this class from accidentally setting the balance to a negative number?</p><div class="details-collapse-bottom"><sub><a class="details-collapse-button">(collapse)</a></sub></div></div></details><p>This enhances security by restricting direct access to sensitive information and promoting a more structured software design. By encapsulating components, you hide potentially vulnerable states and separate interactions between components.</p><p>Encapsulation is generally well-understood in computer programs, but less so from a systems design or software architecture perspective.</p><p>Here are some interesting examples of encapsulation I've observed.</p><ol><li><p>In a recent pentest, we managed to find an SQL injection vulnerability to a PostgreSQL database. In MySQL and SQL Server, we can access other databases by calling <code>use xyz;</code> or <code>select * from xyz..table</code>. But —&nbsp;from my limited understanding — PostgreSQL <strong>doesn’t allow access to other databases</strong>. Theoretically, this means devs can logically segregate data while reaping security benefits. For instance, compromising a <code>config</code> database won't impact the <code>users</code> database.</p><p>There are <a href="https://stackoverflow.com/questions/46324/possible-to-perform-cross-database-queries-with-postgresql" rel="noreferrer" target="_blank">workarounds</a> to bypass this restriction, but I think this is a good first step towards designing secure encapsulated systems, and I really hope we can see more of this across the IT (and OT<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>) industry.</p></li><li><p>Common in regulated industries (such as finance) is the segregation of <em>customer identification data</em>, i.e. personal information such as name, ID number, phone number, home address, and email address. These may compromise a customers' privacy if leaked. Customer data should be encapsulated in a separate database with strong encryption and access control.</p></li><li><p>During several network pentests, we discovered poorly encapsulated systems with public read/write access. To make things worse, access control was neither available nor considered at the design level (i.e. there was no config option to flip), so there wasn't much to do except apply preventative/detective controls.</p></li></ol><h3 id="5-what-a-programmer-finds-useful-an-attacker-often-will-too" tabindex="-1"><a class="md-anchor" href="#5-what-a-programmer-finds-useful-an-attacker-often-will-too" aria-hidden="true"></a> 5. What a programmer finds useful, an attacker (often) will too</h3><p>If you will, another story. During a penetration test, we encountered a <em>very old</em> piece of software with debug functions allowing the user to print arbitrary information (such as variables and the program stack) from the server. Understandably, tooling during Programming Antiquity wasn't great, so the developers came up with this function to aid sysadmins in reporting and troubleshooting. However, this function proved alarmingly insecure, allowing us to access and read all user passwords (including admins!) with ease. Additionally, the password for regular users was predictably simple, allowing one to swiftly escalate from zero to admin...</p><p><a class="lightbox-single" title="Footguns come in many forms." href="/img/posts/infosec/secure-your-santa/assets/information-disclosure-footguns-631w.webp"><img class="mb-2 rw center jw-70" src="/img/posts/infosec/secure-your-santa/assets/information-disclosure-footguns-631w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 631 / 395" alt="Footguns come in many forms." title="Footguns come in many forms." srcset="/img/posts/infosec/secure-your-santa/assets/information-disclosure-footguns-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/information-disclosure-footguns-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/information-disclosure-footguns-631w.webp 631w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 631px"></a></p><p class="caption"><sup>Footguns come in many forms.</sup></p><p>Awareness is better these days, but insecure practices are still common. Leaving behind debug mode could save a day's worth of triaging, but it could also disclose file paths and source code (very valuable for web attacks)! We see this elsewhere too. Web developers forget to remove source maps. Embedded engineers leave behind UART ports.</p><p>Any tools left behind can be used for both good and malicious purposes. After all, devs and cybersecurity specialists have overlapping toolsets, think: gdb, browser devtools, logic analysers, and <a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging" rel="noreferrer" target="_blank">rubber duckies</a>. But sometimes the risk of malicious use outweighs the convenience.</p><p>Here are some common conveniences which can <em>really</em> bite you in the butt:</p><ul><li><strong>Leaving an admin page or internal app open to the public internet.</strong> This is hella convenient because then you can login from anywhere. But it's not very secure because... you can login from anywhere! Attackers can use the login page to brute-force usernames and potentially gain access.</li><li><strong><a href="#11-knowledge-is-power">Information and version disclosures</a></strong>. These are things like error messages, swagger API pages, and version numbers. As we'll see later, this can expedite attacks.</li><li><strong>Using default or weak passwords for ease of remembering.</strong> While convenient, weak passwords are more susceptible to brute force attacks and unauthorised access.</li></ul><p>The first step to breaking an application is to find out what it uses and what it does. On the flip side, the first step to securing your production environment is to strip out debug functionality and enable secure configurations. And sometimes this requires sacrificing convenience for security.</p><h3 id="6-assume-breach" tabindex="-1"><a class="md-anchor" href="#6-assume-breach" aria-hidden="true"></a> 6. Assume breach</h3><p>This is one of those mindsets to promote security in the Software Development Lifecycle (SDLC). This is meant to complement, rather than replace, ideas such as "Shift Left".</p><p>In red teaming (Active Directory pentesting) scenarios, we often "assume breach", by simulating scenarios where 1) attackers have successfully broken in (via phishing, exploits, or physical connections), or 2) there is an impostor (aka malicious insider) among us! Often, we find businesses have insufficient oversight into their network.</p><p>Breaches are a stark reality in today's cybersecurity landscape. Instead of assuming that a segregated network is impenetrable, apply defence-in-depth and set appropriate security controls.</p><h2 id="software-components-and-the-supply-chain" tabindex="-1"><a class="md-anchor" href="#software-components-and-the-supply-chain" aria-hidden="true"></a> Software components and the supply chain</h2><p>The events this year (2024) highlight how third-party components and underlying infrastructure (dubbed "the supply chain") can pose heavy risks to security. Let's have a quick recap:</p><ul><li><a href="https://www.bleepingcomputer.com/news/security/microsoft-reveals-how-hackers-breached-its-exchange-online-accounts/" rel="noreferrer" target="_blank">Microsoft Exchange Online breached</a> - disclosed January 2024 - impacted numerous organisations, e.g. Hewlett Packard</li><li>The <a href="https://en.wikipedia.org/wiki/XZ_Utils_backdoor" rel="noreferrer" target="_blank">xzutils backdoor</a> - February 2024 - would have potentially affected millions of SSH installations, if not discovered in time</li><li><a href="https://blog.qualys.com/vulnerabilities-threat-research/2024/06/28/polyfill-io-supply-chain-attack" rel="noreferrer" target="_blank">Polyfill.io Supply Chain Attack</a> - June 2024 - domain purchase + delivery of malicious scripts via CDNs affecting 100K+ sites (potentially billions of users)</li><li>The <a href="https://en.wikipedia.org/wiki/2024_CrowdStrike-related_IT_outages" rel="noreferrer" target="_blank">CrowdStrike incident</a> (non-malicious and unintentional) - July 2024 - impacted 8.5 million Windows computers, caused massive disruptions to airports and financial services</li><li><a href="https://www.bleepingcomputer.com/news/security/us-says-chinese-hackers-breached-multiple-telecom-providers/" rel="noreferrer" target="_blank">Compromised network infrastructure in the US</a> - disclosed October 2024 - confidential communications leaked, further impact to be determined?</li></ul><p><a class="lightbox-single" title="What? Dependencies can be hacked? Adapted from XKCD #2347 - Dependency." href="/img/posts/infosec/secure-your-santa/assets/dependency-500w.webp"><img class="mb-2 rw center jw-50" src="/img/posts/infosec/secure-your-santa/assets/dependency-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 635" alt="What? Dependencies can be hacked? Adapted from XKCD #2347 - Dependency." title="What? Dependencies can be hacked? Adapted from XKCD #2347 - Dependency." srcset="/img/posts/infosec/secure-your-santa/assets/dependency-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/dependency-500w.webp 500w" sizes="(max-width: 256px) 256px, 500px"></a></p><p class="caption"><sup>What? Dependencies can be hacked? Adapted from XKCD #2347 - Dependency</sup></p><p>Amidst this chaos, I think there's something we can pick out and learn from these incidents:</p><ul><li>Why do we even use a supply chain?</li><li>Safeguard your supply chain.</li><li>Be sceptical of your supply chain.</li></ul><p>Let's start by justifying supply chains with a common piece of advice.</p><h3 id="7-don-t-roll-your-own-auth" tabindex="-1"><a class="md-anchor" href="#7-don-t-roll-your-own-auth" aria-hidden="true"></a> 7. Don't roll your own auth</h3><p>...unless you know what you're doing! This is old news to some. Here, auth refers authentication, such as registration, login, federated logins (e.g. OAuth, SSO), and —&nbsp;to some extent, access control. There are reasons <em>for</em> and <em>against</em> developing a custom auth. Let's go through them very quickly:</p><p>Reasons to roll your own auth:</p><ul><li><strong>Customization</strong>: Off-the-shelf solutions may not always meet your needs and requirements.</li><li><strong>Ownership</strong>: You want to take responsibility for your own security and not be reliant on third-party systems.</li></ul><p>Reasons to <em><strong>not</strong></em> roll your own auth:</p><ul><li><strong>Security</strong>: Developing a secure authentication system demands a high level of understanding potential security vulnerabilities.</li><li><strong>Time and Resources</strong>: Building a custom, fully-tested system can be time-consuming and resource-intensive.</li><li><strong>Maintenance</strong>: Custom solutions require maintenance in the wake of evolving security threats and business requirements.</li></ul><p>I've seen teams happily roll their own auth just to fail miserably when we discover a ton of unexpected security issues. Sure, custom implementations may be needed; but most of the time, you should opt for a <em>mature, battle-tested</em> library. Even then you should be aware of what features those libraries offer and configure proper defaults.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup></p><p>To give you a taste of the complexity of auth security, here are a slew of test cases we consider when dealing with auth and access control:</p><ul><li>Does your system rate-limit requests? Many controls can be bypassed by brute force.</li></ul><p><a class="lightbox-single" title="'First try!' (from *The Lego Movie*)" href="/img/posts/infosec/secure-your-santa/assets/batman-rate-limiting-358w.webp"><img class="mb-2 rw center jw-50" src="/img/posts/infosec/secure-your-santa/assets/batman-rate-limiting-358w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 358 / 231" alt="'First try!' (from *The Lego Movie*)" title="'First try!' (from *The Lego Movie*)" srcset="/img/posts/infosec/secure-your-santa/assets/batman-rate-limiting-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/batman-rate-limiting-358w.webp 358w" sizes="(max-width: 256px) 256px, 358px"></a></p><p class="caption"><sup>5,427 iterations in: first try!</sup></p><ul><li>Is your input properly checked and sanitised?</li><li>In a multistep registration process, do you check whether the previous registration steps have completed?</li><li>Can your JWTs be tampered with? Is a strong key used?</li><li>Are your access tokens invalidated after logout? Are your refresh tokens invalidated after a refresh?</li><li>Do you properly hash and store your secrets?</li><li>Are permissions properly checked?</li><li>Is your database properly configured?</li></ul><div class="alert alert-success d-flex align-items-start"><i class="fas fa-lightbulb ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>When you roll your own auth, you don’t just deal with “auth issues”. You need to deal with logic issues, session handling, cryptographic issues, injection issues, and other potential attacks. The inherent complexities compel many teams to <em>avoid</em> reinventing the wheel.</p><p>This doesn’t apply only to auth. In general, any complex system will have a myriad of test cases. The common saying is: if it’s mission-critical, build it yourself.<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> Otherwise, is the complexity really worth it?</p></div></div><h3 id="8-patch-your-systems" tabindex="-1"><a class="md-anchor" href="#8-patch-your-systems" aria-hidden="true"></a> 8. Patch your systems</h3><p>Earlier, we mentioned that using mature, battle-tested components tends to be more secure and convenient compared to reinventing your own from scratch.</p><p>But the flipside to this is: <strong>dependencies are also an attack surface</strong>. This is evident from the recent supply chain attacks and incidents.</p><div class="alert alert-info d-flex align-items-start"><i class="fas fa-bolt ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>Is rolling your own auth better? Is using a third-party component better? There’s no clear right or wrong answer. This will depend on your situation, your business strategy, your manpower, and ultimately the risk you’re willing to take. Either way, upholding a robust security posture is essential for the long-term success of any project.<sup class="footnote-ref"><a href="#fn4" id="fnref4">4</a></sup></p></div></div><p><a href="#2-an-application-is-as-secure-as-its-weakest-link">Previously, we discussed processes to reduce the risk of supply chain attacks</a>, such as dependency management and <abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Software Component Analysis">SCA</abbr>. Relevant to this discussion is: <strong>Should you automatically apply patches/updates?</strong> Here's the breakdown:</p><ul><li>If you don’t auto-apply updates... Your system is stable, but you risk exposing yourself to critical issues in the long term, unless you manually update. (Decent strategy for production-critical systems, such as life-support at a hospital?)</li><li>If you auto-apply updates... You get the latest features and security fixes, but you risk ingesting a supply chain attack (like xzutils). Even so, a patch for that attack will be auto-applied. (Good strategy for high-risk items with many vulnerabilities like routers, your OS, your browser.)</li></ul><p>For this site (static site generator with npm dependencies), I use a hybrid approach by auto-applying minor updates but manually upgrading + testing major updates.</p><h3 id="9-don-t-solely-rely-on-wafs" tabindex="-1"><a class="md-anchor" href="#9-don-t-solely-rely-on-wafs" aria-hidden="true"></a> 9. Don't (solely) rely on WAFs</h3><p>You think <abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Web Application Firewalls">WAFs</abbr> will protect your smelly derelict backlogged spaghetti codebase? Think again.</p><details open><summary>Example: WAF did not protect against RCE.</summary><div class="details-content"><p>One time I was pentesting a PHP web app using an outdated web framework. I quickly discovered the framework version and proceeded to execute <abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Remote Code Execution, a high-impact vulnerability class">RCE</abbr> exploits available on the web. Unfortunately, the WAF blocked payloads based on common keywords: <code>system</code>, <code>phpinfo</code>, <code>fopen</code>. To bypass their denylist, I could try different PHP functions... but there’s a much easier trick.</p><p>Most WAFs, to enhance performance, will ignore request bodies with body lengths above a certain limit. This means we can smuggle malicious payloads in plain sight by simply adding a big fat parameter.</p><p>Before:</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/foo</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">example.com</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">26</span></span>

function=system&amp;arg=whoami</code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>After:</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/foo</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">example.com</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">9000</span></span>

function=system&amp;arg=whoami&amp;bigfatparameter=AAAAAAAA...8000+ characters...AAA</code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>The result? We were able to bypass the WAF, execute commands, noodle around the filesystem, read source code, and more.</p><div class="details-collapse-bottom"><sub><a class="details-collapse-button">(collapse)</a></sub></div></div></details><div class="alert alert-success d-flex align-items-start"><i class="fas fa-lightbulb ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>Simply applying a WAF is ineffective unless other countermeasures such as regular patches, logging, and monitoring are also applied.<sup class="footnote-ref"><a href="#fn4" id="fnref4:1">4</a></sup></p></div></div><h2 id="common-bug-classes" tabindex="-1"><a class="md-anchor" href="#common-bug-classes" aria-hidden="true"></a> Common bug classes</h2><p>Apart from buggy auth and vulnerable components, there are a few other bug classes I frequently encounter in the realm of web and mobile applications:</p><ol><li>Injection Bugs (SQL injection, XSS, template injection)</li><li>Information Disclosure (versions, file paths, error messages)</li><li>Logic/Design Bugs (Business Logic, Race Conditions)</li></ol><p>These aren't the only bugs in the wild, but they're worth pointing out as I seem to encounter these in almost every application I test.</p><h3 id="10-string-concatenation-considered-dangerous-s" tabindex="-1"><a class="md-anchor" href="#10-string-concatenation-considered-dangerous-s" aria-hidden="true"></a> 10. String concatenation considered dangerous /s</h3><p><a class="lightbox-single" title="Strings, amirite?" href="/img/posts/infosec/secure-your-santa/assets/strings-577w.webp"><img class="mb-2 rw center jw-60" src="/img/posts/infosec/secure-your-santa/assets/strings-577w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 577 / 433" alt="Strings, amirite?" title="Strings, amirite?" srcset="/img/posts/infosec/secure-your-santa/assets/strings-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/strings-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/strings-577w.webp 577w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 577px"></a></p><p class="caption"><sup>Strings, amirite?</sup></p><p>Despite its diminishing presence, <strong>injection vulnerabilities</strong> are still a dangerous, prevalent class of bugs. This includes vulnerabilities such as SQL injection (SQLi) and cross-site scripting (XSS). Discovery and exploitation techniques are widely documented and understood, underscoring the significant risk these vulnerabilities can have on application security.</p><p>Let's address some concerns:</p><ol><li>How do injection issues arise?<ul><li>Typically, they arise when accepting unsanitised text fields and query parameters in HTTP requests. For example:<ul><li>search function on a website (SQLi)</li><li>logging of user agents and parameters (SQLi)</li><li>trusting (failing to sanitise) a URL parameter (XSS)</li><li>Web 2.0 user content submission, e.g. comments, posts (<abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Server-Side Template Injection">SSTI</abbr>)</li><li>many more subtle cases!</li></ul></li><li>Generally, using allowlists are better than denylists. Instead of preventing quotes in an address field, allow only letters, numbers, spaces, and commas.</li></ul></li><li>Can an application still be vulnerable to SQLi attacks even if the backend does not directly return database values in the response?<ul><li>Yes. Attackers can exfiltrate data through other means, such as...<ul><li>error-based techniques, i.e. stringifying data in an error message (very commonly overlooked);</li><li><a href="/posts/automating-boolean-sql-injection-with-python">blind techniques, i.e. checking the status code, response body, or response time</a>; and</li><li>out-of-band techniques, i.e. checking DNS/HTTP requests.</li></ul></li></ul></li><li>What are some ways to protect against injection issues? Here are some good examples I’ve observed:<ul><li><strong>Input Validation</strong><ul><li>Numbers should be validated. Strings should be escaped. Enums should be validated against an allowlist.</li><li>Don't trust user/database values. Sanitise user content to be inserted into HTML with sanitisers such as DOMPurify. This is especially crucial for CMSs and chatrooms.</li></ul></li><li><strong>Parameterized Queries</strong><ul><li>Use parameterized queries in database interactions to prevent SQL injection attacks. This approach separates SQL code from user input, reducing the risk of malicious code execution and data leaks.</li></ul></li></ul></li></ol><h3 id="11-knowledge-is-power" tabindex="-1"><a class="md-anchor" href="#11-knowledge-is-power" aria-hidden="true"></a> 11. Knowledge is power</h3><p><strong>Information disclosure</strong> is a severely underestimated issue with the potential to accelerate attacks.</p><p>What might a typical hacking scenario look like? With thousands of exploits and vulnerabilities out there, I have no idea where to start. So I'll start by narrowing the possibilities. What tech are you using? What libraries, frameworks, versions? If I know all this, I can narrow my search drastically.</p><p><a class="lightbox-single" title="On ExploitDB, searching for PHP exploits yields 7000+ results, whereas a more refined search for CMSimple v5 shows only 5 exploits — much more palatable!" href="/img/posts/infosec/secure-your-santa/assets/enumeration-is-awesome-775w.webp"><img class="mb-2 rw center jw-85" src="/img/posts/infosec/secure-your-santa/assets/enumeration-is-awesome-775w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 775 / 497" alt="On ExploitDB, searching for PHP exploits yields 7000+ results, whereas a more refined search for CMSimple v5 shows only 5 exploits — much more palatable!" title="On ExploitDB, searching for PHP exploits yields 7000+ results, whereas a more refined search for CMSimple v5 shows only 5 exploits — much more palatable!" srcset="/img/posts/infosec/secure-your-santa/assets/enumeration-is-awesome-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/enumeration-is-awesome-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/enumeration-is-awesome-775w.webp 775w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 775px"></a></p><p class="caption"><sup>It's a lot easier to hunt for exploits when you know the target systems.</sup></p><p>In one scenario, we obtained remote code execution (RCE) within an hour, simply because a version disclosure expedited our search for exploits. It probably would have taken days otherwise.</p><p>Here are some good tips to consider:</p><div class="alert alert-info d-flex align-items-start"><i class="fas fa-bolt ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><ol><li><p>Instead of showing version information publicly, consider hiding it behind authentication. This means</p><ul><li>An attacker won't immediately have the version. They'd need valid credentials first, which can be a pain if safeguarded appropriately.</li><li>An <em>actual</em> admin will still be able to access that version information after login. It's just a couple extra steps.</li></ul></li><li><p>Disable "debug mode" in production.</p></li><li><p>Response headers! Don't return:</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>
<span class="token header"><span class="token header-name keyword">Server</span><span class="token punctuation">:</span> <span class="token header-value">Apache/2.4.49</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Rather, return:</p><div class="code-toolbar"><pre class="language-http" tabindex="0"><code class="language-http"><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>
<span class="token header"><span class="token header-name keyword">Server</span><span class="token punctuation">:</span> <span class="token header-value">Apache</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">HTTP</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Or better yet, don't include the software framework at all! For instance, AWS’s load balancer will return <code>Server: awselb</code>.</p></li></ol></div></div><h3 id="12-elementary-dear-watson" tabindex="-1"><a class="md-anchor" href="#12-elementary-dear-watson" aria-hidden="true"></a> 12. Elementary, dear Watson</h3><p><strong>Logic</strong> is the essence of software. Unfortunately, security flaws often arise from broken logic.</p><ul><li><strong>Business Logic Bypasses</strong>: These are bugs like: reusing a coupon, bypassing the chain of approval, bypassing a limit. Imagine how many more bugs there would be, with the "help" of AI.</li><li><strong>Race Conditions</strong>: Popularised last year by <a href="https://portswigger.net/research/smashing-the-state-machine" rel="noreferrer" target="_blank">PortSwigger's whitepaper "Smashing the state machine"</a>, these are subtle bugs which exploit concurrency issues or vulnerable "substates" (i.e. a request may alter the application state multiple times). Fixes could be anything from redesigning SQL schemas to shuffling a few lines of code.</li></ul><p>These vulnerabilities tend to bypass controls such as:</p><ul><li><strong>permissions and access control</strong> ("only admins are allowed to do XYZ", but it turns out normal users can too!) and</li><li><strong>limits</strong> ("only three books can be checked out from the library at a given time", but this was only enforced in the client-side JS!).</li></ul><p>Most scanners don't tend to catch these, since business logic is unique to each environment. The impacts can be benign or severe. Maybe extra upvotes aren't too harmful. But a user gaining admin access is.</p><p>If you're interested in seeing a Business Logic Bypass story, you can read the example in <a href="#3-copy-and-paste-invites-disaster">Copy and Paste Invites Disaster</a>.</p><h2 id="tl-dr-and-takeaways" tabindex="-1"><a class="md-anchor" href="#tl-dr-and-takeaways" aria-hidden="true"></a> tl;dr and takeaways</h2><ul><li><a href="#1-myth-modern-tech-is-secure-and-bug-free">Modern tech can still be insecure.</a> This can be attributed to <a href="#2-an-application-is-as-secure-as-its-weakest-link">human factors and procedural gaps</a> and can be addressed by training and better management. Use strong and memorable passwords. Write and automate tests.</li><li>When architecting systems, consider <a href="#4-encapsulation-is-good-for-security">encapsulating components</a> to enhance access control.</li><li><a href="#11-knowledge-is-power">Knowledge is power</a>; don't expose too much information. Value your privacy. Sometimes <a href="#5-what-a-programmer-finds-useful-an-attacker-often-will-too">sacrificing convenience is essential</a> to safeguarding your data.</li><li>All software components carry inherent risks.<ul><li>For in-house components, <a href="#7-dont-roll-your-own-auth">understand the potential security risks</a> and ensure thorough testing is performed.</li><li>For external libraries and components, regularly monitor for updates and <a href="#8-patch-your-systems">patch security issues</a>.</li></ul></li><li><a href="#6-assume-breach">Assume breach</a>, apply defence-in-depth. <a href="#9-dont-solely-rely-on-wafs">Don't rely on an "outer shield"</a> to protect your internal environment.</li><li>Pay attention to common issues which plague applications, such as <a href="#10-string-concatenation-considered-dangerous-s">injection</a>, <a href="#11-knowledge-is-power">information disclosure</a>, and <a href="#12-elementary-dear-watson">logic bugs</a>.</li><li><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" class="no-exlink" rel="noreferrer" target="_blank">Keep going and never give up.</a></li></ul><hr class="footnotes-sep"><b>Footnotes</b><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>OT, Operational Technology, are devices which typically involve physical actuators. Some network protocols in this industry lack security and have catching up to do. <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>You <em>could</em> also consider using a third-party service, but this may open a whole can of worms involving privacy/compliance (muh data got sent WhErE?!?, and it's stored WhErE?!?), UX (why did I redirect?), and more. <a href="#fnref2" class="footnote-backref">↩︎</a></p></li><li id="fn3" class="footnote-item"><p>For instance, Cloudflare builds its own infrastructure and <a href="https://github.com/cloudflare/pingora" rel="noreferrer" target="_blank">proxy</a> because it’s critical to their network. <a href="#fnref3" class="footnote-backref">↩︎</a></p></li><li id="fn4" class="footnote-item"><p>Adjust for risk accordingly, if that’s your thing. <a href="#fnref4" class="footnote-backref">↩︎</a> <a href="#fnref4:1" class="footnote-backref">↩︎</a></p></li></ol></section></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="12 Days of Christmas – Reflections from a Pentester" data-url="/posts/twelve-days-to-secure-your-systems/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="12 Days of Christmas – Reflections from a Pentester" data-url="/posts/twelve-days-to-secure-your-systems/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="12 Days of Christmas – Reflections from a Pentester" data-url="/posts/twelve-days-to-secure-your-systems/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="12 Days of Christmas – Reflections from a Pentester" data-url="/posts/twelve-days-to-secure-your-systems/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="12 Days of Christmas – Reflections from a Pentester" data-url="/posts/twelve-days-to-secure-your-systems/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="12 Days of Christmas – Reflections from a Pentester" data-url="/posts/twelve-days-to-secure-your-systems/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><img class="post-img-blurred-bg" src="/img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 398" alt="Thumbnail for Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 & CVE-2025-40757)" srcset="/img/posts/infosec/siemens-cves/assets/thumbnail-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/thumbnail-576w.webp 576w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 398" alt="Thumbnail for Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 & CVE-2025-40757)" srcset="/img/posts/infosec/siemens-cves/assets/thumbnail-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/thumbnail-576w.webp 576w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp; CVE-2025-40757)</h2><div class="post-summary"><p>When security by obscurity breaks...</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/research/" itemprop="keywords">research</a> </span><span><a class="jtag" href="/tags/embedded/" itemprop="keywords">embedded</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/output-invariant-prompt-injection/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/output-invariant-prompt-injection/"><img class="post-img-blurred-bg" src="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs" srcset="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-256w.webp 256w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp 512w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1024w.webp 1024w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs" srcset="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-256w.webp 256w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp 512w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1024w.webp 1024w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs</h2><div class="post-summary"><p>Abusing inherent context and sluggishness in LLMs for stealthy enumeration of prompt injection points.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/ai/" itemprop="keywords">ai</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"><img class="post-img-blurred-bg" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules</h2><div class="post-summary"><p>Breaking news, awesome stuff happened!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/satire/" itemprop="keywords">satire</a> </span><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/delay-and-interactive-pause-in-multithreaded-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/delay-and-interactive-pause-in-multithreaded-python/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Delay and Interactive Pause in Multi-Threaded Python</h2><div class="post-summary"><p>It's like musical chairs for threads (except no one gets left behind)!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/tutorial/" itemprop="keywords">tutorial</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading – Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/automating-boolean-sql-injection-with-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/automating-boolean-sql-injection-with-python/"><img class="post-img-blurred-bg" src="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 273" alt="Thumbnail for Automating Boolean-Based SQL Injection with Python" srcset="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-256w.webp 256w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp 512w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1024w.webp 1024w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1800w.webp 1800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 273" alt="Thumbnail for Automating Boolean-Based SQL Injection with Python" srcset="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-256w.webp 256w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp 512w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1024w.webp 1024w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1800w.webp 1800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Automating Boolean-Based SQL Injection with Python</h2><div class="post-summary"><p>How to be efficiently lazy at finding hidden gems in predictable places –&nbsp;Database Edition</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/sql/" itemprop="keywords">sql</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to infosec, pentesting">software.security</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/ctf/">ctf</a> <a class="jtag" href="/tags/infosec/">infosec</a> <a class="jtag" href="/tags/reverse/">reverse</a> <a class="jtag" href="/tags/pentesting/">pentesting</a> <a class="jtag" href="/tags/pwn/">pwn</a> <a class="jtag" href="/tags/cryptography/">cryptography</a> <a class="jtag" href="/tags/redteam/">redteam</a> <a class="jtag" href="/tags/stego/">stego</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to software-engineering, web">software.general</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/programming/">programming</a> <a class="jtag" href="/tags/software-engineering/">software-engineering</a> <a class="jtag" href="/tags/web/">web</a> <a class="jtag" href="/tags/aoc/">aoc</a> <a class="jtag" href="/tags/apps/">apps</a> <a class="jtag" href="/tags/dsp/">dsp</a> <a class="jtag" href="/tags/programming-languages/">programming-languages</a> <a class="jtag" href="/tags/linux/">linux</a> <a class="jtag" href="/tags/performance/">performance</a> <a class="jtag" href="/tags/functional/">functional</a> <a class="jtag" href="/tags/types/">types</a> <a class="jtag" href="/tags/windows/">windows</a> <a class="jtag" href="/tags/ai/">ai</a> <a class="jtag" href="/tags/metaprogramming/">metaprogramming</a> <a class="jtag" href="/tags/oop/">oop</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to reflection">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p><em>Comments are back! Privacy-focused, without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion — I'd love to hear your thoughts.</em></p><script defer src="https://trebledj.me/js/comentario.min.js"></script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://www.codingame.com/profile/8444100ecb9723c1ec542346b0630aaa2821532" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/codingame.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://musescore.com/user/20636901" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/musescore.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2025&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/MPnrKnjI5w.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>