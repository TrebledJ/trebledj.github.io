<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>AOC 2021 Day&amp;nbsp;16 – Parser Combinator Fun - TrebledJ's Pages</title><meta name="description" content="Decoding packets with monads."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,aoc 2021 day&amp;nbsp;16 – parser combinator fun,decoding packets with monads.,programming,aoc,haskell,writeup"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-5e8R4YC3Atf/5McNMkFk4TZYUtMEItdy9ikt1KUoPSc=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="AOC 2021 Day&amp;nbsp;16 – Parser Combinator Fun - TrebledJ's Pages"><meta property="twitter:title" content="AOC 2021 Day&amp;nbsp;16 – Parser Combinator Fun - TrebledJ's Pages"><meta property="og:description" content="Decoding packets with monads.

This post is a writeup on solving the Advent of Code 2021 Day 16 challenge: Packet Decoder. The Problem We're given as input a string of hexadecimal characters (0 to..."><meta property="twitter:description" content="Decoding packets with monads.

This post is a writeup on solving the Advent of Code 2021 Day 16 challenge: Packet Decoder. The Problem We're given as input a string of hexadecimal characters (0 to..."><meta property="og:url" content="https://trebledj.me/posts/aoc-2021-day-16/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/programming/aoc-2021/assets/aoc-2021-day-16-thumbnail-996w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/programming/aoc-2021/assets/aoc-2021-day-16-thumbnail-996w.webp"><meta property="article:published_time" content="2022-08-23T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="programming"><meta property="article:tag" content="programming"><meta property="article:tag" content="aoc"><meta property="article:tag" content="haskell"><meta property="article:tag" content="writeup"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-6e60ae6c5e022aba.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><style></style><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;var reloadDisqus=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");"dark"===e?(setMode("light"),reloadDisqus&&reloadDisqus()):"light"===e?(setMode("dark"),reloadDisqus&&reloadDisqus()):setMode(defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#the-problem">The Problem</a></li><li><a href="#solving">Solving</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-08-23T08:00:00.000+08:00">2022‑08‑23</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2023-09-12T01:44:11.000+08:00">2023‑09‑11</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">7 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/haskell/" itemprop="keywords">haskell</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#the-problem">The Problem</a></li><li><a href="#solving">Solving</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">AOC&nbsp;2021 Day&nbsp;16 – Parser Combinator Fun</h1><p class="post-desc" itemprop="alternativeHeadline">Decoding packets with monads.</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-08-23T08:00:00.000+08:00">2022‑08‑23</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2023-09-12T01:44:11.000+08:00">2023‑09‑11</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">7 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/haskell/" itemprop="keywords">haskell</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><p>This post is a writeup on solving the <a href="/tags/aoc/">Advent of Code</a> <a href="https://adventofcode.com/2021/day/16" rel="noreferrer" target="_blank">2021 Day 16 challenge: Packet Decoder</a>.</p><h3 id="the-problem" tabindex="-1"><a class="md-anchor" href="#the-problem" aria-hidden="true"></a> The Problem</h3><p>We're given as input a string of hexadecimal characters (<code>0</code> to <code>F</code>). Our mission? To translate those characters into an expression of packets (part 1) and to then evaluate it (part 2).</p><p>Before diving into code, we should first understand the format of the packets, what exactly we need to parse, and what we're looking for. The majority of this section is just me trying to summarise the <a href="https://adventofcode.com/2021/day/16" rel="noreferrer" target="_blank">problem</a> without all the fluff. I'll skip over some things, but if you're confused, just read the full explanation on AOC.</p><p>To start off, we're given a bunch of hex characters:</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">D2FE28</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>To decode the packets, we first need to translate each character into binary (<code>1</code>s and <code>0</code>s). The above hex string translates to:</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">110100101111111000101000</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>We can now begin parsing packets. There are two kinds of packets: <strong>literals</strong> and <strong>operators</strong>. There is also the notion of <em>sub-packets</em>, meaning a packet can be a child of another packet.</p><ul><li>Literals. The format of literal packets is <code>VVVTTT[AAAAA]+</code><ul><li><code>VVV</code>: 3 bits for the version number.</li><li><code>TTT</code>: 3 bits for the packet's type ID. A literal packet will <em>always</em> have type ID 4. Any other type ID is an operator.</li><li><code>[AAAAA]+</code>: at least one group of 5 bits. The last group will start with a <code>1</code>.</li></ul></li><li>Operands. There are two types of operand packets, I'll just call them <em>length-based</em> operand packets and <em>count-based</em> operand packets.<ul><li>Length-based operands have format <code>VVVTTTIL{15}...</code>.<ul><li><code>VVV</code>: as before, these are the 3 bits of version number.</li><li><code>TTT</code>: 3 bits of type ID.</li><li><code>I</code>: the length type ID. For length-based operands, this is <code>0</code>.</li><li><code>L{15}</code>: 15 bits indicating that the <em>next</em> <code>L{15}</code> (decimal) bits are <em>sub</em>-packets.</li></ul></li><li>Count-based operands follow <code>VVVTTTIL{11}...</code>.<ul><li><code>VVV</code>, <code>TTT</code>: ditto.</li><li><code>I</code>: the length type ID. For count-based operands, this is <code>1</code>.</li><li><code>L{11}</code>: 11 bits indicating the <em>number</em> (or count) of sub-packets.</li></ul></li></ul></li></ul><p>(See the AOC explanation for examples.)</p><p>Our input would be provided as a single large packet, containing many subpackets (and subpackets within subpackets, etc.). For part 1, we need to sum the version numbers of all packets. For part 2, we need to evaluate the expression of packets. Operand packets have different operations, determined by their type ID.</p><h3 id="solving" tabindex="-1"><a class="md-anchor" href="#solving" aria-hidden="true"></a> Solving</h3><p>If I were using C++, I might try using bit-fields, some <code>std::bit_cast</code>/<code>std::reinterpret_cast</code> magic, and a couple classes plus inheritance. Sticking to my <a href="/posts/aoc-2021">resolve</a> to use Haskell or Rust, I decided to use parser combinators.</p><div class="alert alert-info d-flex align-items-start"><i class="fas fa-circle-info ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>The template I'm using allows me to solve a challenge by writing three functions:</p><ol><li><code>parse :: Parser Packet</code>,</li><li><code>part1 :: Packet -&gt; Int</code>, and</li><li><code>part2 :: Packet -&gt; Int</code>.</li></ol><p>These will be covered in this post. The driver code of the template (<code>defaultMain</code>) is elaborated in my <a href="/posts/aoc-2021-haskell-utils">Haskell utilities</a> post.</p></div></div><h4 id="parsing" tabindex="-1"><a class="md-anchor" href="#parsing" aria-hidden="true"></a> Parsing</h4><p>We'll cover the <code>parse</code> function first, and move towards <code>part1</code> and <code>part2</code>.</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">parse</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">Packet</span>
<span class="token hvariable">parse</span> <span class="token operator">=</span> <span class="token hvariable">subparse</span> <span class="token hvariable">packet</span> <span class="token operator">.</span> <span class="token builtin">concatMap</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">hex</span> <span class="token operator">-&gt;</span> <span class="token builtin">read</span> <span class="token operator">$</span> <span class="token hvariable">toBinary</span> <span class="token operator">$</span> <span class="token string">"0x"</span> <span class="token operator">++</span> <span class="token punctuation">[</span><span class="token hvariable">hex</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 <span class="token keyword">where</span>
  <span class="token hvariable">toBinary</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">printf</span> <span class="token string">"%04s"</span> <span class="token punctuation">(</span><span class="token hvariable">showIntAtBase</span> <span class="token number">2</span> <span class="token punctuation">(</span><span class="token string">"01"</span> <span class="token operator">!!</span><span class="token punctuation">)</span> <span class="token hvariable">n</span> <span class="token string">""</span><span class="token punctuation">)</span>

<span class="token hvariable">subparse</span> <span class="token operator">::</span> <span class="token constant">Parser</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
<span class="token hvariable">subparse</span> <span class="token hvariable">p</span> <span class="token hvariable">s</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">runParser</span> <span class="token punctuation">(</span><span class="token hvariable">p</span> <span class="token operator">&lt;*</span> <span class="token hvariable">many</span> <span class="token punctuation">(</span><span class="token hvariable">char</span> <span class="token char string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">""</span> <span class="token hvariable">s</span> <span class="token keyword">of</span>
  <span class="token constant">Right</span> <span class="token hvariable">res</span> <span class="token operator">-&gt;</span> <span class="token hvariable">res</span>
  <span class="token constant">Left</span>  <span class="token hvariable">err</span> <span class="token operator">-&gt;</span> <span class="token hvariable">trace</span> <span class="token punctuation">(</span><span class="token hvariable">errorBundlePretty</span> <span class="token hvariable">err</span><span class="token punctuation">)</span> <span class="token builtin">undefined</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><code>parse</code> takes a hex string, converts it to a binary string and parses it into a packet. The <code>subparse</code> helper takes a parser and the binary as input string and runs the parser (leaving out any leftover <code>'0'</code>s). We'll reuse <code>subparse</code> with some differences later on, hence the reason we give it a generic type.</p><p><code>runParser</code> returns an <code>Either</code> type. In this case, it means that it either returns a <code>Right</code> case (denoting success) or <code>Left</code> case (denoting failure).</p><h4 id="data-types" tabindex="-1"><a class="md-anchor" href="#data-types" aria-hidden="true"></a> Data Types</h4><p>Let's first define the structure of the data we're working with. With Haskell, we can easily define algebraic data types (ADTs) like so:</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">Packet</span> <span class="token operator">=</span> <span class="token constant">Packet</span> <span class="token constant">Int</span> <span class="token constant">Int</span> <span class="token constant">PacketObj</span> <span class="token keyword">deriving</span> <span class="token constant">Show</span>
<span class="token keyword">data</span> <span class="token constant">PacketObj</span> <span class="token operator">=</span> <span class="token constant">Literal</span> <span class="token constant">Int</span> <span class="token operator">|</span> <span class="token constant">Operands</span> <span class="token punctuation">[</span><span class="token constant">Packet</span><span class="token punctuation">]</span> <span class="token keyword">deriving</span> <span class="token constant">Show</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><ul><li>Each <code>Packet</code> takes 2 <code>Int</code>s (the version and type ID), followed by a <code>PacketObj</code>.</li><li>The <code>PacketObj</code> can be an <code>Int</code> <code>Literal</code>...</li><li>or it could be an operand with a list of packets (<code>[Packet]</code>).</li></ul><p>The data types are like a cornerstone to building our foundation. Without it, we become a bit lost when writing the algorithm. By writing our data types beforehand, we get a concrete idea of how the data is structured and partition, and what we need to do to get from <s>point</s> data <code>A</code> to <s>point</s> data <code>B</code>.</p><p>One of the key points in these <code>Packet</code> data structures is that a <code>Packet</code> is a recursive type/object. This allows us the flexibility of recursion (as we'll see later in the <code>part1</code> and <code>part2</code> solutions).</p><h4 id="parser-combinators" tabindex="-1"><a class="md-anchor" href="#parser-combinators" aria-hidden="true"></a> Parser Combinators</h4><p>Usually when parsing text, the traditional solution is to use <a href="https://www.regular-expressions.info/" rel="noreferrer" target="_blank">regex</a>. The problem with regex, however, is that we don't get type information until after compiling, matching, and some extra parsing. Parser combinators are stronger in this regard, being composable and flexible while at the same time providing type information.</p><div class="alert alert-success d-flex align-items-start"><i class="fas fa-lightbulb ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>Type information may sound a little overrated, but typing is quite useful for <a href="/posts/the-mathematics-of-types">catching errors at compile-time and solidifying program logic without being sniped by a <code>RuntimeError</code> later</a>.</p></div></div><p>We can begin by writing the combinator that will consume <code>n</code> bits.</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">bits</span> <span class="token operator">::</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Parser</span> <span class="token constant">String</span>
<span class="token hvariable">bits</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">count</span> <span class="token hvariable">n</span> <span class="token hvariable">digitChar</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>The <code>bits</code> function takes an integer <code>n</code> and returns a <code>Parser String</code> that consumes that many <code>digitChar</code>s. <code>count</code> and <code>digitChar</code> are functions from the parsec library I'm using. <code>bits</code> doesn't exactly consume bits but rather digits (0-9). However, we'll assume that it is fed only bits.</p><p>Let's also define a function to convert from a binary string to a decimal (base-10) integer.</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">fromBinary</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">Int</span>
<span class="token hvariable">fromBinary</span> <span class="token operator">=</span> <span class="token builtin">foldl</span>' <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">acc</span> <span class="token hvariable">d</span> <span class="token operator">-&gt;</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">acc</span> <span class="token operator">+</span> <span class="token builtin">digitToInt</span> <span class="token hvariable">d</span><span class="token punctuation">)</span> <span class="token number">0</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>We can then compose <code>fromBinary</code> with the <code>bits</code> parser to parse numbers and convert numbers.</p><h4 id="decoding-literal-packets" tabindex="-1"><a class="md-anchor" href="#decoding-literal-packets" aria-hidden="true"></a> Decoding Literal Packets</h4><p>Let's use our helper functions to write a parser for literal packets:</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">packet</span> <span class="token operator">::</span> <span class="token constant">Parser</span> <span class="token constant">Packet</span>
<span class="token hvariable">packet</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token hvariable">version</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">3</span>
  <span class="token hvariable">typeID</span>  <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">3</span>
  <span class="token keyword">if</span> <span class="token hvariable">typeID</span> <span class="token operator">==</span> <span class="token number">4</span>
    <span class="token keyword">then</span> <span class="token keyword">do</span>
      <span class="token hvariable">bs</span> <span class="token operator">&lt;-</span> <span class="token hvariable">collectWhile</span> <span class="token punctuation">(</span><span class="token hvariable">bits</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token operator">\</span><span class="token punctuation">(</span><span class="token hvariable">b</span> <span class="token operator">:</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token hvariable">b</span> <span class="token operator">==</span> <span class="token char string">'1'</span>
      <span class="token builtin">return</span> <span class="token operator">$</span> <span class="token constant">Packet</span> <span class="token hvariable">version</span> <span class="token hvariable">typeID</span> <span class="token operator">$</span> <span class="token constant">Literal</span> <span class="token operator">$</span> <span class="token hvariable">fromBinary</span> <span class="token operator">$</span> <span class="token builtin">concatMap</span> <span class="token punctuation">(</span><span class="token builtin">drop</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">bs</span>
    <span class="token keyword">else</span> <span class="token keyword">do</span>
      <span class="token comment">{- -- code for operand packets --  -}</span>
 <span class="token keyword">where</span>
  <span class="token hvariable">collectWhile</span> <span class="token hvariable">p</span> <span class="token hvariable">f</span> <span class="token operator">=</span> <span class="token keyword">do</span> <span class="token comment">-- Parse while condition is true.</span>
    <span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token hvariable">p</span>
    <span class="token keyword">if</span> <span class="token hvariable">f</span> <span class="token hvariable">x</span> <span class="token keyword">then</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">collectWhile</span> <span class="token hvariable">p</span> <span class="token hvariable">f</span> <span class="token keyword">else</span> <span class="token builtin">return</span> <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token punctuation">]</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Hopefully the majority of the code above is readable.</p><ul><li>We first parse 3 bits of version and convert it to a decimal <code>Int</code>.</li><li>Then 3 bits of type ID and also convert to a decimal <code>Int</code>.</li><li>Next, we check the packet's <code>typeID</code>. If it's <code>4</code>, then it's a literal packet.</li><li>We then try parsing the <code>PacketObj</code> for literal packets: keep parsing groups of 5 bits until the group starts with a <code>'1'</code>.</li><li>Now we have a list of 5-bit groups stored in <code>bs</code>.</li><li>The next line goes through the process of converting the bits into a single <code>Int</code> and wrapping it as a <code>Packet</code> type.</li><li>The explanation for <code>collectWhile</code>... is left as an exercise for the reader.</li></ul><p>Hoof- That was quite long-winded. But you can see how type information is being passed around. <code>version</code> and <code>typeID</code> are <code>Int</code>s, because we parsed them from binary strings. We can now do <code>Int</code>y things with them, e.g. comparison, just like <code>typeID == 4</code> in the code above.</p><p>We're also confident that we've covered non-<code>Int</code> edge cases because the parser engine and Haskell's type system will report it for us; and so if the parsing succeeds, we know that our data isn't a string, character, boolean, or monkey. We assumed there won't be out-of-bound issues since AOC usually constrains numbers to 32/64-bit ints. But if the need arises, we could always upgrade from <code>Int</code>s to <code>Integer</code>s (which are Haskell's equivalent of dynamically-sized integers).</p><h4 id="decoding-operand-packets" tabindex="-1"><a class="md-anchor" href="#decoding-operand-packets" aria-hidden="true"></a> Decoding Operand Packets</h4><p>For operand packets, let's define another parser helper for parsing subpackets. We'll take as argument an <code>Int</code> (the length type ID) and return a parser that parses a list of (sub)packets.</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">operands</span> <span class="token operator">::</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Parser</span> <span class="token punctuation">[</span><span class="token constant">Packet</span><span class="token punctuation">]</span>
<span class="token hvariable">operands</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token keyword">do</span>  <span class="token comment">-- Length type ID == 0 ---&gt; length-based operand</span>
  <span class="token hvariable">len</span>      <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">15</span>
  <span class="token hvariable">subparse</span> <span class="token punctuation">(</span><span class="token hvariable">some</span> <span class="token hvariable">packet</span><span class="token punctuation">)</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token hvariable">len</span>
<span class="token hvariable">operands</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token keyword">do</span>  <span class="token comment">-- Length type ID == 1 ---&gt; count-based operand</span>
  <span class="token hvariable">num</span>      <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">11</span>
  <span class="token hvariable">count</span> <span class="token hvariable">num</span> <span class="token hvariable">packet</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Pretty straightforward. For length-based operands: parse the <code>len</code>gth, then <code>parse</code> 1 or more <code>packet</code>s out of the next <code>len</code>gth bits. Count-based operands are even more straightforward: parse the expected <code>num</code>ber of subpackets, then parse the <code>num</code> packets.</p><p>In both cases, subpackets are parsed by recursing to the <code>packet</code> parser, which we can now finish:</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">packet</span> <span class="token operator">::</span> <span class="token constant">Parser</span> <span class="token constant">Packet</span>
<span class="token hvariable">packet</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token hvariable">version</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">3</span>
  <span class="token hvariable">typeID</span>  <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">3</span>
  <span class="token keyword">if</span> <span class="token hvariable">typeID</span> <span class="token operator">==</span> <span class="token number">4</span>
    <span class="token keyword">then</span> <span class="token keyword">do</span>
      <span class="token comment">{- -- code for literal packets --  -}</span>
    <span class="token keyword">else</span> <span class="token keyword">do</span> <span class="token comment">-- Code for operands.</span>
      <span class="token hvariable">lenTypeID</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fromBinary</span> <span class="token operator">&lt;$&gt;</span> <span class="token hvariable">bits</span> <span class="token number">1</span>
      <span class="token hvariable">children</span>  <span class="token operator">&lt;-</span> <span class="token hvariable">operands</span> <span class="token hvariable">lenTypeID</span>
      <span class="token builtin">return</span> <span class="token operator">$</span> <span class="token constant">Packet</span> <span class="token hvariable">version</span> <span class="token hvariable">typeID</span> <span class="token operator">$</span> <span class="token constant">Operands</span> <span class="token hvariable">children</span>
 <span class="token keyword">where</span>
    <span class="token operator">...</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Also pretty straightforward. We've added three lines of code for parsing the operand case. I think this warrants no explanation and should be a simple exercise for the reader. :)</p><h4 id="part-1" tabindex="-1"><a class="md-anchor" href="#part-1" aria-hidden="true"></a> Part 1</h4><p>Summing the version numbers should be no problem, and knowing where are versions are and that they're already <code>Int</code>s, a simple recursion with <code>sum</code> and <code>map</code> should do it:</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">part1</span> <span class="token operator">::</span> <span class="token constant">Packet</span> <span class="token operator">-&gt;</span> <span class="token constant">Int</span>
<span class="token hvariable">part1</span> <span class="token punctuation">(</span><span class="token constant">Packet</span> <span class="token hvariable">v</span> <span class="token hvariable">_</span> <span class="token hvariable">obj</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">obj</span> <span class="token keyword">of</span>
  <span class="token constant">Literal</span> <span class="token hvariable">_</span> <span class="token operator">-&gt;</span> <span class="token hvariable">v</span>
  <span class="token constant">Operands</span> <span class="token hvariable">ps</span> <span class="token operator">-&gt;</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token builtin">sum</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token hvariable">part1</span> <span class="token hvariable">ps</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h4 id="part-2" tabindex="-1"><a class="md-anchor" href="#part-2" aria-hidden="true"></a> Part 2</h4><p>Part 2 is more complicated, but only slightly. Essentially, each type ID other than 4 corresponds to some operation. <code>0</code> is addition, <code>1</code> is multiplication, <code>5</code> is <code>&gt;</code>, and so on.</p><div class="code-toolbar"><pre class="language-haskell" tabindex="0"><code class="language-haskell"><span class="token hvariable">part2</span> <span class="token operator">::</span> <span class="token constant">Packet</span> <span class="token operator">-&gt;</span> <span class="token constant">Int</span>
<span class="token hvariable">part2</span> <span class="token punctuation">(</span><span class="token constant">Packet</span> <span class="token hvariable">_</span> <span class="token hvariable">op</span> <span class="token hvariable">obj</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">obj</span> <span class="token keyword">of</span>
  <span class="token constant">Literal</span> <span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token hvariable">x</span>
  <span class="token constant">Operands</span> <span class="token hvariable">ps</span> <span class="token operator">-&gt;</span> <span class="token keyword">case</span> <span class="token hvariable">op</span> <span class="token keyword">of</span>
      <span class="token number">0</span> <span class="token operator">-&gt;</span> <span class="token builtin">sum</span>
      <span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token builtin">product</span>
      <span class="token number">2</span> <span class="token operator">-&gt;</span> <span class="token builtin">minimum</span>
      <span class="token number">3</span> <span class="token operator">-&gt;</span> <span class="token builtin">maximum</span>
      <span class="token number">5</span> <span class="token operator">-&gt;</span> <span class="token operator">\</span><span class="token punctuation">[</span><span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">b</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token keyword">if</span> <span class="token hvariable">a</span> <span class="token operator">&gt;</span> <span class="token hvariable">b</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span>
      <span class="token number">6</span> <span class="token operator">-&gt;</span> <span class="token operator">\</span><span class="token punctuation">[</span><span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">b</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token keyword">if</span> <span class="token hvariable">a</span> <span class="token operator">&lt;</span> <span class="token hvariable">b</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span>
      <span class="token number">7</span> <span class="token operator">-&gt;</span> <span class="token operator">\</span><span class="token punctuation">[</span><span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">b</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token keyword">if</span> <span class="token hvariable">a</span> <span class="token operator">==</span> <span class="token hvariable">b</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span>
    <span class="token operator">$</span> <span class="token builtin">map</span> <span class="token hvariable">part2</span> <span class="token hvariable">ps</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Haskell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>And that's it. Tada! Welcome to the wonderful magic of parser combinators.</p><h4 id="full-script" tabindex="-1"><a class="md-anchor" href="#full-script" aria-hidden="true"></a> Full Script</h4><p>For completeness, here's the full D16.hs script. This uses my <a href="/posts/aoc-2021-haskell-utils">Haskell <code>Utils</code> module</a>, and the actual <code>main</code> function is placed in another file. The background work is done there so that here we could focus on the process of getting from input (<code>String</code>) to output (<code>Int</code>) here.</p><script src="https://gist.github.com/TrebledJ/c5b91fd7104f0fa544c23b6d318064ab.js"></script></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;16 – Parser Combinator Fun" data-url="/posts/aoc-2021-day-16/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;16 – Parser Combinator Fun" data-url="/posts/aoc-2021-day-16/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;16 – Parser Combinator Fun" data-url="/posts/aoc-2021-day-16/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;16 – Parser Combinator Fun" data-url="/posts/aoc-2021-day-16/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;16 – Parser Combinator Fun" data-url="/posts/aoc-2021-day-16/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;16 – Parser Combinator Fun" data-url="/posts/aoc-2021-day-16/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/the-mathematics-of-types/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/the-mathematics-of-types/"><img class="post-img-blurred-bg" src="/img/posts/programming/concepts/mathematics-of-types/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for The Mathematics of Types" srcset="/img/posts/programming/concepts/mathematics-of-types/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/mathematics-of-types/assets/thumbnail-512w.webp 512w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/concepts/mathematics-of-types/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for The Mathematics of Types" srcset="/img/posts/programming/concepts/mathematics-of-types/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/mathematics-of-types/assets/thumbnail-512w.webp 512w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">The Mathematics of Types</h2><div class="post-summary"><p>Programming isn't about mindlessly typing away on a keyboard. There is an aesthetic quality that comes with approaching a problem.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/mathematics/" itemprop="keywords">mathematics</a> </span><span><a class="jtag" href="/tags/haskell/" itemprop="keywords">haskell</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/aoc-2021-day-22/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/aoc-2021-day-22/"><img class="post-img-blurred-bg" src="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 285" alt="Thumbnail for AOC&nbsp;2021 Day&nbsp;22 – Reactor Reboot" srcset="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-256w.webp 256w, /img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-512w.webp 512w, /img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-800w.webp 800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 285" alt="Thumbnail for AOC&nbsp;2021 Day&nbsp;22 – Reactor Reboot" srcset="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-256w.webp 256w, /img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-512w.webp 512w, /img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-800w.webp 800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">AOC&nbsp;2021 Day&nbsp;22 – Reactor Reboot</h2><div class="post-summary"><p>Reboot reactors from a submarine using set theory.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/rust/" itemprop="keywords">rust</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/implicit-parameters-in-scala-and-haskell/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/implicit-parameters-in-scala-and-haskell/"><img class="post-img-blurred-bg" src="/img/posts/programming/concepts/implicit-parameters/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Implicit Parameters in Scala and Haskell" srcset="/img/posts/programming/concepts/implicit-parameters/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/implicit-parameters/assets/thumbnail-512w.webp 512w, /img/posts/programming/concepts/implicit-parameters/assets/thumbnail-1024w.webp 1024w, /img/posts/programming/concepts/implicit-parameters/assets/thumbnail-1060w.webp 1060w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/concepts/implicit-parameters/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Implicit Parameters in Scala and Haskell" srcset="/img/posts/programming/concepts/implicit-parameters/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/implicit-parameters/assets/thumbnail-512w.webp 512w, /img/posts/programming/concepts/implicit-parameters/assets/thumbnail-1024w.webp 1024w, /img/posts/programming/concepts/implicit-parameters/assets/thumbnail-1060w.webp 1060w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Implicit Parameters in Scala and Haskell</h2><div class="post-summary"><p>...and also C++ (kinda).</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/tutorial/" itemprop="keywords">tutorial</a> </span><span><a class="jtag" href="/tags/programming-languages/" itemprop="keywords">programming-languages</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/aoc-2021-day-24/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/aoc-2021-day-24/"><img class="post-img-blurred-bg" src="/img/posts/programming/aoc-2021/assets/z3-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 560" alt="Thumbnail for AOC&nbsp;2021 Day&nbsp;24 – No U" srcset="/img/posts/programming/aoc-2021/assets/z3-256w.webp 256w, /img/posts/programming/aoc-2021/assets/z3-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/aoc-2021/assets/z3-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 560" alt="Thumbnail for AOC&nbsp;2021 Day&nbsp;24 – No U" srcset="/img/posts/programming/aoc-2021/assets/z3-256w.webp 256w, /img/posts/programming/aoc-2021/assets/z3-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">AOC&nbsp;2021 Day&nbsp;24 – No U</h2><div class="post-summary"><p>Finally a reverse engineering challenge in Advent of Code.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/aoc-2021-haskell-utils/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/aoc-2021-haskell-utils/"><img class="post-img-blurred-bg" src="/img/posts/programming/aoc-2021/assets/recycle-hs-utils-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 331" alt="Thumbnail for AOC 2021 Haskell Utils" srcset="/img/posts/programming/aoc-2021/assets/recycle-hs-utils-256w.webp 256w, /img/posts/programming/aoc-2021/assets/recycle-hs-utils-512w.webp 512w, /img/posts/programming/aoc-2021/assets/recycle-hs-utils-771w.webp 771w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/aoc-2021/assets/recycle-hs-utils-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 331" alt="Thumbnail for AOC 2021 Haskell Utils" srcset="/img/posts/programming/aoc-2021/assets/recycle-hs-utils-256w.webp 256w, /img/posts/programming/aoc-2021/assets/recycle-hs-utils-512w.webp 512w, /img/posts/programming/aoc-2021/assets/recycle-hs-utils-771w.webp 771w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">AOC 2021 Haskell Utils</h2><div class="post-summary"><p>An introduction and walkthrough of my haskell utilities.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/haskell/" itemprop="keywords">haskell</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/aoc-2021/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/aoc-2021/"><img class="post-img-blurred-bg" src="/img/posts/experiences/aoc/assets/aoc-2021-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 466" alt="Thumbnail for Advent of Code 2021" srcset="/img/posts/experiences/aoc/assets/aoc-2021-256w.webp 256w, /img/posts/experiences/aoc/assets/aoc-2021-512w.webp 512w, /img/posts/experiences/aoc/assets/aoc-2021-1024w.webp 1024w, /img/posts/experiences/aoc/assets/aoc-2021-1310w.webp 1310w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/experiences/aoc/assets/aoc-2021-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 466" alt="Thumbnail for Advent of Code 2021" srcset="/img/posts/experiences/aoc/assets/aoc-2021-256w.webp 256w, /img/posts/experiences/aoc/assets/aoc-2021-512w.webp 512w, /img/posts/experiences/aoc/assets/aoc-2021-1024w.webp 1024w, /img/posts/experiences/aoc/assets/aoc-2021-1310w.webp 1310w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Advent of Code 2021</h2><div class="post-summary"><p>Synopsis and reflections on solving the Advent of Code 2021 challenges through various programming languages.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/experience/" itemprop="keywords">experience</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/haskell/" itemprop="keywords">haskell</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to aoc, programming">software.general</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/programming/">programming</a> <a class="jtag" href="/tags/software-engineering/">software-engineering</a> <a class="jtag" href="/tags/web/">web</a> <a class="jtag" href="/tags/aoc/">aoc</a> <a class="jtag" href="/tags/apps/">apps</a> <a class="jtag" href="/tags/dsp/">dsp</a> <a class="jtag" href="/tags/programming-languages/">programming-languages</a> <a class="jtag" href="/tags/linux/">linux</a> <a class="jtag" href="/tags/performance/">performance</a> <a class="jtag" href="/tags/functional/">functional</a> <a class="jtag" href="/tags/types/">types</a> <a class="jtag" href="/tags/windows/">windows</a> <a class="jtag" href="/tags/ai/">ai</a> <a class="jtag" href="/tags/metaprogramming/">metaprogramming</a> <a class="jtag" href="/tags/oop/">oop</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to haskell">software.programming-language</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/cpp/">cpp</a> <a class="jtag" href="/tags/python/">python</a> <a class="jtag" href="/tags/c/">c</a> <a class="jtag" href="/tags/haskell/">haskell</a> <a class="jtag" href="/tags/js/">js</a> <a class="jtag" href="/tags/qt/">qt</a> <a class="jtag" href="/tags/rust/">rust</a> <a class="jtag" href="/tags/qml/">qml</a> <a class="jtag" href="/tags/sql/">sql</a> <a class="jtag" href="/tags/scala/">scala</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to writeup">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p><em>Comments are back! Privacy-focused, without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion — I'd love to hear your thoughts.</em></p><script defer src="https://trebledj.me/js/comentario.min.js"></script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://www.codingame.com/profile/8444100ecb9723c1ec542346b0630aaa2821532" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/codingame.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://musescore.com/user/20636901" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/musescore.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2025&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/MPnrKnjI5w.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>