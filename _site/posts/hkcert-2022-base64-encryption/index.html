<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>HKCERT CTF 2022 ‚Äì Base64 Encryption - TrebledJ's Pages</title><meta name="description" content="Frequency analysis with a touch of heuristics."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,hkcert ctf 2022 ‚Äì base64 encryption,frequency analysis with a touch of heuristics.,ctf,cryptography,python,writeup"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-puGfk8by7YflxyCkfgS+RgzE70yM3jYq5c5IrWTe0hM=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-fpqHX3vj/TpB8DyMxAUbt+Rpk0g/8oR6BkJd6JriNoo=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-kQnTuA4pPVYgo0bCEGXSCEkD+CzMbRrhb5Cn58IydSA=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' 'unsafe-hashes' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="HKCERT CTF 2022 ‚Äì Base64 Encryption - TrebledJ's Pages"><meta property="twitter:title" content="HKCERT CTF 2022 ‚Äì Base64 Encryption - TrebledJ's Pages"><meta property="og:description" content="Frequency analysis with a touch of heuristics.

The challenge looks deceptively simple. Chinese has over 50,000 characters. Base64 just has 64. So it should be easy right? Haha nope. It's not as trivial as I thought. Description..."><meta property="twitter:description" content="Frequency analysis with a touch of heuristics.

The challenge looks deceptively simple. Chinese has over 50,000 characters. Base64 just has 64. So it should be easy right? Haha nope. It's not as trivial as I thought. Description..."><meta property="og:url" content="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/ctf/hkcert22/assets/hkcert22-thumbnail-500w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/ctf/hkcert22/assets/hkcert22-thumbnail-500w.webp"><meta property="article:published_time" content="2022-11-14T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="ctfs"><meta property="article:tag" content="ctf"><meta property="article:tag" content="cryptography"><meta property="article:tag" content="python"><meta property="article:tag" content="writeup"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-3b2a868570ec062c.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");setMode("dark"===e?"light":"light"===e?"dark":defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/vulnerability-research">CVEs</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li><li class="nav-item"><a class="nav-link" href="/webroll">Webroll</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#description">Description</a></li><li><a href="#analysis">Analysis</a></li><li><a href="#first-steps-elimination-by-ascii-range">First Steps: Elimination by ASCII Range</a></li><li><a href="#frequency-analysis-with-known-text">Frequency Analysis with Known Text</a></li><li><a href="#more-heuristics">More Heuristics</a></li><li><a href="#final-remarks">Final Remarks</a></li><li><a href="#flag">Flag</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-11-14T08:00:00.000+08:00">2022‚Äë11‚Äë14</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2024-06-09T21:58:25.000+08:00">2024‚Äë06‚Äë09</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">3 minute read</span></div></div><div class="metadata-tag-container"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/cryptography/" itemprop="keywords">cryptography</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#description">Description</a></li><li><a href="#analysis">Analysis</a></li><li><a href="#first-steps-elimination-by-ascii-range">First Steps: Elimination by ASCII Range</a></li><li><a href="#frequency-analysis-with-known-text">Frequency Analysis with Known Text</a></li><li><a href="#more-heuristics">More Heuristics</a></li><li><a href="#final-remarks">Final Remarks</a></li><li><a href="#flag">Flag</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">HKCERT CTF 2022 ‚Äì Base64 Encryption</h1><p class="post-desc" itemprop="alternativeHeadline">Frequency analysis with a touch of heuristics.</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-11-14T08:00:00.000+08:00">2022‚Äë11‚Äë14</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2024-06-09T21:58:25.000+08:00">2024‚Äë06‚Äë09</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">3 minute read</span></div></div><div class="metadata-tag-container"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/cryptography/" itemprop="keywords">cryptography</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><p>The challenge looks deceptively simple. Chinese has over 50,000 characters. Base64 just has 64. So it should be easy right?</p><p>Haha nope. It's not as trivial as I thought.</p><h2 id="description" tabindex="-1"><a class="md-anchor" href="#description" aria-hidden="true"></a> Description</h2><p>200 points. 3/5 ‚≠êÔ∏è. 6/311 solves.</p><blockquote><p>People said that base64 is an encoding, not an encryption. Did they have a misconception about that?</p><p>If you believe that base64 is just an encoding, then convince me that you are able to "decode" the article (which is in English).</p></blockquote><p>Regardless, the challenge author is kind enough to provide a clue in the description: the plaintext is an <strong>article</strong> in <strong>English</strong>. We‚Äôll see how this helps us later on.</p><h2 id="analysis" tabindex="-1"><a class="md-anchor" href="#analysis" aria-hidden="true"></a> Analysis</h2><p>We‚Äôre provided with an encryption script <code>chall.py</code> (written in Python), along with the generated ciphertext <code>message.enc.txt</code>.</p><ul><li><p>The script first encodes the plaintext in English:</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python">encoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>...then "encrypts" it by mapping each Base64 character to another one:</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python">encrypted <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>charmap<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> encoded<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div></li><li><p>The script uses <code>random.shuffle</code> without seeding. This means we can‚Äôt easily reproduce the character mapping (<code>charmap</code>). We‚Äôll need to try harder.</p></li><li><p>Although the script reads the plaintext in binary format (<code>open('message.txt', 'rb')</code>), I‚Äôm banking on the clue that the plaintext is an English article‚Äîso hopefully there aren‚Äôt any weird characters.</p></li></ul><p>So how do we go about cracking this? Brute-force will be undoubtedly inefficient as we have $64! \approx 1.27 \times 10^{89}$ mapping combinations to try. It would take <em>years</em> before we have any progress! Also we‚Äôd need to look at results to determine if the English looks right (or automate it by checking a word list)‚Äîthis would take even more time! Regardless, we need to find some other way.</p><h2 id="first-steps-elimination-by-ascii-range" tabindex="-1"><a class="md-anchor" href="#first-steps-elimination-by-ascii-range" aria-hidden="true"></a> First Steps: Elimination by ASCII Range</h2><p>Here‚Äôs one idea: since the plaintext is an English article, this means that most (if not all) characters are in the printable ASCII range (32-127). This means that the most significant bit (MSB) of each byte <em>cannot</em> be 1. We can use this to create a <strong>blacklist</strong> of mappings. For example, originally we have 64 possible mappings for the letter <code>A</code>. After blacklisting, we may be left with, say, 16 possible mappings. This drastically reduces the search space.<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup></p><p>Since Base64 simply maps 8-bits to 6-bits, so 3 characters of ASCII would be translated to 4 characters of Base64.</p><p><a class="lightbox-single" title="Base64 maps three characters to four." href="/img/posts/ctf/hkcert22/assets/base64-is-so-cool-640w.webp"><img class="mb-2 rw center jw-65" src="/img/posts/ctf/hkcert22/assets/base64-is-so-cool-640w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 640 / 320" alt="Base64 maps three characters to four." title="Base64 maps three characters to four." srcset="/img/posts/ctf/hkcert22/assets/base64-is-so-cool-256w.webp 256w, /img/posts/ctf/hkcert22/assets/base64-is-so-cool-512w.webp 512w, /img/posts/ctf/hkcert22/assets/base64-is-so-cool-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 640px"></a></p><p class="caption"><sup>Base64 maps three characters to four. (<a href="https://www.tenminutetutor.com/img/data-formats/binary-encoding/base64.png" rel="noreferrer" target="_blank">Source</a>)</sup></p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python">charset <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>

<span class="token keyword">def</span> <span class="token function">get_chars_with_mask</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Get Base64 chars which are masked with m."""</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>c <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>charset<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> m<span class="token punctuation">)</span> <span class="token operator">==</span> m<span class="token punctuation">}</span>

<span class="token comment"># List the 4 Base64 positions. We'll cycle through these positions (i.e. i % 4).</span>
msbs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0b100000</span><span class="token punctuation">,</span> <span class="token number">0b001000</span><span class="token punctuation">,</span> <span class="token number">0b000010</span><span class="token punctuation">,</span> <span class="token number">0b000000</span><span class="token punctuation">]</span>

<span class="token comment"># Get impossible characters for each position.</span>
subchars <span class="token operator">=</span> <span class="token punctuation">[</span>get_chars_with_mask<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token keyword">for</span> m <span class="token keyword">in</span> msbs<span class="token punctuation">]</span>

<span class="token comment"># Create a blacklist for each Base64 char.</span>
<span class="token comment"># e.g. blacklist['A'] returns the set of chars which 'A' can NOT map to.</span>
blacklist <span class="token operator">=</span> <span class="token punctuation">{</span>c<span class="token punctuation">:</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> charset<span class="token punctuation">}</span>

<span class="token comment"># Loop through each char in the shuffled Base64 text.</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Ignore char mappings which have '1' in corresponding msb.</span>
    <span class="token comment"># These can't map to a printable ASCII char.</span>
    blacklist<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> subchars<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token comment"># Invert the blacklist to get a dictionary of possible mappings.</span>
<span class="token comment"># e.g. whitelist['A'] returns the set of chars which 'A' CAN map to.</span>
whitelist <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">:</span> <span class="token builtin">set</span><span class="token punctuation">(</span>charset<span class="token punctuation">)</span> <span class="token operator">-</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> blacklist<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>We can check the mappings we‚Äôve eliminated:</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>blacklist<span class="token punctuation">[</span><span class="token string">'J'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># '+/0123456789CDGHKLOPSTWXabefghijklmnopqrstuvwxyz'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>And that means the letter <code>J</code> can only map to:</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>whitelist<span class="token punctuation">[</span><span class="token string">'J'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 'ABEFIJMNQRUVYZcd'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Neat! This will help us later on (when we resort to <s>blatant</s> educated guessing).</p><p>We can do a similar thing on the low end. Again, since the smallest printable ASCII character is 32, this means either the second or third MSBs would be set.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup></p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_inverted_chars_with_mask</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>c <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>charset<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">6</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> m<span class="token punctuation">)</span> <span class="token operator">==</span> m<span class="token punctuation">}</span>

<span class="token comment"># chars that don't have bits set in ascii.</span>
subchars_not_in_ascii <span class="token operator">=</span> <span class="token punctuation">[</span>get_inverted_chars_with_mask<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token keyword">for</span> m <span class="token keyword">in</span> in_ascii<span class="token punctuation">]</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h2 id="frequency-analysis-with-known-text" tabindex="-1"><a class="md-anchor" href="#frequency-analysis-with-known-text" aria-hidden="true"></a> Frequency Analysis with Known Text</h2><p>Another idea comes to mind. Remember the plaintext is in English? Well, with English text, some letters appear more frequently than others. The same applies to words and sequences.</p><p><a class="lightbox-single" title="Frequency of English letters. But we need to be careful with letter cases." href="/img/posts/ctf/hkcert22/assets/base64-letter-frequencies-1200w.webp"><img class="mb-2 rw center jw-65" src="/img/posts/ctf/hkcert22/assets/base64-letter-frequencies-1200w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1200 / 960" alt="Frequency of English letters. But we need to be careful with letter cases." title="Frequency of English letters. But we need to be careful with letter cases." srcset="/img/posts/ctf/hkcert22/assets/base64-letter-frequencies-256w.webp 256w, /img/posts/ctf/hkcert22/assets/base64-letter-frequencies-512w.webp 512w, /img/posts/ctf/hkcert22/assets/base64-letter-frequencies-1024w.webp 1024w, /img/posts/ctf/hkcert22/assets/base64-letter-frequencies-1200w.webp 1200w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1200px"></a></p><p class="caption"><sup>Frequency of the English alphabet. (Source: Wikipedia.)</sup></p><p>In the same vein, some letters and sequences in the <em>Base64 encoding</em> will also appear more frequently than others.</p><p>With this in mind, we can compare the ciphertext to the Base64 encoding of some random article (also in English, of course). For this, I copied some articles from <a href="https://lite.cnn.com/en" rel="noreferrer" target="_blank">CNN Lite</a> (text-only, so it's easier to copy), encoded it, then analysed letter frequencies using <a href="https://www.dcode.fr/frequency-analysis" rel="noreferrer" target="_blank">dcode.fr</a>. You could use this excellent article as well:</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">V2UncmUgbm8gc3RyYW5nZXJzIHRvIGxvdmUKWW91IGtub3cgdGhlIHJ1bGVzIGFuZCBzbyBkbyBJIChkbyBJKQpBIGZ1bGwgY29tbWl0bWVudCdzIHdoYXQgSSdtIHRoaW5raW5nIG9mCllvdSB3b3VsZG4ndCBnZXQgdGhpcyBmcm9tIGFueSBvdGhlciBndXkKSSBqdXN0IHdhbm5hIHRlbGwgeW91IGhvdyBJJ20gZmVlbGluZwpHb3R0YSBtYWtlIHlvdSB1bmRlcnN0YW5kCk5ldmVyIGdvbm5hIGdpdmUgeW91IHVwCk5ldmVyIGdvbm5hIGxldCB5b3UgZG93bgpOZXZlciBnb25uYSBydW4gYXJvdW5kIGFuZCBkZXNlcnQgeW91Ck5ldmVyIGdvbm5hIG1ha2UgeW91IGNyeQpOZXZlciBnb25uYSBzYXkgZ29vZGJ5ZQpOZXZlciBnb25uYSB0ZWxsIGEgbGllIGFuZCBodXJ0IHlvdQo=</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><div class="center rw mb-2 jw-90 lightbox-gallery"><a class="" title="dcode.fr frequency analysis for normal Base64." href="/img/posts/ctf/hkcert22/assets/b64-plain-1gram-666w.webp"><img class="jw-45 multi" src="/img/posts/ctf/hkcert22/assets/b64-plain-1gram-666w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 666 / 800" alt="dcode.fr frequency analysis for normal Base64." title="dcode.fr frequency analysis for normal Base64." srcset="/img/posts/ctf/hkcert22/assets/b64-plain-1gram-256w.webp 256w, /img/posts/ctf/hkcert22/assets/b64-plain-1gram-512w.webp 512w, /img/posts/ctf/hkcert22/assets/b64-plain-1gram-666w.webp 666w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 666px"></a><a class="" title="dcode.fr frequency analysis for encrypted Base64." href="/img/posts/ctf/hkcert22/assets/b64-crypt-1gram-666w.webp"><img class="jw-45 multi" src="/img/posts/ctf/hkcert22/assets/b64-crypt-1gram-666w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 666 / 800" alt="dcode.fr frequency analysis for encrypted Base64." title="dcode.fr frequency analysis for encrypted Base64." srcset="/img/posts/ctf/hkcert22/assets/b64-crypt-1gram-256w.webp 256w, /img/posts/ctf/hkcert22/assets/b64-crypt-1gram-512w.webp 512w, /img/posts/ctf/hkcert22/assets/b64-crypt-1gram-666w.webp 666w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 666px"></a></div><p class="caption"><sup>Frequency analysis of plain vs. encrypted Base64. Left: CNN Lite articles. Right: Encrypted challenge text.</sup></p><p>From this, we can deduce that 'w' was mapped from 'G' in the original encoding (due to the gap in frequency).</p><p>One useful option is the <strong>bigrams/n-grams</strong> option. We can tell dcode to analyse frequencies of <em>groups of characters</em> with a sliding window. This is useful to identify words and sequences.</p><div class="center rw mb-2 jw-90 lightbox-gallery"><a class="" title="dcode.fr 4-gram for normal Base64." href="/img/posts/ctf/hkcert22/assets/b64-plain-4gram-672w.webp"><img class="jw-45 multi" src="/img/posts/ctf/hkcert22/assets/b64-plain-4gram-672w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 672 / 800" alt="dcode.fr 4-gram for normal Base64." title="dcode.fr 4-gram for normal Base64." srcset="/img/posts/ctf/hkcert22/assets/b64-plain-4gram-256w.webp 256w, /img/posts/ctf/hkcert22/assets/b64-plain-4gram-512w.webp 512w, /img/posts/ctf/hkcert22/assets/b64-plain-4gram-672w.webp 672w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 672px"></a><a class="" title="dcode.fr 4-gram for encrypted Base64." href="/img/posts/ctf/hkcert22/assets/b64-crypt-4gram-672w.webp"><img class="jw-45 multi" src="/img/posts/ctf/hkcert22/assets/b64-crypt-4gram-672w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 672 / 800" alt="dcode.fr 4-gram for encrypted Base64." title="dcode.fr 4-gram for encrypted Base64." srcset="/img/posts/ctf/hkcert22/assets/b64-crypt-4gram-256w.webp 256w, /img/posts/ctf/hkcert22/assets/b64-crypt-4gram-512w.webp 512w, /img/posts/ctf/hkcert22/assets/b64-crypt-4gram-672w.webp 672w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 672px"></a></div><p class="caption"><sup>Frequency analysis of 4-grams in plain vs. encrypted Base64. Left: CNN Lite articles. Right: Encrypted challenge text.</sup></p><p>Observe how "YoJP0H" occurs (relatively) frequently. This corresponds to "IHRoZS", which happens to be the Base64 encoding for " the".</p><h2 id="more-heuristics" tabindex="-1"><a class="md-anchor" href="#more-heuristics" aria-hidden="true"></a> More Heuristics</h2><p>Frequency analysis is useful to group letters into buckets. But using frequency analysis alone is painful. Some guesswork is needed. Here's the complete process I went through:</p><ul><li><p>Frequency Analysis: use dcode.fr to associate frequent characters.</p><ul><li><p>We can make use of our earlier constraints to eliminate wrong guesses.<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup></p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Dictionary of guessed mappings.</span>
<span class="token comment"># key: shuffled Base64; value: plain Base64</span>
guesses <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'w'</span><span class="token punctuation">:</span> <span class="token string">'G'</span><span class="token punctuation">,</span>       <span class="token string">'Y'</span><span class="token punctuation">:</span> <span class="token string">'I'</span><span class="token punctuation">,</span>
    <span class="token string">'o'</span><span class="token punctuation">:</span> <span class="token string">'H'</span><span class="token punctuation">,</span>       <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token string">'B'</span><span class="token punctuation">,</span>

    <span class="token comment"># " the "</span>
    <span class="token string">'J'</span><span class="token punctuation">:</span> <span class="token string">'R'</span><span class="token punctuation">,</span>       <span class="token string">'P'</span><span class="token punctuation">:</span> <span class="token string">'o'</span><span class="token punctuation">,</span>
    <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'Z'</span><span class="token punctuation">,</span>       <span class="token string">'H'</span><span class="token punctuation">:</span> <span class="token string">'S'</span><span class="token punctuation">,</span>

    <span class="token comment"># More snipped out.</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> c<span class="token punctuation">,</span> g <span class="token keyword">in</span> guesses<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Our guess should be whitelisted!</span>
    <span class="token keyword">assert</span> <span class="token builtin">set</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span>issubset<span class="token punctuation">(</span>whitelist<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> gc <span class="token keyword">in</span> g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'mismatch for </span><span class="token interpolation"><span class="token punctuation">{</span>c<span class="token punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>g<span class="token punctuation">}</span></span><span class="token string">, whitelist: </span><span class="token interpolation"><span class="token punctuation">{</span>whitelist<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">'</span></span>
    whitelist<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> g <span class="token comment"># Throw away all other values.</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><a class="lightbox-single" title="Results!" href="/img/posts/ctf/hkcert22/assets/base64-progress-1-1000w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/ctf/hkcert22/assets/base64-progress-1-1000w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1000 / 171" alt="Partially decrypted output of the Base64 encryption." title="Results!" srcset="/img/posts/ctf/hkcert22/assets/base64-progress-1-256w.webp 256w, /img/posts/ctf/hkcert22/assets/base64-progress-1-512w.webp 512w, /img/posts/ctf/hkcert22/assets/base64-progress-1-1000w.webp 1000w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 1000px"></a></p><p class="caption"><sup>Random decoding after frequency analysis.</sup></p><p class="no-center"></p></li></ul></li><li><p>Guesswork: guess English from the <s>nonsense</s> existing characters.</p><ul><li><p>e.g. "Eog:ish" ‚Üí "English", "qepqesents" ‚Üí "represents", "pqese&amp;ved" ‚Üí "preserved"</p></li><li><p>Once we patched a word, other words became easier to patch.</p><p><a class="lightbox-single" title="Moar results!!!" href="/img/posts/ctf/hkcert22/assets/base64-progress-2-1000w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/ctf/hkcert22/assets/base64-progress-2-1000w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1000 / 159" alt="More decrypted output of the Base64 encryption. Some words are starting to make sense." title="Moar results!!!" srcset="/img/posts/ctf/hkcert22/assets/base64-progress-2-256w.webp 256w, /img/posts/ctf/hkcert22/assets/base64-progress-2-512w.webp 512w, /img/posts/ctf/hkcert22/assets/base64-progress-2-1000w.webp 1000w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 1000px"></a></p><p class="caption"><sup>Random decoding after guessing.</sup></p><p class="no-center"></p></li><li><p>At this point, we can continue patching "ciphertext", "letters", "potential", etc. Or we could just use...</p></li></ul></li><li><p>Google: after decoding a sizeable portion, let's pray and hope the plaintext is open-source. Then use the plaintext to derive the rest of the mapping.</p><ul><li><p>It turns out the plaintext is‚Äîquite aptly‚Äîthe <a href="https://en.wikipedia.org/wiki/Frequency_analysis" rel="noreferrer" target="_blank">Wikipedia summary of frequency analysis</a>.</p><p><a class="lightbox-single" title="Rrrreeeeeeeeeeeee." href="/img/posts/ctf/hkcert22/assets/base64-wikipedia-frequency-analysis-1000w.webp"><img class="mb-2 rw center jw-85" src="/img/posts/ctf/hkcert22/assets/base64-wikipedia-frequency-analysis-1000w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1000 / 413" alt="Wikipedia summary of frequency analysis." title="Rrrreeeeeeeeeeeee." srcset="/img/posts/ctf/hkcert22/assets/base64-wikipedia-frequency-analysis-256w.webp 256w, /img/posts/ctf/hkcert22/assets/base64-wikipedia-frequency-analysis-512w.webp 512w, /img/posts/ctf/hkcert22/assets/base64-wikipedia-frequency-analysis-1000w.webp 1000w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 1000px"></a></p></li></ul></li></ul><p>Finding the rest of the mappings was quite easy. After a bit more tuning, we get the flag.</p><h2 id="final-remarks" tabindex="-1"><a class="md-anchor" href="#final-remarks" aria-hidden="true"></a> Final Remarks</h2><p>Usually I play reverse and don‚Äôt touch cryptography, but all I can say is: this was basically playing an English reverse challenge under the hood. Forget C, C++, Java, .Net, and Rust. Reversing English is the best. üòõ</p><p>There are probably better ways to automatically perform frequency analysis and search for mappings. I went for a hybrid method of Python scripting + manually checking two dcode tabs. Perhaps a second monitor would‚Äôve helped, but I have nowhere to place it. üòê</p><h2 id="flag" tabindex="-1"><a class="md-anchor" href="#flag" aria-hidden="true"></a> Flag</h2><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">hkcert22{b4s3_s1x7y_f0ur_1s_4n_3nc0d1n9_n07_4n_encryp710n}</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><hr class="footnotes-sep"><b>Footnotes</b><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>What about √© and √†, as in d√©j√† vu? Well, although those <em>are</em> technically in the extended ASCII character set, they should be rare enough. (Also I think Python encodes them differently from regular ASCII.) <a href="#fnref1" class="footnote-backref">‚Ü©Ô∏é</a></p></li><li id="fn2" class="footnote-item"><p>But what about newline (<code>\n</code>, ASCII 10) and carriage return (<code>\r</code>, ASCII 13)? These are also possible to have in plaintext messages. We shouldn‚Äôt entirely discount these, but as they‚Äôre relatively rare, we won‚Äôt consider them for now. <a href="#fnref2" class="footnote-backref">‚Ü©Ô∏é</a></p></li><li id="fn3" class="footnote-item"><p>Later on, we removed the second/third-MSB constraint since it got in the way of decoding <code>\n</code>. <a href="#fnref3" class="footnote-backref">‚Ü©Ô∏é</a></p></li></ol></section></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="HKCERT CTF 2022 ‚Äì Base64 Encryption" data-url="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="HKCERT CTF 2022 ‚Äì Base64 Encryption" data-url="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="HKCERT CTF 2022 ‚Äì Base64 Encryption" data-url="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="HKCERT CTF 2022 ‚Äì Base64 Encryption" data-url="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="HKCERT CTF 2022 ‚Äì Base64 Encryption" data-url="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="HKCERT CTF 2022 ‚Äì Base64 Encryption" data-url="https://trebledj.me/posts/hkcert-2022-base64-encryption/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/arbitrary-code-execution-for-breakfast/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/arbitrary-code-execution-for-breakfast/"><img class="post-img-blurred-bg" src="/img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for Sharing is Caring: Arbitrary Code Execution for Breakfast" srcset="/img/posts/infosec/cpp-deserialization/assets/popashell-256w.webp 256w, /img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp 512w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for Sharing is Caring: Arbitrary Code Execution for Breakfast" srcset="/img/posts/infosec/cpp-deserialization/assets/popashell-256w.webp 256w, /img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp 512w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Sharing is Caring: Arbitrary Code Execution for Breakfast</h2><div class="post-summary"><p>A CTF challenge exploring binary exploitation in C++, gadget mania, and a new form of deserialization attack.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/pwn/" itemprop="keywords">pwn</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading ‚Äì Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading ‚Äì Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading ‚Äì Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/attack-of-the-zip/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/attack-of-the-zip/"><img class="post-img-blurred-bg" src="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 337" alt="Thumbnail for From Compression to Compromise: Unmasking Zip File Threats" srcset="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-256w.webp 256w, /img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 337" alt="Thumbnail for From Compression to Compromise: Unmasking Zip File Threats" srcset="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-256w.webp 256w, /img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">From Compression to Compromise: Unmasking Zip File Threats</h2><div class="post-summary"><p>Deep dive into zip file attacks and mitigations (with examples!).</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/hkcert-2023-decompetition-vitamin-cpp/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/hkcert-2023-decompetition-vitamin-cpp/"><img class="post-img-blurred-bg" src="/img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for HKCERT CTF 2023 ‚Äì Decompetition: Vitamin&nbsp;C++" srcset="/img/posts/ctf/hkcert23/assets/vitamin-cpp-256w.webp 256w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp 512w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for HKCERT CTF 2023 ‚Äì Decompetition: Vitamin&nbsp;C++" srcset="/img/posts/ctf/hkcert23/assets/vitamin-cpp-256w.webp 256w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp 512w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">HKCERT CTF 2023 ‚Äì Decompetition: Vitamin&nbsp;C++</h2><div class="post-summary"><p>A beginner-friendly writeup to reverse-engineering C++ a l√° decompetition. Years of complex shenanigans condensed!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/subtype-metaprogramming-is-mostly-harmless/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/subtype-metaprogramming-is-mostly-harmless/"><img class="post-img-blurred-bg" src="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 249" alt="Thumbnail for N[Subtype Metaprogramming] is N[Mostly Harmless]" srcset="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp 512w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-804w.webp 804w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 249" alt="Thumbnail for N[Subtype Metaprogramming] is N[Mostly Harmless]" srcset="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp 512w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-804w.webp 804w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title"><sub><sup>N[</sup></sub>Subtype Metaprogramming<sub><sup>]</sup></sub> is <sub><sup>N[</sup></sub>Mostly Harmless<sub><sup>]</sup></sub></h2><div class="post-summary"><p>Inheritance go brrrrrrrr... abusing turing-complete typesystems to write fun programs in Python.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/types/" itemprop="keywords">types</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/hitcon-2023-the-blade/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/hitcon-2023-the-blade/"><img class="post-img-blurred-bg" src="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 206" alt="Thumbnail for HITCON 2023 ‚Äì The Blade" srcset="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-256w.webp 256w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp 512w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1024w.webp 1024w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1570w.webp 1570w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 206" alt="Thumbnail for HITCON 2023 ‚Äì The Blade" srcset="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-256w.webp 256w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp 512w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1024w.webp 1024w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1570w.webp 1570w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">HITCON 2023 ‚Äì The Blade</h2><div class="post-summary"><p>Beginner-friendly writeup for a nifty Rust reversing challenge.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/rust/" itemprop="keywords">rust</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to cryptography, ctf">software.security</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/ctf/">ctf</a> <a class="jtag" href="/tags/infosec/">infosec</a> <a class="jtag" href="/tags/reverse/">reverse</a> <a class="jtag" href="/tags/pentesting/">pentesting</a> <a class="jtag" href="/tags/pwn/">pwn</a> <a class="jtag" href="/tags/cryptography/">cryptography</a> <a class="jtag" href="/tags/cve/">cve</a> <a class="jtag" href="/tags/redteam/">redteam</a> <a class="jtag" href="/tags/stego/">stego</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to python">software.programming-language</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/cpp/">cpp</a> <a class="jtag" href="/tags/python/">python</a> <a class="jtag" href="/tags/c/">c</a> <a class="jtag" href="/tags/haskell/">haskell</a> <a class="jtag" href="/tags/js/">js</a> <a class="jtag" href="/tags/qt/">qt</a> <a class="jtag" href="/tags/rust/">rust</a> <a class="jtag" href="/tags/qml/">qml</a> <a class="jtag" href="/tags/sql/">sql</a> <a class="jtag" href="/tags/java/">java</a> <a class="jtag" href="/tags/scala/">scala</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to writeup">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p>Comments are back! Privacy-focused; without ads, bloatware ü§Æ, and trackers. Be one of the first to contribute to the discussion‚Äî before AI invades social media, world leaders declare war on guppies, and what little humanity left is lost to time.</p><script defer src="/js/comentario.min.js"></script><script>if(window.location.hash.startsWith("#comentario")){const a=document.getElementById("comments");a&&a.scrollIntoView({behavior:"smooth"})}</script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://infosec.exchange/@trebledj" target="_blank"><i class="social-icon fab fa-mastodon" style="color:rgb(99, 101, 255) !important;"></i> </a><a rel="me noreferrer" href="https://x.com/trebledjjj" target="_blank"><i class="social-icon fab fa-twitter" style="color:rgb(99, 101, 255) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;¬©&nbsp;2026&nbsp;TrebledJ ‚Ä¢ <a href="/privacy-policy">Privacy&nbsp;Policy</a> ‚Ä¢ <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/YmP0cUsv-I.js"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" rel="stylesheet" media="print"><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!0})})</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>