<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>AOC 2021 Day&amp;nbsp;22 – Reactor Reboot - TrebledJ's Pages</title><meta name="description" content="Reboot reactors from a submarine using set theory."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,aoc 2021 day&amp;nbsp;22 – reactor reboot,reboot reactors from a submarine using set theory.,programming,aoc,rust,mathematics,writeup"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-5e8R4YC3Atf/5McNMkFk4TZYUtMEItdy9ikt1KUoPSc=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-kQnTuA4pPVYgo0bCEGXSCEkD+CzMbRrhb5Cn58IydSA=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="AOC 2021 Day&amp;nbsp;22 – Reactor Reboot - TrebledJ's Pages"><meta property="twitter:title" content="AOC 2021 Day&amp;nbsp;22 – Reactor Reboot - TrebledJ's Pages"><meta property="og:description" content="Reboot reactors from a submarine using set theory.

This post is a (very very late) writeup on solving the Advent of Code 2021 Day 22 challenge. This was one of the challenges I spent more time on, and..."><meta property="twitter:description" content="Reboot reactors from a submarine using set theory.

This post is a (very very late) writeup on solving the Advent of Code 2021 Day 22 challenge. This was one of the challenges I spent more time on, and..."><meta property="og:url" content="https://trebledj.me/posts/aoc-2021-day-22/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-800w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-thumbnail-800w.webp"><meta property="article:published_time" content="2022-12-02T00:00:00.000Z"><meta property="article:modified_time" content="2022-12-03T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="programming"><meta property="article:tag" content="programming"><meta property="article:tag" content="aoc"><meta property="article:tag" content="rust"><meta property="article:tag" content="mathematics"><meta property="article:tag" content="writeup"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-6e60ae6c5e022aba.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><style></style><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;var reloadDisqus=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");"dark"===e?(setMode("light"),reloadDisqus&&reloadDisqus()):"light"===e?(setMode("dark"),reloadDisqus&&reloadDisqus()):setMode(defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#the-problem">The Problem</a></li><li><a href="#solving">Solving</a><ol><li><a href="#parsing">Parsing</a></li><li><a href="#a-naive-approach">A Naive Approach</a></li><li><a href="#a-set-union-approach">A Set Union Approach</a></li><li><a href="#can-we-build-it-yes-we-can">Can we build it? Yes, we can!</a></li><li><a href="#what-the-heck-is-the-inclusion-exclusion-principle">What the heck is the Inclusion-Exclusion Principle?</a></li><li><a href="#the-inclusion-exclusion-principle-as-dfs">The Inclusion-Exclusion Principle as DFS</a></li></ol></li><li><a href="#final-remarks">Final Remarks</a></li><li><a href="#full-script">Full Script</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-12-02T08:00:00.000+08:00">2022‑12‑02</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2022-12-03T08:00:00.000+08:00">2022‑12‑03</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">9 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/rust/" itemprop="keywords">rust</a> </span><span><a class="jtag" href="/tags/mathematics/" itemprop="keywords">mathematics</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#the-problem">The Problem</a></li><li><a href="#solving">Solving</a><ol><li><a href="#parsing">Parsing</a></li><li><a href="#a-naive-approach">A Naive Approach</a></li><li><a href="#a-set-union-approach">A Set Union Approach</a></li><li><a href="#can-we-build-it-yes-we-can">Can we build it? Yes, we can!</a></li><li><a href="#what-the-heck-is-the-inclusion-exclusion-principle">What the heck is the Inclusion-Exclusion Principle?</a></li><li><a href="#the-inclusion-exclusion-principle-as-dfs">The Inclusion-Exclusion Principle as DFS</a></li></ol></li><li><a href="#final-remarks">Final Remarks</a></li><li><a href="#full-script">Full Script</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">AOC&nbsp;2021 Day&nbsp;22 – Reactor Reboot</h1><p class="post-desc" itemprop="alternativeHeadline">Reboot reactors from a submarine using set theory.</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-12-02T08:00:00.000+08:00">2022‑12‑02</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2022-12-03T08:00:00.000+08:00">2022‑12‑03</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">9 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/rust/" itemprop="keywords">rust</a> </span><span><a class="jtag" href="/tags/mathematics/" itemprop="keywords">mathematics</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><p>This post is a (very very late) writeup on solving the <a href="/tags/aoc/">Advent of Code</a> <a href="https://adventofcode.com/2021/day/22" rel="noreferrer" target="_blank">2021 Day 22 challenge</a>. This was one of the challenges I spent more time on, and ended up developing three algorithms (which is a bit overkill), all using set theory. I also ended up writing all three in both Haskell and Rust, and benchmarking to compare the runtimes. Needless to say, Rust ran about 25%-50% faster, but performance tuning is not the main point of this article.</p><p>I'll <em>mainly</em> show code snippets and implementations in Rust, well, because I think it's more readable. But the general ideas are similar in Haskell.</p><h2 id="the-problem" tabindex="-1"><a class="md-anchor" href="#the-problem" aria-hidden="true"></a> The Problem</h2><p>It’s a fun, little problem. We're given a list of input. Each line specifies an action (<code>on</code> or <code>off</code>) and a cuboid (rectangular prism) of points <code>x=10..12,y=10..12,z=10..12</code>. Each line will switch all points within the cuboid on or off.</p><p>Sample input:</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">on x=10..12,y=10..12,z=10..12
on x=11..13,y=11..13,z=11..13
off x=9..11,y=9..11,z=9..11
on x=10..10,y=10..10,z=10..10</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>The objective is to determine the number of points that are still <code>on</code> after applying every line.</p><h2 id="solving" tabindex="-1"><a class="md-anchor" href="#solving" aria-hidden="true"></a> Solving</h2><p>There are three main components to most of my AOC solves. For this challenge, we'll be implementing these functions.</p><ol><li><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">parse</span><span class="token punctuation">(</span>contents<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Command</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">...</span> <span class="token punctuation">}</span></code>,</li><li><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">part1</span><span class="token punctuation">(</span>cmds<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Command</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span> <span class="token punctuation">...</span> <span class="token punctuation">}</span></code>, and</li><li><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">part2</span><span class="token punctuation">(</span>cmds<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Command</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span> <span class="token punctuation">...</span> <span class="token punctuation">}</span></code>.</li></ol><p>For Day 22, the only difference between part 1 and part 2 is the bound size, so a solution for part 2 would also be able to solve part 1 (but of course I didn't know this until later).</p><h3 id="parsing" tabindex="-1"><a class="md-anchor" href="#parsing" aria-hidden="true"></a> Parsing</h3><p>Parsing is actually pretty straightforward, so let's get it out of the way first. Essentially, we translate each line of text to a 2-tuple: <code>(bool, Cuboid)</code>.</p><div class="code-toolbar"><pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token comment">// Some useful type aliases.</span>
<span class="token attribute attr-name">#[allow(non_camel_case_types)]</span>
<span class="token keyword">type</span> <span class="token type-definition class-name">cube_t</span> <span class="token operator">=</span> <span class="token keyword">i64</span><span class="token punctuation">;</span>

<span class="token comment">// Each pair corresponds to min/max values in a dimension.</span>
<span class="token keyword">type</span> <span class="token type-definition class-name">Cuboid</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Command</span><span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">,</span> <span class="token class-name">Cuboid</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Parse takes a String and returns a Vec of Commands.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">parse</span><span class="token punctuation">(</span>contents<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Command</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> re <span class="token operator">=</span> <span class="token class-name">Regex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">r"(on|off) x=(-?\d+)..(-?\d+),y=(-?\d+)..(-?\d+),z=(-?\d+)..(-?\d+)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    contents
        <span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Split text at lines.</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>s<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> cap <span class="token keyword">in</span> re<span class="token punctuation">.</span><span class="token function">captures_iter</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Match with regex, and get capture groups.</span>
                <span class="token keyword">return</span> <span class="token class-name">Command</span><span class="token punctuation">(</span>
                    <span class="token comment">// Capture group 0 is the entire matched string. So we start with 1, to obtain the first capture group.</span>
                    cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span>   <span class="token comment">// str's parse is builtin and returns an Option&lt;_&gt;.</span>
                        <span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span>cube_t<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cap<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span>cube_t<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span>cube_t<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cap<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span>cube_t<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span>cube_t<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cap<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span>cube_t<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token macro property">unreachable!</span><span class="token punctuation">(</span><span class="token string">"aaaaaah"</span><span class="token punctuation">)</span> <span class="token comment">// Safety measure. We assume all lines follow the above pattern.</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Rust</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><br><h3 id="a-naive-approach" tabindex="-1"><a class="md-anchor" href="#a-naive-approach" aria-hidden="true"></a> A Naive Approach</h3><p>Our first attempt may be to use a naive brute force approach. We keep track of every single point and whether it is toggled or not. Of course this will not scale well especially if the cubes become larger; but for part 1 of the challenge, it is sufficient. Part 1 simply confines the scope of our problem to <code>((-50, 50), (-50, 50), (-50, 50))</code>. Any points activated or deactivated outside can be disregarded.</p><p>We can use a HashSet to store the 3D points. <code>on</code> would correspond with <code>set.insert</code> and <code>off</code> would correspond to <code>set.remove</code>. Thus after processing, we just need to <em>count</em> the number of elements (<code>set.len()</code>) to get the number of points that are left <strong>on</strong>.</p><p>Further, we’ll also restrict our scope by using <code>.max</code> and <code>.min</code> so that if, say <code>x1</code> is way out there at <code>-1000</code>, <code>x1.max(-r)</code> will pull it back to <code>-50</code>.</p><div class="code-toolbar"><pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token comment">// Solution 1: Brute-force Approach.</span>
<span class="token keyword">type</span> <span class="token type-definition class-name">Set</span> <span class="token operator">=</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">brute_force</span><span class="token punctuation">(</span>cmds<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Command</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> set<span class="token punctuation">:</span> <span class="token class-name">Set</span> <span class="token operator">=</span> <span class="token class-name">HashSet</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token operator">&amp;</span><span class="token class-name">Command</span><span class="token punctuation">(</span>onoff<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>y1<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>z1<span class="token punctuation">,</span> z2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">in</span> cmds <span class="token punctuation">{</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> x1<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token punctuation">)</span><span class="token punctuation">..=</span>x2<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> y1<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token punctuation">)</span><span class="token punctuation">..=</span>y2<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> k <span class="token keyword">in</span> z1<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token punctuation">)</span><span class="token punctuation">..=</span>z2<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> onoff <span class="token punctuation">{</span>
                        set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    set<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">u32</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Rust</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Simple, right? Unfortunately for large cuboids this approach becomes extremely slow. By “large”, I mean cuboids like <code>x=-100000..100000, y=-100000..100000, z=-100000..100000</code>.</p><p>To deal with these big numbers, we need to bring in some big guns!</p><h3 id="a-set-union-approach" tabindex="-1"><a class="md-anchor" href="#a-set-union-approach" aria-hidden="true"></a> A Set Union Approach</h3><p>In part 1, our scope was limited to a 100x100x100 cube centred on the origin. Part 2 <em>removes</em> this scope, meaning we have to take into account <em>every single point in existence</em>! Time to use this organ called the brain!</p><p><a class="lightbox-single" title="Pikachu, use brain!" href="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-bigbrain-600w.webp"><img class="mb-2 rw center jw-45" src="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-bigbrain-600w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 600 / 452" alt="Pikachu, use brain!" title="Pikachu, use brain!" srcset="/img/posts/programming/aoc-2021/assets/aoc-2021-day-22-bigbrain-256w.webp 256w, /img/posts/programming/aoc-2021/assets/aoc-2021-day-22-bigbrain-512w.webp 512w, /img/posts/programming/aoc-2021/assets/aoc-2021-day-22-bigbrain-600w.webp 600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 600px"></a></p><p>Let’s start with some investigative work and put on our thinking caps. For the moment, let’s imagine we’re working in 2D instead of 3D. Also, imagine our input is in some generic form.</p><div class="mb-2 rw center jw-75 video"><video autoplay loop muted class="jw-100"><source src="/img/aoc-2021-day-22-anim1.mp4" type="video/mp4"></video></div><p class="caption"><sup>$A$ <code>on</code>, $B$ <code>on</code>, $C$ <code>on</code>.</sup></p><div class="mb-2 rw center jw-75 video"><video autoplay loop muted class="jw-100"><source src="/img/aoc-2021-day-22-anim2.mp4" type="video/mp4"></video></div><p class="caption"><sup>$A$ <code>on</code>, $B$ <code>off</code>, $C$ <code>on</code>.</sup></p><p>When $A$ turns <code>on</code>, all the points in $A$ light up. Currently, we have $|A|$ points. Now let’s explore our next options.</p><ul><li>$B$ turns <code>on</code>. We now have $|A \cup B|$ points.</li><li>$B$ turns <code>off</code>. How many points were switched off? Well, we simply subtract the intersection $|A \cap B|$, so that we end up with $|A| - |A \cap B| = |A \cup B| - |B|$ points.</li></ul><p>Continuing further, we have</p><ul><li><p>$B$ <code>on</code>: $|A \cup B|$.</p><ul><li><p>$C$ <code>on</code> → $|A \cup B \cup C|$ points.</p></li><li><p>$C$ <code>off</code> → Again, we subtract the intersection. $|A \cup B| - |(A \cup B) \cap C| = |A \cup B \cup C| - |C|$ points.</p></li></ul></li><li><p>$B$ <code>off</code>: $|A \cup B| - |B|$.</p><ul><li><p>$C$ <code>on</code> → We want to add $|C|$, but suppose the points were already counted? We would need to subtract the <em>double-counted</em> points by considering the intersection of the new set $C$ and <strong>original</strong> points. We thus have—brace yourself—three new terms: $- |(A \cup B) \cap C|$, $+ |B \cap C|$, and $+ |C|$.</p><p>$$ \underbrace{|A \cup B| - |B|}_{\text{original sets}} - \underbrace{|(A \cup B) \cap C| + |B \cap C|}_{\text{subtract double-counted}} + |C|. $$</p><p>Regrouping and simplifying, we get</p><p>$$ \begin{align*} &amp;|A \cup B| + |C| - |(A \cup B) \cap C| - |B| + |B \cap C| \\ &amp;= \underbrace{|A \cup B \cup C| - |B \cup C|}_{\text{original sets unioned with } C} + \underbrace{|C|}_{\text{new}}. \end{align*} $$</p><p>Notice how we started off from $|A \cup B| - |B|$, and now we've simply extended them with $\cup\ C$ and added a $|C|$ term.</p><p>This is actually similar to what we did when turning $B$ <code>off</code> the first time! We originally had $|A|$, then introduced $\cup\ B$, and subtracted $|B|$ so that we don’t count anything from $B$. We <strong>subtracted</strong> $|B|$ then, since we were turning $B$ <code>off</code>, but now we <em>add</em> $|C|$ since we’re turning $C$ <code>on</code>.</p><p>Finally, let’s see what happens for the $A$ <code>on</code>, $B$ <code>off</code>, $C$ <code>off</code> case.</p></li><li><p>$C$ <code>off</code> → We can think of this as similar to the $B$ <code>off</code> $C$ <code>on</code> path above, except we don’t add the $|C|$ term. So we just have two terms:</p><p>$$ \begin{align*} &amp;\underbrace{|A \cup B \cup C| - |B \cup C| + |C|}_{\text{same as } B \text{ off, } C \text{ on}} - \underbrace{|C|}_{\text{new}} \\ &amp;= |A \cup B \cup C| - |B \cup C|. \end{align*} $$</p></li></ul></li></ul><p>Notice that as we consider a new set, we union it with the previous sets. For example, $A$ <code>on</code> $B$ <code>off</code> has $|A \cup B| - |B|$ points. After adding $C$ <code>off</code>, we have $|A \cup B \cup C| - |B \cup C|$ points. Notice the similarity?</p><p>Moreover, we add a new term each time we change between <code>on</code> and <code>off</code>. We see this above in when going from $A$ <code>on</code> to $B$ <code>off</code>, from $B$ <code>on</code> to $C$ <code>off</code>, and $B$ <code>off</code> to $C$ <code>on</code>. Each time it’s one new term, and it’s the opposite sign of the previous term. It goes without saying, that this can be generalised.</p><h3 id="can-we-build-it-yes-we-can" tabindex="-1"><a class="md-anchor" href="#can-we-build-it-yes-we-can" aria-hidden="true"></a> Can we build it? Yes, we can!</h3><p>Moving on to practical matters… how do we code this? We’ll separate the logic into two stages: one for building a set expression, the other for evaluating the expression.</p><p>Taking a lesson from functional programming, let’s discuss data and representation first. We can represent a union as a vector of cuboids: <code>Vec&lt;Cuboid&gt;</code>. But a cuboid is six integers, and the sets in our union all come from the input. So we can actually use a vector of indices instead: <code>Vec&lt;usize&gt;</code>. We’ll wrap these vectors in another container to represent our alternating union (this means every second term subtracts). I went for <code>LinkedList</code> for performance, but <code>Vec</code> should work as well.</p><p>Let’s build our set expression then:</p><div class="code-toolbar"><pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token keyword">let</span> <span class="token keyword">mut</span> alternating_unions<span class="token punctuation">:</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">usize</span><span class="token operator">&gt;&gt;</span> <span class="token operator">=</span> <span class="token class-name">LinkedList</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> lookup <span class="token operator">=</span> cmds<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span><span class="token class-name">Command</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> c<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">Command</span><span class="token punctuation">(</span>on<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">in</span> cmds<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> v <span class="token keyword">in</span> alternating_unions<span class="token punctuation">.</span><span class="token function">iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        v<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Push the current tag.</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>alternating_unions<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> on <span class="token punctuation">{</span>
        <span class="token comment">// A new union term is added if "on" and even, or "off" and odd.</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        v<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>cmds<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Smol optimisation.</span>
        alternating_unions<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Rust</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Evaluating the union is simply a matter of taking the set of unions, applying the inclusion-exclusion and generating a DFS tree with pruning. Those are some pretty big words. Let’s unpack it a bit.</p><h3 id="what-the-heck-is-the-inclusion-exclusion-principle" tabindex="-1"><a class="md-anchor" href="#what-the-heck-is-the-inclusion-exclusion-principle" aria-hidden="true"></a> What the heck is the Inclusion-Exclusion Principle?</h3><p>Given two sets $A$ and $B$, we can compute the union through $|A \cup B| = |A| + |B| - |A \cap B|$. The idea is that we add $A$ and $B$; but since we double-counted the overlapping region ($A \cap B$), we subtract it once to balance things out. It turns out this principle can be generalised for any number of sets.</p><p><a class="lightbox-single" title="Venn diagram of the inclusion-exclusion principle." href="/img/VennDiagram_900-1024w.webp"><img class="mb-2 rw center jw-65 alpha-img" src="/img/VennDiagram_900-351w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 351 / 152" alt="Venn diagram of the inclusion-exclusion principle." title="Venn diagram of the inclusion-exclusion principle." srcset="/img/VennDiagram_900-256w.webp 256w, /img/VennDiagram_900-351w.webp 351w, /img/VennDiagram_900-512w.webp 512w, /img/VennDiagram_900-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 351px"></a></p><p>Take a look at the diagram and convince yourself that for three sets, we have</p><p>$$ \begin{align*} |A\nobreak\cup\nobreak B\nobreak\cup\nobreak C| = &amp;|A| + |B| + |C| \\ &amp;- |A \cap B| - |A \cap C| - |B \cap C| \\ &amp;+ |A \cap B \cap C|. \end{align*} $$</p><p>The inclusion-exclusion principle extends this idea to $n$ sets by including (adding) sets and excluding (subtracting) sets. The general formula for $n$ sets is</p><p>$$ \left| \bigcup_{i=0}^n A_i \right| = \sum_{k=1}^n (-1)^{k+1} \left( \sum_{1 \le i_1 &lt; \cdots &lt; i_k \le n} |A_{i_1} \cap \cdots \cap A_{i_k}| \right). $$</p><h3 id="the-inclusion-exclusion-principle-as-dfs" tabindex="-1"><a class="md-anchor" href="#the-inclusion-exclusion-principle-as-dfs" aria-hidden="true"></a> The Inclusion-Exclusion Principle as DFS</h3><p>Earlier I mentioned DFS with pruning. Why DFS?</p><p>Let’s say we want to evaluate $|A \cup B \cup C|$. In a breadth-first approach, we would first evaluate the $k=1$ sets ($|A|$, $|B|$, $|C|$), followed by the $k=2$ sets ($|A \cap B|$, $|A \cap C|$, $|B \cap C|$), and so on. However, a depth-first approach would be more efficient in this case. Once we’ve computed $|A \cap B|$, we can compute $|A \cap B \cap C|$ as well.</p><p>Here’s a DFS tree for computing $|A \cup B \cup C|$:</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">A u B u C
|-- A
|   |-- A n B
|   |   |-- A n B n C
|   |
|   |-- A n C
|
|-- B
|   |-- B n C
|
|-- C</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Can we parallelise this? Probably. But let’s leave that for another time.</p><p>Now what if two sets are disjoint? Suppose $A = ((0, 10), (0, 10), (0, 10))$ and $B = ((100, 200), (0, 10), (0, 10))$. These two sets have nothing in common, i.e. $A \cap B = \varnothing$. It follows that $A \cap B \cap C = \varnothing$. Thus, once we know a set has no intersection, we don’t need to further explore its branches. This is the <strong>pruning</strong> part of the DFS.</p><div class="code-toolbar"><pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token comment">// @brief   Computes the number of points in a cuboid.</span>
<span class="token comment">// @return  Number of points in a cuboid.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">eval_cuboid</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>y1<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>z1<span class="token punctuation">,</span> z2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Cuboid</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u64</span> <span class="token punctuation">{</span> <span class="token punctuation">...</span> <span class="token punctuation">}</span>

<span class="token comment">// @brief   Computes the intersection of a cuboid.</span>
<span class="token comment">// @return  Some(Cuboid) if the intersection exists, None otherwise.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">intersect</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> z1<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Cuboid</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> z2<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Cuboid</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Cuboid</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">...</span> <span class="token punctuation">}</span>

<span class="token comment">// @brief    Finds the intersection between two ranges.</span>
<span class="token comment">// @return   Some((cube_t, cube_t)) if an intersection exists, None if there is no intersection.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">range_intersect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>b1<span class="token punctuation">,</span> b2<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>cube_t<span class="token punctuation">,</span> cube_t<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">...</span> <span class="token punctuation">}</span>

<span class="token comment">// @brief    eval_union computes the number of points in the union of sets `u`.</span>
<span class="token comment">//</span>
<span class="token comment">// @param    lookup: A lookup table of cuboids. Our sets will be represented as an array of indices (storing one i32 instead of six i32's).</span>
<span class="token comment">// @param    add: Whether the current iteration adds or subtracts the union.</span>
<span class="token comment">// @param    int: The current intersected cuboid.</span>
<span class="token comment">// @param    u: The set of cuboids in the current union.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">eval_union</span><span class="token punctuation">(</span>lookup<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Cuboid</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> add<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span> int<span class="token punctuation">:</span> <span class="token class-name">Cuboid</span><span class="token punctuation">,</span> u<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">usize</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i64</span> <span class="token punctuation">{</span>
    u<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tag<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">match</span> <span class="token function">intersect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>int<span class="token punctuation">,</span> <span class="token operator">&amp;</span>lookup<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Some</span><span class="token punctuation">(</span>next_int<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">eval_cuboid</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>next_int<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">i64</span><span class="token punctuation">;</span>
                <span class="token keyword">let</span> rest <span class="token operator">=</span> <span class="token function">eval_union</span><span class="token punctuation">(</span>lookup<span class="token punctuation">,</span> <span class="token operator">!</span>add<span class="token punctuation">,</span> next_int<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> add <span class="token punctuation">{</span>
                    rest <span class="token operator">+</span> v
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    rest <span class="token operator">-</span> v
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// No intersection. No need to evaluate deeper, since any intersection with the empty set will just be the empty set.</span>
            <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i64</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> scope <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200000</span><span class="token punctuation">,</span> <span class="token number">200000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200000</span><span class="token punctuation">,</span> <span class="token number">200000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200000</span><span class="token punctuation">,</span> <span class="token number">200000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
alternating_unions
    <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token function">eval_union</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>lookup<span class="token punctuation">,</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> scope<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i64</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Rust</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><br><h2 id="final-remarks" tabindex="-1"><a class="md-anchor" href="#final-remarks" aria-hidden="true"></a> Final Remarks</h2><p>This was one of the more challenging (but also rewarding!) Advent of Code challenges this year. Some others propose a cuboid-slicing method as opposed to set theory. However, I find this approach difficult to grasp and plan. Moreover, cuboid-slicing appears more difficult to generalise into higher dimensions, whereas with the set theoretic approach you pretty much just need to change the data types and <code>intersect</code> functions.</p><p>Anyway, let’s end on a pedagogical note. Here are some exercises for the reader:</p><ul><li><p>The set expression we built above contains some redundant information. What is redundant, and how can we optimise it?</p></li><li><p>In the code above, we initialised our search with a scope.</p><div class="code-toolbar"><pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token keyword">let</span> scope <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200000</span><span class="token punctuation">,</span> <span class="token number">200000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200000</span><span class="token punctuation">,</span> <span class="token number">200000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200000</span><span class="token punctuation">,</span> <span class="token number">200000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Rust</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Points outside the scope won’t be considered. Rewrite the evaluation logic so that a scope doesn’t need to be specified.</p></li><li><p>In this post, we used a union-based approach, i.e. storing an alternating set of unions, then computing it by applying the inclusion-exclusion principle. Try rewriting the algorithm into an intersection-based approach. Instead of storing unions, store sets of intersections.</p><ul><li>What are the computation differences?</li><li>Compare the two algorithms. Under what circumstances are one better?</li></ul></li></ul><h2 id="full-script" tabindex="-1"><a class="md-anchor" href="#full-script" aria-hidden="true"></a> Full Script</h2><p>For completeness, here's the full d22.rs script.</p><script src="https://gist.github.com/TrebledJ/7190c102579bfde273a7b74e90116b49.js"></script></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;22 – Reactor Reboot" data-url="/posts/aoc-2021-day-22/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;22 – Reactor Reboot" data-url="/posts/aoc-2021-day-22/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;22 – Reactor Reboot" data-url="/posts/aoc-2021-day-22/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;22 – Reactor Reboot" data-url="/posts/aoc-2021-day-22/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;22 – Reactor Reboot" data-url="/posts/aoc-2021-day-22/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;22 – Reactor Reboot" data-url="/posts/aoc-2021-day-22/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"><img class="post-img-blurred-bg" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules</h2><div class="post-summary"><p>Breaking news, awesome stuff happened!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/satire/" itemprop="keywords">satire</a> </span><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/delay-and-interactive-pause-in-multithreaded-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/delay-and-interactive-pause-in-multithreaded-python/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Delay and Interactive Pause in Multi-Threaded Python</h2><div class="post-summary"><p>It's like musical chairs for threads (except no one gets left behind)!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/tutorial/" itemprop="keywords">tutorial</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/prism-plugins-in-node/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/prism-plugins-in-node/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for How to Use PrismJS Plugins with NodeJS and MarkdownIt" srcset="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for How to Use PrismJS Plugins with NodeJS and MarkdownIt" srcset="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">How to Use PrismJS Plugins with NodeJS and MarkdownIt</h2><div class="post-summary"><p>Improve your storytelling with these dead simple hacks for rendering fancy Prism plugins in Node!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a> </span><span><a class="jtag" href="/tags/js/" itemprop="keywords">js</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading – Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/automating-boolean-sql-injection-with-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/automating-boolean-sql-injection-with-python/"><img class="post-img-blurred-bg" src="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 273" alt="Thumbnail for Automating Boolean-Based SQL Injection with Python" srcset="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-256w.webp 256w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp 512w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1024w.webp 1024w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1800w.webp 1800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 273" alt="Thumbnail for Automating Boolean-Based SQL Injection with Python" srcset="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-256w.webp 256w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp 512w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1024w.webp 1024w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1800w.webp 1800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Automating Boolean-Based SQL Injection with Python</h2><div class="post-summary"><p>How to be efficiently lazy at finding hidden gems in predictable places –&nbsp;Database Edition</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/sql/" itemprop="keywords">sql</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/optimising-web-icons-for-fun/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/optimising-web-icons-for-fun/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 324" alt="Thumbnail for Optimising Web Icons for Fun" srcset="/img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-1024w.webp 1024w, /img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-1790w.webp 1790w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 324" alt="Thumbnail for Optimising Web Icons for Fun" srcset="/img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-1024w.webp 1024w, /img/posts/programming/mini-projects/optimising-web-icons/assets/optimising-web-icons-thumbnail-1790w.webp 1790w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Optimising Web Icons for Fun</h2><div class="post-summary"><p>Ejecting unused cargo for leaner performance.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a> </span><span><a class="jtag" href="/tags/performance/" itemprop="keywords">performance</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to aoc, programming">software.general</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/programming/">programming</a> <a class="jtag" href="/tags/software-engineering/">software-engineering</a> <a class="jtag" href="/tags/web/">web</a> <a class="jtag" href="/tags/aoc/">aoc</a> <a class="jtag" href="/tags/apps/">apps</a> <a class="jtag" href="/tags/dsp/">dsp</a> <a class="jtag" href="/tags/programming-languages/">programming-languages</a> <a class="jtag" href="/tags/linux/">linux</a> <a class="jtag" href="/tags/performance/">performance</a> <a class="jtag" href="/tags/functional/">functional</a> <a class="jtag" href="/tags/types/">types</a> <a class="jtag" href="/tags/windows/">windows</a> <a class="jtag" href="/tags/ai/">ai</a> <a class="jtag" href="/tags/metaprogramming/">metaprogramming</a> <a class="jtag" href="/tags/oop/">oop</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to rust">software.programming-language</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/cpp/">cpp</a> <a class="jtag" href="/tags/python/">python</a> <a class="jtag" href="/tags/c/">c</a> <a class="jtag" href="/tags/haskell/">haskell</a> <a class="jtag" href="/tags/js/">js</a> <a class="jtag" href="/tags/qt/">qt</a> <a class="jtag" href="/tags/rust/">rust</a> <a class="jtag" href="/tags/qml/">qml</a> <a class="jtag" href="/tags/sql/">sql</a> <a class="jtag" href="/tags/scala/">scala</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to mathematics, writeup">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p><em>Comments are back! Privacy-focused, without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion — I'd love to hear your thoughts.</em></p><script defer src="https://trebledj.me/js/comentario.min.js"></script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://www.codingame.com/profile/8444100ecb9723c1ec542346b0630aaa2821532" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/codingame.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://musescore.com/user/20636901" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/musescore.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2025&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/MPnrKnjI5w.js"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" rel="stylesheet" media="print"><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!0})})</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>