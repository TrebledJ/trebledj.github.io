<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>GDB/GEF Cheatsheet - TrebledJ's Pages</title><meta name="description" content="Quick command reference on one of the most powerful tools for dynamic analysis."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,gdb/gef cheatsheet,quick command reference on one of the most powerful tools for dynamic analysis.,programming,cheatsheet,infosec,ctf,pwn,reverse,learning,notes"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-5e8R4YC3Atf/5McNMkFk4TZYUtMEItdy9ikt1KUoPSc=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="GDB/GEF Cheatsheet - TrebledJ's Pages"><meta property="twitter:title" content="GDB/GEF Cheatsheet - TrebledJ's Pages"><meta property="og:description" content="Quick command reference on one of the most powerful tools for dynamic analysis.

This is a curated collection of GDB/GEF commands which I find incredibly useful for dynamic analysis and reverse engineering. These are mainly personal notes and may be incomplete, but suggestions..."><meta property="twitter:description" content="Quick command reference on one of the most powerful tools for dynamic analysis.

This is a curated collection of GDB/GEF commands which I find incredibly useful for dynamic analysis and reverse engineering. These are mainly personal notes and may be incomplete, but suggestions..."><meta property="og:url" content="https://trebledj.me/posts/gdb-cheatsheet/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/programming/cheatsheets/assets/gef-906w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/programming/cheatsheets/assets/gef-906w.webp"><meta property="article:published_time" content="2023-09-11T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="programming"><meta property="article:tag" content="programming"><meta property="article:tag" content="cheatsheet"><meta property="article:tag" content="infosec"><meta property="article:tag" content="ctf"><meta property="article:tag" content="pwn"><meta property="article:tag" content="reverse"><meta property="article:tag" content="learning"><meta property="article:tag" content="notes"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-6e60ae6c5e022aba.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><style></style><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;var reloadDisqus=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");"dark"===e?(setMode("light"),reloadDisqus&&reloadDisqus()):"light"===e?(setMode("dark"),reloadDisqus&&reloadDisqus()):setMode(defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#the-basics">The Basics</a><ol><li><a href="#hjaelp">Hjaelp!</a></li><li><a href="#execution">Execution</a></li><li><a href="#interrupting">Interrupting</a></li><li><a href="#step-debugging">Step Debugging</a></li><li><a href="#disassembly">Disassembly</a></li></ol></li><li><a href="#registers">Registers</a><ol><li><a href="#view-registers">View Registers</a></li><li><a href="#modify-registers">Modify Registers</a></li><li><a href="#watch-registers">Watch Registers</a></li></ol></li><li><a href="#memory">Memory</a><ol><li><a href="#view-memory">View Memory</a></li><li><a href="#modify-memory">Modify Memory</a></li><li><a href="#search-memory">Search Memory</a></li><li><a href="#watch-memory">Watch Memory</a></li><li><a href="#view-memory-segments">View Memory Segments</a></li></ol></li><li><a href="#stack">Stack</a><ol><li><a href="#view-stack">View Stack</a></li></ol></li><li><a href="#heap">Heap</a></li><li><a href="#breakpoints">Breakpoints</a><ol><li><a href="#breakpoint-control">Breakpoint Control</a></li><li><a href="#watchpoints">Watchpoints</a></li><li><a href="#gdb-script">GDB Script</a></li></ol></li><li><a href="#miscellaneous">Miscellaneous</a><ol><li><a href="#install-gef">Install GEF</a></li><li><a href="#pwnlib-gdb-attach">pwnlib.gdb.attach</a></li><li><a href="#input-non-printable-characters">Input Non-Printable Characters</a></li><li><a href="#enable-aslr">Enable ASLR</a></li><li><a href="#pie-breakpoints">PIE Breakpoints</a></li><li><a href="#gef-context">GEF Context</a></li></ol></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2023-09-11T08:00:00.000+08:00">2023‑09‑11</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2024-10-19T03:24:27.000+08:00">2024‑10‑18</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">7 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/cheatsheet/" itemprop="keywords">cheatsheet</a> </span><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/pwn/" itemprop="keywords">pwn</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/learning/" itemprop="keywords">learning</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#the-basics">The Basics</a><ol><li><a href="#hjaelp">Hjaelp!</a></li><li><a href="#execution">Execution</a></li><li><a href="#interrupting">Interrupting</a></li><li><a href="#step-debugging">Step Debugging</a></li><li><a href="#disassembly">Disassembly</a></li></ol></li><li><a href="#registers">Registers</a><ol><li><a href="#view-registers">View Registers</a></li><li><a href="#modify-registers">Modify Registers</a></li><li><a href="#watch-registers">Watch Registers</a></li></ol></li><li><a href="#memory">Memory</a><ol><li><a href="#view-memory">View Memory</a></li><li><a href="#modify-memory">Modify Memory</a></li><li><a href="#search-memory">Search Memory</a></li><li><a href="#watch-memory">Watch Memory</a></li><li><a href="#view-memory-segments">View Memory Segments</a></li></ol></li><li><a href="#stack">Stack</a><ol><li><a href="#view-stack">View Stack</a></li></ol></li><li><a href="#heap">Heap</a></li><li><a href="#breakpoints">Breakpoints</a><ol><li><a href="#breakpoint-control">Breakpoint Control</a></li><li><a href="#watchpoints">Watchpoints</a></li><li><a href="#gdb-script">GDB Script</a></li></ol></li><li><a href="#miscellaneous">Miscellaneous</a><ol><li><a href="#install-gef">Install GEF</a></li><li><a href="#pwnlib-gdb-attach">pwnlib.gdb.attach</a></li><li><a href="#input-non-printable-characters">Input Non-Printable Characters</a></li><li><a href="#enable-aslr">Enable ASLR</a></li><li><a href="#pie-breakpoints">PIE Breakpoints</a></li><li><a href="#gef-context">GEF Context</a></li></ol></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">GDB/GEF Cheatsheet</h1><p class="post-desc" itemprop="alternativeHeadline">Quick command reference on one of the most powerful tools for dynamic analysis.</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2023-09-11T08:00:00.000+08:00">2023‑09‑11</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2024-10-19T03:24:27.000+08:00">2024‑10‑18</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">7 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/cheatsheet/" itemprop="keywords">cheatsheet</a> </span><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/pwn/" itemprop="keywords">pwn</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/learning/" itemprop="keywords">learning</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><p>This is a curated collection of GDB/GEF commands which I find incredibly useful for dynamic analysis and reverse engineering. These are mainly personal notes and may be incomplete, but suggestions are welcome! If there's a useful GDB/GEF command you use that's not on this list, do <a href="#comments">leave a comment</a> or <a href="/#contact">let me know</a> so that I can add it. :)</p><h2 id="the-basics" tabindex="-1"><a class="md-anchor" href="#the-basics" aria-hidden="true"></a> The Basics</h2><h3 id="hjaelp" tabindex="-1"><a class="md-anchor" href="#hjaelp" aria-hidden="true"></a> Hjaelp!</h3><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Describes how to use a command.</span>
<span class="token builtin class-name">help</span>
<span class="token builtin class-name">help</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>
<span class="token builtin class-name">help</span> info
<span class="token builtin class-name">help</span> breakpoint</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="execution" tabindex="-1"><a class="md-anchor" href="#execution" aria-hidden="true"></a> Execution</h3><p><strong>Run Program with Loaded File</strong></p><div class="code-toolbar"><pre class="language-sh" tabindex="0"><code class="language-sh">gdb <span class="token operator">&lt;</span>filename<span class="token operator">&gt;</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Shell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Load Files</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token function">file</span> <span class="token operator">&lt;</span>filename<span class="token operator">&gt;</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Running</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">start    <span class="token comment"># Starts program and breaks at beginning.</span>
run      <span class="token comment"># Runs program normally.</span>
<span class="token builtin class-name">continue</span> <span class="token comment"># Continue program where you left off.</span>
<span class="token function">kill</span>     <span class="token comment"># Kill process.</span>
quit     <span class="token comment"># Leave GDB.</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Shell Commands</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">shell <span class="token operator">&lt;</span>cmd<span class="token operator">&gt;</span>
shell <span class="token builtin class-name">echo</span> Hi
<span class="token operator">!</span><span class="token operator">&lt;</span>cmd<span class="token operator">&gt;</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="interrupting" tabindex="-1"><a class="md-anchor" href="#interrupting" aria-hidden="true"></a> Interrupting</h3><p>We want to inspect a program in the guts. But how do we stop it where we want?</p><ul><li><code>^C</code> during program execution. (Also throws a <abbr data-bs-placement="top" data-bs-toggle="tooltip" title="SIGnal INTerrupt."><code>SIGINT</code></abbr>.)</li><li>Use <code>start</code> instead of <code>run</code>. Breaks after starting the program.</li><li>Use <a href="#breakpoints">breakpoints</a> (break on address).</li><li>Use <a href="#watchpoints">watchpoints</a> (break on data).</li></ul><h3 id="step-debugging" tabindex="-1"><a class="md-anchor" href="#step-debugging" aria-hidden="true"></a> Step Debugging</h3><p>Once we've stopped, what do we do? How do we navigate instructions and functions effectively?</p><p>Step debugging is one of the core features of GDB, and an invaluable tool for all programmers. Modern IDEs have step debugging functionality built-in to operate seamlessly with code. But in GDB, you can operate it with the familiar touch of your keyboard!</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Step Debugging</span>
<span class="token comment">## Step (into).</span>
step
s
<span class="token comment">## Step over.</span>
next
n
<span class="token comment">## Step (into) one instruction exactly.</span>
stepi
si
<span class="token comment">## Step over one instruction.</span>
nexti
ni
<span class="token comment">## Step out. Execute until (selected) stack frame returns (past end of function).</span>
finish
fin</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="disassembly" tabindex="-1"><a class="md-anchor" href="#disassembly" aria-hidden="true"></a> Disassembly</h3><p>Useful for verifying addresses and assembly, even if you use a decompiler.</p><p>View instructions at a function or address.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">disas <span class="token operator">&lt;</span>address/function<span class="token operator">&gt;</span>
disas <span class="token operator">&lt;</span>start addr<span class="token operator">&gt;</span>,<span class="token operator">&lt;</span>end addr<span class="token operator">&gt;</span>
disas <span class="token operator">&lt;</span>start addr<span class="token operator">&gt;</span>,+<span class="token operator">&lt;</span>offset<span class="token operator">&gt;</span>

disas main</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Enable Intel-flavoured ASM syntax.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">set</span> disassembly-flavor intel</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>View data as instructions.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">x/<span class="token punctuation">[</span>n<span class="token punctuation">]</span>i <span class="token operator">&lt;</span>addr<span class="token operator">&gt;</span>
x/20i 0x5555555dddd0</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h2 id="registers" tabindex="-1"><a class="md-anchor" href="#registers" aria-hidden="true"></a> Registers</h2><h3 id="view-registers" tabindex="-1"><a class="md-anchor" href="#view-registers" aria-hidden="true"></a> View Registers</h3><p>Show individual registers.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">print <span class="token punctuation">[</span>expression<span class="token punctuation">]</span>

print <span class="token variable">$rax</span>
p <span class="token variable">$rax</span>

<span class="token comment"># Expressions are evaluated.</span>
p <span class="token variable">$rbx</span>+<span class="token variable">$rcx</span>*4</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Show all registers.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">info registers
info r
registers <span class="token comment"># (GEF)</span>
reg       <span class="token comment"># (GEF)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="modify-registers" tabindex="-1"><a class="md-anchor" href="#modify-registers" aria-hidden="true"></a> Modify Registers</h3><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">set</span> <span class="token variable">$eax</span> <span class="token operator">=</span> 0xdeadbeef</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="watch-registers" tabindex="-1"><a class="md-anchor" href="#watch-registers" aria-hidden="true"></a> Watch Registers</h3><p>See <a href="#watchpoints">Watchpoints</a>.</p><h2 id="memory" tabindex="-1"><a class="md-anchor" href="#memory" aria-hidden="true"></a> Memory</h2><p>Memory is a core component of binaries. Many hidden secrets lurk inside the shadows of memory.</p><h3 id="view-memory" tabindex="-1"><a class="md-anchor" href="#view-memory" aria-hidden="true"></a> View Memory</h3><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">x/<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>sz<span class="token punctuation">]</span><span class="token punctuation">[</span>fmt<span class="token punctuation">]</span> <span class="token operator">&lt;</span>addr<span class="token operator">&gt;</span>

<span class="token comment"># n: Number of data to print.</span>
<span class="token comment"># sz: b(byte), h(halfword), w(word), g(giant, 8 bytes)</span>
<span class="token comment"># fmt: Format to print data.</span>
<span class="token comment"># - o(octal), x(hex), d(decimal), u(unsigned decimal),</span>
<span class="token comment"># - z(hex, zero padded on the left)</span>
<span class="token comment"># - t(binary), f(float), c(char), s(string)</span>
<span class="token comment"># - a(address), i(instruction),</span>

<span class="token comment"># 20 words.</span>
x/20wx 0x7fffffffd000

<span class="token comment"># 20 bytes.</span>
x/20bx 0x7fffffffd000

<span class="token comment"># View as string.</span>
x/s 0x7fffffffd000</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="modify-memory" tabindex="-1"><a class="md-anchor" href="#modify-memory" aria-hidden="true"></a> Modify Memory</h3><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">set</span> <span class="token punctuation">{</span>c-type<span class="token punctuation">}</span><span class="token operator">&lt;</span>address<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>

<span class="token comment"># For self-compiled sources.</span>
<span class="token builtin class-name">set</span> var i <span class="token operator">=</span> <span class="token number">10</span>
<span class="token builtin class-name">set</span> <span class="token punctuation">{</span>int<span class="token punctuation">}</span>0x83040 <span class="token operator">=</span> <span class="token number">4</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>You can also modify memory at a pointer location by casting to an appropriate type and dereferencing.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment">## C++</span>
<span class="token builtin class-name">set</span> *<span class="token punctuation">{</span>uint32_t*<span class="token punctuation">}</span>0x7fffffffd000 <span class="token operator">=</span> 0xdeadbeef
<span class="token comment">## Rust</span>
<span class="token builtin class-name">set</span> *<span class="token punctuation">(</span>0x7fffffffd000 as *const u32<span class="token punctuation">)</span> <span class="token operator">=</span> 0xdeadbeef</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="search-memory" tabindex="-1"><a class="md-anchor" href="#search-memory" aria-hidden="true"></a> Search Memory</h3><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token function">find</span> <span class="token operator">&lt;</span>start<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>end<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>data<span class="token punctuation">..</span>.<span class="token operator">&gt;</span>
<span class="token function">find</span> <span class="token operator">&lt;</span>start<span class="token operator">&gt;</span>, +<span class="token operator">&lt;</span>length<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>data<span class="token punctuation">..</span>.<span class="token operator">&gt;</span>

<span class="token comment"># Find string (including null byte).</span>
<span class="token function">find</span> 0x7fffffffd000, 0x7ffffffff000, <span class="token string">"Hello world!"</span>

<span class="token comment"># Find string (excluding null byte).</span>
<span class="token function">find</span> 0x7fffffffd000, 0x7ffffffff000, <span class="token string">'H'</span>,<span class="token string">'e'</span>,<span class="token string">'l'</span>,<span class="token string">'l'</span>,<span class="token string">'o'</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>More options.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token function">find</span> <span class="token punctuation">[</span>/sn<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token comment"># s: b(byte), h(halfword), w(word), g(giant, 8 bytes)</span>
<span class="token comment"># n: max number of finds</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Combine with <a href="#view-memory-segments">Memory Mapping</a> to determine available regions.</p><h3 id="watch-memory" tabindex="-1"><a class="md-anchor" href="#watch-memory" aria-hidden="true"></a> Watch Memory</h3><p>See <a href="#watchpoints">Watchpoints</a>.</p><h3 id="view-memory-segments" tabindex="-1"><a class="md-anchor" href="#view-memory-segments" aria-hidden="true"></a> View Memory Segments</h3><p>Useful to determine which areas are readable/writeable/executable.</p><p>Requires program to be running beforehand.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">info proc mappings
vmmap <span class="token comment"># (GEF)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h2 id="stack" tabindex="-1"><a class="md-anchor" href="#stack" aria-hidden="true"></a> Stack</h2><h3 id="view-stack" tabindex="-1"><a class="md-anchor" href="#view-stack" aria-hidden="true"></a> View Stack</h3><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># View 100 words (hex) at $rsp.</span>
x/100wx <span class="token variable">$rsp</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>See also: <a href="#view-memory">View Memory</a>.</p><p><strong>Stack Frame</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">info frame</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Stack Trace</strong><br>Show a trace of previous stack frames.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">backtrace
bt</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h2 id="heap" tabindex="-1"><a class="md-anchor" href="#heap" aria-hidden="true"></a> Heap</h2><p>GEF only.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">heap

<span class="token comment"># View all chunks.</span>
heap chunks

<span class="token comment"># View specific chunks.</span>
heap chunk <span class="token operator">&lt;</span>addr<span class="token operator">&gt;</span>

<span class="token comment"># View state of bins (freed chunks).</span>
heap bins</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h2 id="breakpoints" tabindex="-1"><a class="md-anchor" href="#breakpoints" aria-hidden="true"></a> Breakpoints</h2><p>Breaks when address reaches an instruction.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">break</span> *<span class="token operator">&lt;</span>address<span class="token operator">&gt;</span>
<span class="token builtin class-name">break</span> <span class="token operator">&lt;</span>line-number <span class="token operator">|</span> label<span class="token operator">&gt;</span> <span class="token comment"># For self-compiled programs.</span>
<span class="token builtin class-name">break</span> <span class="token operator">&lt;</span>stuff<span class="token punctuation">..</span>.<span class="token operator">&gt;</span> <span class="token keyword">if</span> <span class="token operator">&lt;</span>expression<span class="token operator">&gt;</span>

<span class="token comment"># Address.</span>
<span class="token builtin class-name">break</span> *0x401234
b *0x401234

<span class="token comment"># Offset from function.</span>
<span class="token builtin class-name">break</span> *main+200

<span class="token comment"># Line number and expression.</span>
<span class="token builtin class-name">break</span> main.c:6 <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">5</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Further Reading:</p><ul><li><a href="https://stackoverflow.com/q/14390256/10239789" rel="noreferrer" target="_blank">SO: GDB – Break if variable equal value</a></li></ul><h3 id="breakpoint-control" tabindex="-1"><a class="md-anchor" href="#breakpoint-control" aria-hidden="true"></a> Breakpoint Control</h3><p>Sometimes we only want to enable or disable certain breakpoints. These commands come handy then. They also apply to watchpoints.</p><p><strong>Get Breakpoint Info</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">info breakpoints
info b</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Control Breakpoints</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Enable/disable all breakpoints.</span>
<span class="token builtin class-name">enable</span>
disable

<span class="token comment"># Enable/disable specific breakpoints.</span>
<span class="token builtin class-name">enable</span> <span class="token operator">&lt;</span>breakpoint-id<span class="token operator">&gt;</span>
disable <span class="token operator">&lt;</span>breakpoint-id<span class="token operator">&gt;</span>

<span class="token comment"># Remove breakpoints.</span>
delete <span class="token operator">&lt;</span>breakpoint-id<span class="token operator">&gt;</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Skip <code>n</code> Breakpoints</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">continue</span> <span class="token operator">&lt;</span>ignore-count<span class="token operator">&gt;</span>

<span class="token comment"># Skip 32 breaks.</span>
<span class="token builtin class-name">continue</span> <span class="token number">32</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Hit Breakpoint Once</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Enable the breakpoint once.</span>
<span class="token comment"># The breakpoint will be disabled after first hit.</span>
<span class="token builtin class-name">enable</span> once <span class="token operator">&lt;</span>breakpoint-id<span class="token operator">&gt;</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="watchpoints" tabindex="-1"><a class="md-anchor" href="#watchpoints" aria-hidden="true"></a> Watchpoints</h3><p>Breaks when data changes. More specifically, whenever the <em>value of an expression</em> changes, a break occurs.</p><p>This includes:</p><ul><li>when an address is <strong>written</strong> to. (<code>watch</code>, <code>awatch</code>)</li><li>when an address is <strong>read</strong> from. (<code>rwatch</code>, <code>awatch</code>)</li><li>when an expression evaluates to a given value. (<code>watch</code>)</li></ul><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token function">watch</span> <span class="token operator">&lt;</span>expression<span class="token operator">&gt;</span>

<span class="token comment"># Break on write.</span>
<span class="token function">watch</span> *0x7fffffffd000

<span class="token comment"># Break on condition.</span>
<span class="token comment">## Register</span>
<span class="token function">watch</span> <span class="token variable">$rax</span> <span class="token operator">==</span> 0xdeadbeef
<span class="token comment">## Memory</span>
<span class="token comment">### C/C++</span>
<span class="token function">watch</span> *<span class="token punctuation">{</span>uint32_t*<span class="token punctuation">}</span>0x7fffffffd000 <span class="token operator">==</span> 0xdeadbeef
<span class="token comment">### Rust</span>
<span class="token function">watch</span> *<span class="token punctuation">(</span>0x7fffffffd000 as *const u32<span class="token punctuation">)</span> <span class="token operator">==</span> 0xdeadbeef</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Watchpoints can be enabled/disabled/deleted like breakpoints, but you can also list them separately.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Displays table of watchpoints.</span>
info watchpoint
info wat</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>If hardware watchpoints are supported, then you can also use read watchpoints and access watchpoints.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Check if hardware watchpoints are supported.</span>
show can-use-hw-watchpoints</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Read watchpoints: break on read.</span>
rwatch *0x7fffffffd000

<span class="token comment"># Access watchpoints: break on read or write.</span>
awatch *0x7fffffffd000</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Further Reading:</p><ul><li><a href="https://sourceware.org/gdb/current/onlinedocs/gdb.html/Set-Watchpoints.html" rel="noreferrer" target="_blank">GDB: Setting Watchpoints</a></li></ul><h3 id="gdb-script" tabindex="-1"><a class="md-anchor" href="#gdb-script" aria-hidden="true"></a> GDB Script</h3><p>GDB commands can be placed in files and run in the following ways:</p><ul><li><p><code>~/.gdbinit</code> and <code>./.gdbinit</code> are executed automatically on GDB startup.</p></li><li><p>On the command line, with <code>-x</code>/<code>--command</code>:</p><div class="code-toolbar"><pre class="language-sh" tabindex="0"><code class="language-sh">gdb <span class="token parameter variable">--batch</span> <span class="token parameter variable">--command</span><span class="token operator">=</span>test.gdb <span class="token parameter variable">--args</span> ./test.exe <span class="token number">5</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Shell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div></li><li><p>Using the <code>source</code> command in GDB:</p><div class="code-toolbar"><pre data-language="GDB" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">source</span> myscript.gdb</code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">GDB</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div></li></ul><p>Further Reading:</p><ul><li><a href="https://sourceware.org/gdb/current/onlinedocs/gdb.html/Command-Files.html" rel="noreferrer" target="_blank">GDB Reference - Command Files</a></li><li><a href="https://cgi.cse.unsw.edu.au/~learn/debugging/modules/gdb_init_file/" rel="noreferrer" target="_blank">GDB Scripting Commands and Examples</a></li><li><a href="https://stackoverflow.com/q/10748501/10239789" rel="noreferrer" target="_blank">SO: What are the best ways to automate a GDB debugging session?</a></li></ul><h2 id="miscellaneous" tabindex="-1"><a class="md-anchor" href="#miscellaneous" aria-hidden="true"></a> Miscellaneous</h2><h3 id="install-gef" tabindex="-1"><a class="md-anchor" href="#install-gef" aria-hidden="true"></a> Install GEF</h3><div class="code-toolbar"><pre class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># via the install script</span>
<span class="token comment">## using curl</span>
<span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://gef.blah.cat/sh<span class="token variable">)</span></span>"</span>

<span class="token comment">## using wget</span>
<span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">wget</span> https://gef.blah.cat/sh <span class="token parameter variable">-O</span> -<span class="token variable">)</span></span>"</span>

<span class="token comment"># or manually</span>
<span class="token function">wget</span> <span class="token parameter variable">-O</span> ~/.gdbinit-gef.py <span class="token parameter variable">-q</span> https://gef.blah.cat/py
<span class="token builtin class-name">echo</span> <span class="token builtin class-name">source</span> ~/.gdbinit-gef.py <span class="token operator">&gt;&gt;</span> ~/.gdbinit

<span class="token comment"># or alternatively from inside gdb directly</span>
gdb <span class="token parameter variable">-q</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> pi <span class="token function">import</span> urllib.request as u, tempfile as t<span class="token punctuation">;</span> <span class="token assign-left variable">g</span><span class="token operator">=</span>t.NamedTemporaryFile<span class="token punctuation">(</span>suffix<span class="token operator">=</span><span class="token string">'-gef.py'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> open<span class="token punctuation">(</span>g.name, <span class="token string">'wb+'</span><span class="token punctuation">)</span>.write<span class="token punctuation">(</span>u.urlopen<span class="token punctuation">(</span><span class="token string">'https://tinyurl.com/gef-main'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span> gdb.execute<span class="token punctuation">(</span><span class="token string">'source %s'</span> % g.name<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Shell</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Further Reading:</p><ul><li><a href="https://github.com/hugsy/gef" rel="noreferrer" target="_blank">GitHub: GEF</a></li></ul><h3 id="pwnlib-gdb-attach" tabindex="-1"><a class="md-anchor" href="#pwnlib-gdb-attach" aria-hidden="true"></a> <code>pwnlib.gdb.attach</code></h3><p>This allows you to programmatically interact with the binary with an initial GDB script or send I/O with Python. This uses the Python <code>pwn</code> module — a versatile exploit development package — which you can install with <code>pip install pwntools</code>.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

bash <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'bash'</span><span class="token punctuation">)</span>

<span class="token comment"># Attach the debugger and run GDB commands.</span>
gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>bash<span class="token punctuation">,</span> <span class="token triple-quoted-string string">'''
set follow-fork-mode child
break execve
continue
'''</span><span class="token punctuation">)</span>

<span class="token comment"># Interact with the process.</span>
bash<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"echo Hello World"</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Further Reading:</p><ul><li><a href="https://stackoverflow.com/a/62014210/10239789" rel="noreferrer" target="_blank">SO: <code>gdb.attach</code> Example</a></li><li><a href="https://docs.pwntools.com/en/stable/gdb.html#pwnlib.gdb.attach" rel="noreferrer" target="_blank"><code>gdb.attach</code> Documentation</a></li></ul><p>To unlock the full potential of the GDB API, check out:</p><ul><li><a href="https://docs.pwntools.com/en/stable/gdb.html" rel="noreferrer" target="_blank">pwntools - Working with GDB</a></li></ul><h3 id="input-non-printable-characters" tabindex="-1"><a class="md-anchor" href="#input-non-printable-characters" aria-hidden="true"></a> Input Non-Printable Characters</h3><p>Sometimes you may want to manually fuzz or construct complex attack payloads. There are multiple ways to do so.</p><div class="alert alert-danger d-flex align-items-start"><i class="fas fa-radiation ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>I don't recommend using Python 3 to generate strings on-the-fly, as its string/byte-string mechanics are unintuitive. Prefer <code>perl</code> or <code>echo</code> instead.</p><p>For example: <code>python -c 'print("\xc0")'</code> prints <code>\xc3\x80</code> (À) instead of <code>\xc0</code>. Why? Because the Python string <code>"\xc0"</code> is interpreted as U+00C0, which is <code>\xc3\x80</code> in UTF-8. In other words, characters are interpreted as Unicode codepoints instead of bytes.</p><div class="code-toolbar"><pre class="language-py" tabindex="0"><code class="language-py"><span class="token keyword">assert</span> <span class="token string">'\xc0'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">b'\xc3\x80'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Printing bytes in Python is <a href="https://stackoverflow.com/q/908331/10239789" rel="noreferrer" target="_blank">difficult to do concisely</a>.</p></div></div><p><strong>Directly from GDB: With <code>run</code></strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Runs with 'AAAA\x01\x02\x01\x02' as stdin.</span>
r <span class="token operator">&lt;&lt;&lt;</span><span class="token variable"><span class="token variable">$(</span>perl <span class="token parameter variable">-e</span> <span class="token string">'print "A"x4 . "\x01\x02"x2;'</span><span class="token variable">)</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>This uses a Bash <a href="https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Here-Strings" rel="noreferrer" target="_blank">here-string</a> to feed goodies into input. Not supported on all machines.</p><p><strong>Directly from GDB: With Temporary File</strong></p><p>Slightly more convoluted than the previous method, but is more portable.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token comment"># Prints 'AAAA\x01\x02\x01\x02' to a temporary file.</span>
shell perl <span class="token parameter variable">-e</span> <span class="token string">'print "A"x4 . "\x01\x02"x2;'</span> <span class="token operator">&gt;</span>/tmp/input

<span class="token comment"># Run the program, use the file as stdin.</span>
r <span class="token operator">&lt;</span>/tmp/input</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Reset GDB Arguments</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">set</span> args</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>This empties <code>args</code>. You can also use this command to set arbitrary arguments. The full command is:</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">set</span> args <span class="token punctuation">[</span>arguments<span class="token punctuation">..</span>.<span class="token punctuation">]</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>With <a href="#pwnlib-gdb-attach"><code>pwnlib.gdb.attach</code></a></strong></p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python">bash<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"echo '\x01\x02\x03\x04'"</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="enable-aslr" tabindex="-1"><a class="md-anchor" href="#enable-aslr" aria-hidden="true"></a> Enable ASLR</h3><p><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Address space layout randomisation">ASLR</abbr> is a common mechanism to randomise stack, heap, and library offsets.</p><p>ASLR is disabled by default in GDB. To re-enable:</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh"><span class="token builtin class-name">set</span> disable-randomization off</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Useful for pwn challenges.</p><h3 id="pie-breakpoints" tabindex="-1"><a class="md-anchor" href="#pie-breakpoints" aria-hidden="true"></a> PIE Breakpoints</h3><p>GEF only.</p><p><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Position-independent executable">PIE</abbr> are binaries where segments (.data, .text) are loaded at random offsets. In GDB, it seems to always be set to offset 0x555…554000.</p><p>Not all binaries have PIE enabled. Use <code>checksec</code> to verify.</p><p>Use the <code>pie</code> commands (<code>help pie</code>). Pie breakpoints are separate from regular breakpoints.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">pie b <span class="token operator">&lt;</span>addr<span class="token operator">&gt;</span>    <span class="token comment"># PIE breakpoint at offset &lt;addr&gt; in code.</span>
pie run         <span class="token comment"># Run with pie breakpoints enabled.</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="gef-context" tabindex="-1"><a class="md-anchor" href="#gef-context" aria-hidden="true"></a> GEF Context</h3><p>GEF only.</p><p>Summary of registers, stack, trace, code, all in one contained view.</p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">context
ctx</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Sometimes you want to step-debug without GEF's massive spew of text covering the screen.</p><p><strong>Disable Context</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">gef config context.enable <span class="token number">0</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><strong>Enable Context</strong></p><div class="code-toolbar"><pre data-lang-off="" class="language-sh" tabindex="0"><code class="language-sh">gef config context.enable <span class="token number">1</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="GDB/GEF Cheatsheet" data-url="/posts/gdb-cheatsheet/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="GDB/GEF Cheatsheet" data-url="/posts/gdb-cheatsheet/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="GDB/GEF Cheatsheet" data-url="/posts/gdb-cheatsheet/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="GDB/GEF Cheatsheet" data-url="/posts/gdb-cheatsheet/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="GDB/GEF Cheatsheet" data-url="/posts/gdb-cheatsheet/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="GDB/GEF Cheatsheet" data-url="/posts/gdb-cheatsheet/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/linux-cheatsheet/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/linux-cheatsheet/"><img class="post-img-blurred-bg" src="/img/posts/programming/cheatsheets/assets/penguin-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 281" alt="Thumbnail for Practical Linux Tricks for the Aspiring Hacker" srcset="/img/posts/programming/cheatsheets/assets/penguin-256w.webp 256w, /img/posts/programming/cheatsheets/assets/penguin-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/cheatsheets/assets/penguin-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 281" alt="Thumbnail for Practical Linux Tricks for the Aspiring Hacker" srcset="/img/posts/programming/cheatsheets/assets/penguin-256w.webp 256w, /img/posts/programming/cheatsheets/assets/penguin-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Practical Linux Tricks for the Aspiring Hacker</h2><div class="post-summary"><p>A curated list of fanciful Linux tricks I use to bolster my command-line prowess and activate Sage Mode.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/cheatsheet/" itemprop="keywords">cheatsheet</a> </span><span><a class="jtag" href="/tags/linux/" itemprop="keywords">linux</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading – Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/attack-of-the-zip/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/attack-of-the-zip/"><img class="post-img-blurred-bg" src="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 337" alt="Thumbnail for From Compression to Compromise: Unmasking Zip File Threats" srcset="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-256w.webp 256w, /img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 337" alt="Thumbnail for From Compression to Compromise: Unmasking Zip File Threats" srcset="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-256w.webp 256w, /img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">From Compression to Compromise: Unmasking Zip File Threats</h2><div class="post-summary"><p>Deep dive into zip file attacks and mitigations (with examples!).</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/hkcert-2023-decompetition-vitamin-cpp/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/hkcert-2023-decompetition-vitamin-cpp/"><img class="post-img-blurred-bg" src="/img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for HKCERT CTF 2023 – Decompetition: Vitamin&nbsp;C++" srcset="/img/posts/ctf/hkcert23/assets/vitamin-cpp-256w.webp 256w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp 512w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for HKCERT CTF 2023 – Decompetition: Vitamin&nbsp;C++" srcset="/img/posts/ctf/hkcert23/assets/vitamin-cpp-256w.webp 256w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp 512w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">HKCERT CTF 2023 – Decompetition: Vitamin&nbsp;C++</h2><div class="post-summary"><p>A beginner-friendly writeup to reverse-engineering C++ a lá decompetition. Years of complex shenanigans condensed!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to ctf, infosec, pwn, reverse">software.security</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/ctf/">ctf</a> <a class="jtag" href="/tags/infosec/">infosec</a> <a class="jtag" href="/tags/reverse/">reverse</a> <a class="jtag" href="/tags/pentesting/">pentesting</a> <a class="jtag" href="/tags/pwn/">pwn</a> <a class="jtag" href="/tags/cryptography/">cryptography</a> <a class="jtag" href="/tags/redteam/">redteam</a> <a class="jtag" href="/tags/stego/">stego</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to programming">software.general</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/programming/">programming</a> <a class="jtag" href="/tags/software-engineering/">software-engineering</a> <a class="jtag" href="/tags/web/">web</a> <a class="jtag" href="/tags/aoc/">aoc</a> <a class="jtag" href="/tags/apps/">apps</a> <a class="jtag" href="/tags/dsp/">dsp</a> <a class="jtag" href="/tags/programming-languages/">programming-languages</a> <a class="jtag" href="/tags/linux/">linux</a> <a class="jtag" href="/tags/performance/">performance</a> <a class="jtag" href="/tags/functional/">functional</a> <a class="jtag" href="/tags/types/">types</a> <a class="jtag" href="/tags/windows/">windows</a> <a class="jtag" href="/tags/ai/">ai</a> <a class="jtag" href="/tags/metaprogramming/">metaprogramming</a> <a class="jtag" href="/tags/oop/">oop</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to cheatsheet, learning, notes">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p><em>Comments are back! Privacy-focused, without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion — I'd love to hear your thoughts.</em></p><script defer src="https://trebledj.me/js/comentario.min.js"></script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://www.codingame.com/profile/8444100ecb9723c1ec542346b0630aaa2821532" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/codingame.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://musescore.com/user/20636901" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/musescore.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2025&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/MPnrKnjI5w.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>