<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>AOC 2021 Day&amp;nbsp;24 – No U - TrebledJ's Pages</title><meta name="description" content="Finally a reverse engineering challenge in Advent of Code."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,aoc 2021 day&amp;nbsp;24 – no u,finally a reverse engineering challenge in advent of code.,programming,aoc,python,reverse,writeup"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-5e8R4YC3Atf/5McNMkFk4TZYUtMEItdy9ikt1KUoPSc=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-kQnTuA4pPVYgo0bCEGXSCEkD+CzMbRrhb5Cn58IydSA=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="AOC 2021 Day&amp;nbsp;24 – No U - TrebledJ's Pages"><meta property="twitter:title" content="AOC 2021 Day&amp;nbsp;24 – No U - TrebledJ's Pages"><meta property="og:description" content="Finally a reverse engineering challenge in Advent of Code.

This post is a writeup on solving the Advent of Code 2021 Day 24 challenge: Arithmetic Logic Unit. The Problem At first glance, I thought it was something similar to..."><meta property="twitter:description" content="Finally a reverse engineering challenge in Advent of Code.

This post is a writeup on solving the Advent of Code 2021 Day 24 challenge: Arithmetic Logic Unit. The Problem At first glance, I thought it was something similar to..."><meta property="og:url" content="https://trebledj.me/posts/aoc-2021-day-24/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/programming/aoc-2021/assets/z3-500w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/programming/aoc-2021/assets/z3-500w.webp"><meta property="article:published_time" content="2022-08-25T00:00:00.000Z"><meta property="article:modified_time" content="2022-10-20T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="programming"><meta property="article:tag" content="programming"><meta property="article:tag" content="aoc"><meta property="article:tag" content="python"><meta property="article:tag" content="reverse"><meta property="article:tag" content="writeup"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-6e60ae6c5e022aba.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><style></style><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;var reloadDisqus=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");"dark"===e?(setMode("light"),reloadDisqus&&reloadDisqus()):"light"===e?(setMode("dark"),reloadDisqus&&reloadDisqus()):setMode(defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#the-problem">The Problem</a></li><li><a href="#solving">Solving</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-08-25T08:00:00.000+08:00">2022‑08‑25</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2022-10-20T08:00:00.000+08:00">2022‑10‑20</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">6 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#the-problem">The Problem</a></li><li><a href="#solving">Solving</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">AOC&nbsp;2021 Day&nbsp;24 – No U</h1><p class="post-desc" itemprop="alternativeHeadline">Finally a reverse engineering challenge in Advent of Code.</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-08-25T08:00:00.000+08:00">2022‑08‑25</span></span></div><div class="d-flex flex-row align-items-center"><span class="post-updated-date-icon"><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-updated-date">Updated on <span itemprop="dateModified" content="2022-10-20T08:00:00.000+08:00">2022‑10‑20</span></span></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">6 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/aoc/" itemprop="keywords">aoc</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><p>This post is a writeup on solving the <a href="/tags/aoc/">Advent of Code</a> <a href="https://adventofcode.com/2021/day/24" rel="noreferrer" target="_blank">2021 Day 24 challenge: Arithmetic Logic Unit</a>.</p><h3 id="the-problem" tabindex="-1"><a class="md-anchor" href="#the-problem" aria-hidden="true"></a> The Problem</h3><p>At first glance, I thought it was something similar to the <a href="https://adventofcode.com/2019/day/2" rel="noreferrer" target="_blank">intcode problems</a> from two years ago. After a more thorough read, it turns out this is a completely different problem. To my surprise, the day 24 challenge actually resembles the reverse engineering found in some <a href="/tags/ctf/">capture the flag competitions</a>!</p><p>To summarise the challenge, we're given a list of assembly-like instructions like so:</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">inp w
add z w
mod z 2
div w 2</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Our submarine's arithmetic logic unit (ALU) has four registers: <code>w</code>, <code>x</code>, <code>y</code>, and <code>z</code>.</p><p>There are six different types of instructions in total:</p><ul><li><code>inp a</code> reads the leftmost digit from input into register <code>a</code> (if the input is <code>123</code>, <code>inp w</code> will store <code>1</code> in <code>w</code>),</li><li><code>add a b</code> adds register <code>a</code> with register/value <code>b</code>,</li><li><code>mul a b</code> multiplies register <code>a</code> by register/value <code>b</code>,</li><li><code>div a b</code> divides register <code>a</code> by register/value <code>b</code> (integer division—i.e. divide + truncate—is performed, so <code>div 10 3</code> is <code>3</code> and <code>div -5 2</code> is <code>-2</code>),</li><li><code>mod a b</code> takes the remainder of dividing register <code>a</code> by register/value <code>b</code>, and</li><li><code>eql a b</code> evaluates to <code>1</code> if <code>a</code> equals <code>b</code>, and <code>0</code> otherwise.</li></ul><p>You may notice that there are no jump instructions, so the ALU program is quite literally straightforward. We just need to run each instruction once until we hit the end.</p><p>Given the ALU program, we need to find the maximum (part 1) and minimum (part 2) ALU input which will cause the program to terminate with a <code>0</code> in register <code>z</code>. The ALU input is constrained to <strong>14-digit</strong> integers, and <strong>all digits are non-zero</strong>.</p><h3 id="solving" tabindex="-1"><a class="md-anchor" href="#solving" aria-hidden="true"></a> Solving</h3><p>In the midst of reading the challenge, I had already decided on the tool to use. <a href="https://github.com/Z3Prover/z3" rel="noreferrer" target="_blank">Z3</a>!</p><p><a class="lightbox-single" title="Z3 is the new FlexTape?" href="/img/posts/programming/aoc-2021/assets/z3-500w.webp"><img class="mb-2 rw center jw-45" src="/img/posts/programming/aoc-2021/assets/z3-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 560" alt="Z3 is the new FlexTape?" title="Z3 is the new FlexTape?" srcset="/img/posts/programming/aoc-2021/assets/z3-256w.webp 256w, /img/posts/programming/aoc-2021/assets/z3-500w.webp 500w" sizes="(max-width: 256px) 256px, 500px"></a></p><p>Z3 is a logic programming engine (theorem prover, actually) developed by Microsoft Research. It's pretty useful for working with symbols and constraints and more importantly, deriving possible solutions for said symbols. For example, say we want to know what are the solutions of $x^2 = x$. Z3 can solve this for us:</p><div class="code-toolbar"><pre class="command-line language-python" data-prompt=">>>" data-output="4,6" tabindex="0"><code class="language-python"><span class="command-line-prompt"><span data-prompt=">>>"></span><span data-prompt=">>>"></span><span data-prompt=">>>"></span><span></span><span data-prompt=">>>"></span><span></span></span><span class="token command"><span class="token keyword">import</span> z3</span>
<span class="token command">x <span class="token operator">=</span> z3<span class="token punctuation">.</span>Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>             <span class="token comment"># Create a symbol.</span></span>
<span class="token command">z3<span class="token punctuation">.</span>solve<span class="token punctuation">(</span>x<span class="token operator">*</span>x <span class="token operator">==</span> x<span class="token punctuation">)</span>          <span class="token comment"># Tell Z3 to solve for x.</span></span>
<span class="token output">[x = 1]                     # Z3 found a solution!</span>
<span class="token command">z3<span class="token punctuation">.</span>solve<span class="token punctuation">(</span>x<span class="token operator">*</span>x <span class="token operator">==</span> x<span class="token punctuation">,</span> x <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Any other solutions?</span></span>
<span class="token output">[x = 0]                     # uwu</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Initially, since I wanted to stick to <a href="/posts/aoc-2021">my resolution of using Haskell or Rust</a>, I tried looking for Z3 bindings for either language. They do exist. But they seem annoying to wrestle with.</p><p>So I decided to make an exception... <em>just</em> for this day... I'll use Python.</p><p>(I might return to write a Haskell/Rust Z3 solution later.)</p><h4 id="sokath-his-eyes-uncovered" tabindex="-1"><a class="md-anchor" href="#sokath-his-eyes-uncovered" aria-hidden="true"></a> Sokath, his eyes uncovered!</h4><p>In my experience, whenever starting a reverse challenge and given some assembly, it's useful to start by analysing the control flow of the assembly and look for patterns. Well, the ALU program has <s>super simple</s> barely any control flow, every single instruction will run one after another.</p><p>Now if we were given actual binaries, we would be able to throw them into a decompiler and get a <a href="https://en.wikipedia.org/wiki/Control-flow_graph" rel="noreferrer" target="_blank">control flow graph</a>. But since the ALU instructions here are contrived, I decided not to bother and go with the fallback method of analysis:</p><p><strong>STARING AT THE ASSEMBLY.</strong></p><p>Here are the first 40 lines (out of 252) of the given ALU program. Now stare with me.</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">inp w
mul x 0
add x z
mod x 26
div z 1
add x 13
eql x w
eql x 0
mul y 0
add y 25
mul y x
add y 1
mul z y
mul y 0
add y w
add y 8
mul y x
add z y
inp w
mul x 0
add x z
mod x 26
div z 1
add x 12
eql x w
eql x 0
mul y 0
add y 25
mul y x
add y 1
mul z y
mul y 0
add y w
add y 16
mul y x
add z y
inp w
mul x 0
add x z
mod x 26
[...]</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><sup>(You can view the full ALU program I was given <a href="https://raw.githubusercontent.com/TrebledJ/aoc/master/2021/input/d24.txt" rel="noreferrer" target="_blank">here</a>.)</sup></p><p>Done staring? I find that it also helps to add annotations on the right of the assembly.</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">inp w           ; Read input.
mul x 0         ; x = 0
add x z         ; x = z
mod x 26        ; x = z % 26
div z 1         ; z = z???
add x 13        ; x += 13</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>After enough staring, your eyes will be uncovered. Or exhausted. Or perhaps both.</p><p>Here were my observations:</p><ul><li>There are 14 repeated <em>blocks</em>. One block handling each digit from input.</li><li>Blocks are demarcated with an opening <code>inp w</code>.</li><li>Each block contains 18 instructions.</li><li>There are only three differences across each block:<ul><li>Instruction 5: <code>div z D</code>, where <code>D</code> is either <code>1</code> or <code>26</code>.</li><li>Instruction 6: <code>add x A</code>, where <code>A</code> can be any integer (negatives also appear!).</li><li>Instruction 16: <code>add y B</code>, where <code>B</code> can be any integer (seems like only non-negatives here).</li></ul></li><li>The other 15 instructions are the same in each block.</li><li>Between each block, only the value of <code>z</code> is propagated. <code>w</code>, <code>x</code>, and <code>y</code> are all local within a block.</li><li>We can simplify each iteration to the following expression:<ul><li>For each input digit <code>I</code>,<ul><li><code>x = (I != (z % 26 + A))</code>.</li><li>If <code>x</code>, then<ul><li><code>z = (z / D) * 26 + I + B</code>.</li></ul></li><li>Else,<ul><li><code>z = z / D</code>.</li></ul></li></ul></li></ul></li></ul><p>Nifty!</p><p>This is really all the intelligence we need. The rest is just hacking together the solution with the Z3 API.</p><h4 id="snoring-with-zzz" tabindex="-1"><a class="md-anchor" href="#snoring-with-zzz" aria-hidden="true"></a> Snoring with ZZZ</h4><p>Firstly, we read our file and gather our intelligence like a shepherd gathering their flock or a mother hen gathering her chicks.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    instrs <span class="token operator">=</span> <span class="token punctuation">[</span>l<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> l <span class="token keyword">in</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

n <span class="token operator">=</span> <span class="token number">14</span>  <span class="token comment"># Number of digits.</span>
block <span class="token operator">=</span> <span class="token number">18</span>

<span class="token comment"># Gather the "magic numbers" from the ALU program.</span>
addx <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
addy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
divz <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    divz<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>instrs<span class="token punctuation">[</span>i<span class="token operator">*</span>block <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    addx<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>instrs<span class="token punctuation">[</span>i<span class="token operator">*</span>block <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    addy<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>instrs<span class="token punctuation">[</span>i<span class="token operator">*</span>block <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Since all the numbers are at the end of the line, it's sufficient to split each line by whitespace, index the last token, and convert it to an <code>int</code>.</p><p>Next, we'll start doing our Z3 things. We'll define one symbol for each digit, and constrain each symbol to non-zero digits.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Make input ints.</span>
inp <span class="token operator">=</span> <span class="token punctuation">[</span>z3<span class="token punctuation">.</span>Int<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'inp_</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># Create a Z3 solver.</span>
s <span class="token operator">=</span> z3<span class="token punctuation">.</span>Optimize<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Constrain input to non-zero digits.</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">&lt;=</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> inp<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">[</span>i <span class="token operator">&lt;=</span> <span class="token number">9</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> inp<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>We use a special Z3 <code>Optimize</code> solver. This provides <code>.maximize</code> and <code>.minimize</code> methods which will be useful for tackling parts 1 and 2 respectively.</p><p>We then implement the iteration logic and add constraints. To keep things clear (and since I'm not too sure how modifying Z3 symbols work), I used a separate <code>z</code> symbol (<code>zs[i]</code>) for each iteration.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Chain constraints. Each iteration will have a separate z variable.</span>
<span class="token comment"># The constraints added will connect z[i+1] to z[i].</span>
zs <span class="token operator">=</span> <span class="token punctuation">[</span>z3<span class="token punctuation">.</span>Int<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'z_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>zs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> inp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>zs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> addx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>zs<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> z3<span class="token punctuation">.</span>If<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">(</span>zs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> divz<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">26</span> <span class="token operator">+</span> inp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> addy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                              zs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> divz<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>zs<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># Victory constraint.</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Finally, we chain together the symbol we want to maximise/minimise (which is our ALU input), then we call the respective <code>.maximise</code>/<code>.minimise</code> functions.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Construct full input to optimise (with place value).</span>
full_inp <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> acc<span class="token punctuation">,</span> x<span class="token punctuation">:</span> acc<span class="token operator">*</span><span class="token number">10</span> <span class="token operator">+</span> x<span class="token punctuation">,</span> inp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_inp</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>model<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> inp<span class="token punctuation">)</span>

<span class="token comment"># Part 1.</span>
s<span class="token punctuation">.</span>push<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>maximize<span class="token punctuation">(</span>full_inp<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
part1 <span class="token operator">=</span> get_inp<span class="token punctuation">(</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'part1:'</span><span class="token punctuation">,</span> part1<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Part 2.</span>
s<span class="token punctuation">.</span>push<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>full_inp<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
part2 <span class="token operator">=</span> get_inp<span class="token punctuation">(</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'part2:'</span><span class="token punctuation">,</span> part2<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Here, I used <code>s.push()</code> and <code>s.pop()</code> to create a sort of "scope". Without the "scopes", <code>.maximise</code> and <code>.minimise</code> work a bit weirdly in that once I call the first, the second will still return the same <code>.maximise</code>d number.</p><p>And that's pretty much it. On my laptop, it spits out both solutions within half a minute. I would've hoped for better, but eh, at least it's much faster—both coding-wise and runtime-wise—than a brute force scan.</p><h4 id="full-script" tabindex="-1"><a class="md-anchor" href="#full-script" aria-hidden="true"></a> Full Script</h4><p>For completeness, here's the full d24.py script.</p><script src="https://gist.github.com/TrebledJ/95085c7b45517d0bd99e646d6cae6690.js"></script></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;24 – No U" data-url="/posts/aoc-2021-day-24/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;24 – No U" data-url="/posts/aoc-2021-day-24/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;24 – No U" data-url="/posts/aoc-2021-day-24/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;24 – No U" data-url="/posts/aoc-2021-day-24/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;24 – No U" data-url="/posts/aoc-2021-day-24/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="AOC&amp;nbsp;2021 Day&amp;nbsp;24 – No U" data-url="/posts/aoc-2021-day-24/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><img class="post-img-blurred-bg" src="/img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 398" alt="Thumbnail for Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 & CVE-2025-40757)" srcset="/img/posts/infosec/siemens-cves/assets/thumbnail-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/thumbnail-576w.webp 576w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 398" alt="Thumbnail for Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 & CVE-2025-40757)" srcset="/img/posts/infosec/siemens-cves/assets/thumbnail-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/thumbnail-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/thumbnail-576w.webp 576w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp; CVE-2025-40757)</h2><div class="post-summary"><p>When security by obscurity breaks...</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/research/" itemprop="keywords">research</a> </span><span><a class="jtag" href="/tags/embedded/" itemprop="keywords">embedded</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/output-invariant-prompt-injection/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/output-invariant-prompt-injection/"><img class="post-img-blurred-bg" src="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs" srcset="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-256w.webp 256w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp 512w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1024w.webp 1024w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs" srcset="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-256w.webp 256w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp 512w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1024w.webp 1024w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs</h2><div class="post-summary"><p>Abusing inherent context and sluggishness in LLMs for stealthy enumeration of prompt injection points.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/ai/" itemprop="keywords">ai</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"><img class="post-img-blurred-bg" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules</h2><div class="post-summary"><p>Breaking news, awesome stuff happened!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/satire/" itemprop="keywords">satire</a> </span><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/delay-and-interactive-pause-in-multithreaded-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/delay-and-interactive-pause-in-multithreaded-python/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Delay and Interactive Pause in Multi-Threaded Python</h2><div class="post-summary"><p>It's like musical chairs for threads (except no one gets left behind)!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/tutorial/" itemprop="keywords">tutorial</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/prism-plugins-in-node/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/prism-plugins-in-node/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for How to Use PrismJS Plugins with NodeJS and MarkdownIt" srcset="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for How to Use PrismJS Plugins with NodeJS and MarkdownIt" srcset="/img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/prism-plugins-in-node/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">How to Use PrismJS Plugins with NodeJS and MarkdownIt</h2><div class="post-summary"><p>Improve your storytelling with these dead simple hacks for rendering fancy Prism plugins in Node!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a> </span><span><a class="jtag" href="/tags/js/" itemprop="keywords">js</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading – Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to aoc, programming">software.general</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/programming/">programming</a> <a class="jtag" href="/tags/software-engineering/">software-engineering</a> <a class="jtag" href="/tags/web/">web</a> <a class="jtag" href="/tags/aoc/">aoc</a> <a class="jtag" href="/tags/apps/">apps</a> <a class="jtag" href="/tags/dsp/">dsp</a> <a class="jtag" href="/tags/programming-languages/">programming-languages</a> <a class="jtag" href="/tags/linux/">linux</a> <a class="jtag" href="/tags/performance/">performance</a> <a class="jtag" href="/tags/functional/">functional</a> <a class="jtag" href="/tags/types/">types</a> <a class="jtag" href="/tags/windows/">windows</a> <a class="jtag" href="/tags/ai/">ai</a> <a class="jtag" href="/tags/metaprogramming/">metaprogramming</a> <a class="jtag" href="/tags/oop/">oop</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to python">software.programming-language</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/cpp/">cpp</a> <a class="jtag" href="/tags/python/">python</a> <a class="jtag" href="/tags/c/">c</a> <a class="jtag" href="/tags/haskell/">haskell</a> <a class="jtag" href="/tags/js/">js</a> <a class="jtag" href="/tags/qt/">qt</a> <a class="jtag" href="/tags/rust/">rust</a> <a class="jtag" href="/tags/qml/">qml</a> <a class="jtag" href="/tags/sql/">sql</a> <a class="jtag" href="/tags/scala/">scala</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to reverse">software.security</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/ctf/">ctf</a> <a class="jtag" href="/tags/infosec/">infosec</a> <a class="jtag" href="/tags/reverse/">reverse</a> <a class="jtag" href="/tags/pentesting/">pentesting</a> <a class="jtag" href="/tags/pwn/">pwn</a> <a class="jtag" href="/tags/cryptography/">cryptography</a> <a class="jtag" href="/tags/redteam/">redteam</a> <a class="jtag" href="/tags/stego/">stego</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to writeup">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p><em>Comments are back! Privacy-focused, without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion — I'd love to hear your thoughts.</em></p><script defer src="https://trebledj.me/js/comentario.min.js"></script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://www.codingame.com/profile/8444100ecb9723c1ec542346b0630aaa2821532" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/codingame.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://musescore.com/user/20636901" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/musescore.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2025&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/MPnrKnjI5w.js"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" rel="stylesheet" media="print"><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!0})})</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>