<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>DownUnderCTF 2022 – ezpz-rev - TrebledJ's Pages</title><meta name="description" content="Grid puzzles aren't that easy."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,downunderctf 2022 – ezpz-rev,grid puzzles aren't that easy.,ctf,reverse,python,programming,writeup"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-puGfk8by7YflxyCkfgS+RgzE70yM3jYq5c5IrWTe0hM=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-fpqHX3vj/TpB8DyMxAUbt+Rpk0g/8oR6BkJd6JriNoo=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' 'unsafe-hashes' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="DownUnderCTF 2022 – ezpz-rev - TrebledJ's Pages"><meta property="twitter:title" content="DownUnderCTF 2022 – ezpz-rev - TrebledJ's Pages"><meta property="og:description" content="Grid puzzles aren't that easy.

This was a fun little break from all the school work piling up. School is tiring, just like something else... Challenge Description CTFing is tiring. Take a break with this..."><meta property="twitter:description" content="Grid puzzles aren't that easy.

This was a fun little break from all the school work piling up. School is tiring, just like something else... Challenge Description CTFing is tiring. Take a break with this..."><meta property="og:url" content="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/ctf/ductf22/assets/reverse-ultrascan-577w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/ctf/ductf22/assets/reverse-ultrascan-577w.webp"><meta property="article:published_time" content="2022-09-28T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="ctfs"><meta property="article:tag" content="ctf"><meta property="article:tag" content="reverse"><meta property="article:tag" content="python"><meta property="article:tag" content="programming"><meta property="article:tag" content="writeup"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-3b2a868570ec062c.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");setMode("dark"===e?"light":"light"===e?"dark":defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/vulnerability-research">CVEs</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li><li class="nav-item"><a class="nav-link" href="/webroll">Webroll</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#challenge-description">Challenge Description</a></li><li><a href="#writeup">Writeup</a><ol><li><a href="#initialisation">Initialisation</a></li><li><a href="#the-first-and-second-guards-move-along-now-nothing-to-see-here">The First and Second Guards: Move Along Now, Nothing to See Here</a></li><li><a href="#the-third-guard-please-wear-your-mask">The Third Guard: Please Wear Your Mask</a></li><li><a href="#the-fourth-guard-wonky-jumps-and-guesswork">The Fourth Guard: Wonky Jumps and Guesswork</a></li><li><a href="#the-final-touch">The Final Touch</a></li></ol></li><li><a href="#solve-script">Solve Script</a></li><li><a href="#flag">Flag</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-09-28T08:00:00.000+08:00">2022‑09‑28</span></span></div><div class="d-flex flex-row align-items-center"></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">6 minute read</span></div></div><div class="metadata-tag-container"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#challenge-description">Challenge Description</a></li><li><a href="#writeup">Writeup</a><ol><li><a href="#initialisation">Initialisation</a></li><li><a href="#the-first-and-second-guards-move-along-now-nothing-to-see-here">The First and Second Guards: Move Along Now, Nothing to See Here</a></li><li><a href="#the-third-guard-please-wear-your-mask">The Third Guard: Please Wear Your Mask</a></li><li><a href="#the-fourth-guard-wonky-jumps-and-guesswork">The Fourth Guard: Wonky Jumps and Guesswork</a></li><li><a href="#the-final-touch">The Final Touch</a></li></ol></li><li><a href="#solve-script">Solve Script</a></li><li><a href="#flag">Flag</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">DownUnderCTF 2022 – ezpz-rev</h1><p class="post-desc" itemprop="alternativeHeadline">Grid puzzles aren't that easy.</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2022-09-28T08:00:00.000+08:00">2022‑09‑28</span></span></div><div class="d-flex flex-row align-items-center"></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">6 minute read</span></div></div><div class="metadata-tag-container"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><p>This was a fun little break from all the school work piling up. School is tiring, just like something else...</p><h2 id="challenge-description" tabindex="-1"><a class="md-anchor" href="#challenge-description" aria-hidden="true"></a> Challenge Description</h2><blockquote><p>CTFing is tiring. Take a break with this easy puzzle!</p><p>Note: The binary and server in this challenge are the same as "ezpz-pwn".</p></blockquote><p>The description is rather terse. But it seems like the same binary is used for two challenges.</p><p>The binary is available on the <a href="https://github.com/DownUnderCTF/Challenges_2022_Public/tree/main/rev/ezpz-rev" rel="noreferrer" target="_blank">DownUnderCTF repository</a>. If you want to have a stab at the challenge, go for it!</p><h2 id="writeup" tabindex="-1"><a class="md-anchor" href="#writeup" aria-hidden="true"></a> Writeup</h2><p>As with all reverse challenges, let’s first throw the executable into a decompiler and see what crops up. I'll be using <a href="https://ghidra-sre.org/" rel="noreferrer" target="_blank">Ghidra</a>, a free open-source decompiler perfect for ezpz challenges.</p><p>Navigating to main, we see a function call, a gets (for reading user input), and a chain of four if-statements barring our way to some statements which print out the contents of <code>flag-rev.txt</code> (presumably the flag for this reverse challenge).</p><p><a class="lightbox-single" title="Decompiled output of the main function." href="/img/posts/ctf/ductf22/assets/ezpz-rev-main-1062w.webp"><img class="mb-2 rw center jw-55" src="/img/posts/ctf/ductf22/assets/ezpz-rev-main-1062w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1062 / 1308" alt="Decompiled output of the main function." title="Decompiled output of the main function." srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-main-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-main-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-main-1024w.webp 1024w, /img/posts/ctf/ductf22/assets/ezpz-rev-main-1062w.webp 1062w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1062px"></a></p><p>The most important functions to crack are the four guarding the file read. But we’ll take a look at the initialisation procedures first since they provide some helpful context towards understanding the program. Along the way, we’ll incrementally build a <a href="https://github.com/Z3Prover/z3" rel="noreferrer" target="_blank">z3 logic solver</a> to emulate/reverse each function.</p><h3 id="initialisation" tabindex="-1"><a class="md-anchor" href="#initialisation" aria-hidden="true"></a> Initialisation</h3><p>The first initialisation function modifies some options for the stdin/stdout buffers. Pretty standard C-style CTF stuff. The second initialisation function is much more interesting. Here’s a screenshot of the decompiled program:</p><p><a class="lightbox-single" title="Decompiled output of the initialisation function." href="/img/posts/ctf/ductf22/assets/ezpz-rev-init-1158w.webp"><img class="mb-2 rw center jw-75" src="/img/posts/ctf/ductf22/assets/ezpz-rev-init-1158w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1158 / 1126" alt="Decompiled output of the initialisation function." title="Decompiled output of the initialisation function." srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-init-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-init-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-init-1024w.webp 1024w, /img/posts/ctf/ductf22/assets/ezpz-rev-init-1158w.webp 1158w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1158px"></a></p><p>Decompilers are great and all, but the lack of useful variable names, comments, and readability can be a pain. Here’s a cleaned up version:</p><div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">init_run_length_encoded</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> initcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span><span class="token operator">*</span> data <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0xc4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ind <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// Index used to insert into data. Serves the dual purpose of tracking the size of the data.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> initcode<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> length <span class="token operator">=</span> initcode<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">;</span> <span class="token comment">// Convert digit (char) to int.</span>
        <span class="token keyword">char</span> c <span class="token operator">=</span> initcode<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Character to fill.</span>
        
        <span class="token comment">// Unpack run-length atom into `data`.</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">[</span>ind<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">C</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>In effect, the function initialises an array of chars by decoding a <a href="https://en.wikipedia.org/wiki/Run-length_encoding" rel="noreferrer" target="_blank">run-length encoded</a> string. For example, the string <code>5a4b3c2d</code> gets expanded to <code>aaaaabbbbcccdd</code>. Of course, the encoded string used is much longer, and it turns out that it fills all 196 (0xc4) chars allocated. There are a few more things I’d like to point out:</p><ul><li>196 (0xc4) is a number that pops up a lot in this binary.</li><li>Although typical run-length encoded strings may have more than 9 digits packed together (e.g. 12c13e42f), the implementation above assumes a run-length of at most 9 (i.e. one digit).</li><li>Interestingly, the characters encoded only range from <code>a</code> to <code>n</code>. We’ll see how these come into play later on.</li></ul><p>We can begin writing our solve script! Let’s perform this initialisation and decode the string into a <code>chars</code> variable.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python">encoded <span class="token operator">=</span> <span class="token string">'5a4b3c2d5a4b4c1d2a1e3a3b4c1d2a1e1f2a3b3c1g1d3e5f1b2c2g1d1f2e4f6g1d7f3h3g1d4f6h3g1d2f1i4j1h2k2l1m1d3i2j5k2l2m2i3j4k3l2m2i3j4k3l2m1i5j2k2n2l2m1i4j5n4l'</span>
chars <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    skip<span class="token punctuation">,</span> char <span class="token operator">=</span> encoded<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> encoded<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>   <span class="token comment"># Select pair of characters.</span>
    chars <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>skip<span class="token punctuation">)</span> <span class="token operator">*</span> char                   <span class="token comment"># Unpack run-length atom.</span>

<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xc4</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><h3 id="the-first-and-second-guards-move-along-now-nothing-to-see-here" tabindex="-1"><a class="md-anchor" href="#the-first-and-second-guards-move-along-now-nothing-to-see-here" aria-hidden="true"></a> The First and Second Guards: Move Along Now, Nothing to See Here</h3><p>If the initialisation procedures are the appetiser, then the four guards are the main course.</p><p><a class="lightbox-single" title="Ten-huttt!" href="/img/posts/ctf/ductf22/assets/ezpz-rev-guards-1000w.webp"><img class="mb-2 rw center jw-65" src="/img/posts/ctf/ductf22/assets/ezpz-rev-guards-1000w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1000 / 750" alt="Four King's Guards marching along." title="Ten-huttt!" srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-guards-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-guards-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-guards-1000w.webp 1000w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 1000px"></a></p><p>I’ll be using the term guards and tests interchangeably. <a href="https://en.m.wikipedia.org/wiki/Guard_(computer_science)" rel="noreferrer" target="_blank">Guards</a> are a term I’m borrowing from CS and functional programming. It’s basically an elevated if-statement.</p><p>Each guard checks if the input satisfies some condition. If the condition passes, the guard function returns 1, else 0. To get to the delicious dessert (the flag :P), we want all four functions to return 1.</p><p>Easier said than done. Let’s start with the first function and see what it decompiles into.</p><p><a class="lightbox-single" title="Decompiled output of the first guard." href="/img/posts/ctf/ductf22/assets/ezpz-rev-test1-938w.webp"><img class="mb-2 rw center jw-75" src="/img/posts/ctf/ductf22/assets/ezpz-rev-test1-938w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 938 / 888" alt="Decompiled output of the first guard." title="Decompiled output of the first guard." srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-test1-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-test1-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-test1-938w.webp 938w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 938px"></a></p><p>Here’s a more readable version:</p><div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">int</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> start <span class="token operator">&lt;</span> <span class="token number">196</span><span class="token punctuation">;</span> start <span class="token operator">+=</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">14</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>start <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'1'</span><span class="token punctuation">)</span>
                count<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">C</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Essentially, it groups input into blocks of 14 chars; then it checks if the number of <code>'1'</code>s in each block is exactly three. If any check is false, then the function returns 0, meaning we have failed miserably.</p><p>We can easily model this symbolically in z3. We’ll first create 196 symbols, each representing one character in input. Then, we'll create a z3 solver object: this is our interface to z3’s automagical solver. Through the solver, we can add constraints, remove constraints, generate concrete values, etc.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Create a bunch of symbols.</span>
inputs <span class="token operator">=</span> <span class="token punctuation">[</span>z3<span class="token punctuation">.</span>Int<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'g_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">196</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># Create a constraint solver object.</span>
s <span class="token operator">=</span> z3<span class="token punctuation">.</span>Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Constrain possible input. We just care about the 1s, really.</span>
<span class="token keyword">for</span> sym <span class="token keyword">in</span> inputs<span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>z3<span class="token punctuation">.</span>Or<span class="token punctuation">(</span>sym <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> sym <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

size <span class="token operator">=</span> <span class="token number">14</span>

<span class="token comment"># Constraint 1: row-wise constraint.</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>z3<span class="token punctuation">.</span>Sum<span class="token punctuation">(</span>inputs<span class="token punctuation">[</span>size<span class="token operator">*</span>i<span class="token punctuation">:</span>size<span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Our simplest constraint is our input constraint. For this program, we’ll limit our symbols to take on only 0s and 1s. Why? Because it is easy for z3 to sum integer symbols. This way, if we want to count the number of 1s in a list, we can just call <code>z3.Sum</code> on it.</p><p>We then add the constraints of the first guard by selecting groups of 14 elements using Python’s slice notation <code class="language-py">inputs<span class="token punctuation">[</span>size<span class="token operator">*</span>i<span class="token punctuation">:</span>size<span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code> and constrain it to 3.</p><p>Nifty! Let’s see what the second function looks like.</p><p><a class="lightbox-single" title="Decompiled output of the second guard." href="/img/posts/ctf/ductf22/assets/ezpz-rev-test2-958w.webp"><img class="mb-2 rw center jw-75" src="/img/posts/ctf/ductf22/assets/ezpz-rev-test2-958w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 958 / 944" alt="Decompiled output of the second guard." title="Decompiled output of the second guard." srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-test2-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-test2-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-test2-958w.webp 958w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 958px"></a></p><p>This looks surprisingly similar to the first test. In fact, the only thing that really changed is the <em>order</em> of the loops. Observe how the first function moves along the grid in a row-major fashion, whereas the second function moves in a column-major fashion.</p><div class="alert alert-info d-flex align-items-start"><i class="fas fa-circle-info ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>It may begin to dawn on you that the nested loops are hinting at a grid-like structure, a 14-by-14 2D array of characters. This realisation is pretty crucial, as it’ll help us reverse our last two functions much faster.</p></div></div><p>Let’s add these constraints to our solve script:</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Constraint 2: col-wise constraint.</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>z3<span class="token punctuation">.</span>Sum<span class="token punctuation">(</span>inputs<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">:</span>size<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p><code>inputs[i::size]</code> is Python slice notation to iterate beginning from <code>i</code> and picking every <code>size</code> elements, e.g. <code class="language-py"><span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span></code>.</p><p>Onto the next function!</p><h3 id="the-third-guard-please-wear-your-mask" tabindex="-1"><a class="md-anchor" href="#the-third-guard-please-wear-your-mask" aria-hidden="true"></a> The Third Guard: Please Wear Your Mask</h3><p><a class="lightbox-single" title="Decompiled output of the third guard." href="/img/posts/ctf/ductf22/assets/ezpz-rev-test3-1616w.webp"><img class="mb-2 rw center jw-95" src="/img/posts/ctf/ductf22/assets/ezpz-rev-test3-1616w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1616 / 1262" alt="Decompiled output of the third guard." title="Decompiled output of the third guard." srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-test3-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-test3-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-test3-1024w.webp 1024w, /img/posts/ctf/ductf22/assets/ezpz-rev-test3-1616w.webp 1616w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1616px"></a></p><p>Using our vectorised 1D representation, we can simplify the above to:</p><div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">int</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> chars<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> counter<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// Mask and count characters.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">196</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'1'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            counter<span class="token punctuation">[</span>chars<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">// Increment the count of `chars[i]`.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Bad bad if a letter doesn't appear exactly thrice.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">14</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>counter<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">C</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>This initialises an array of 14 integers that serve as counters. This is followed by two loops. In the first loop, we <strong>mask</strong> the input and initialised characters, then count the number occurrences of each character. In the second loop, we simply check that all counters equal 3, meaning each letter appears exactly three times in the masked string.</p><p>By “mask”, I mean something like <strong><a href="https://en.wikipedia.org/wiki/Bitwise_operation#AND" rel="noreferrer" target="_blank">bitwise-and</a></strong>, but for characters. For example, <code>abcdefg</code> masked with <code>1011001</code> would be <code>a cd g</code>, as only those four letters have <code>1</code> associated with them. Alternatively, you can think of the <code>0</code>s as masks hiding letters from sight, just like how face masks hide mouths.</p><p>This is the first of the four functions which actually <em>combines</em> both the user input and the character grid used in initialisation. The previous two functions performed checks only on the user input, but now we begin to see how the two relate.</p><p>Also recall that the letters initialised range from <code>a</code> to <code>n</code>, and in fact <code>n</code> is the 14th letter of the alphabet. <s>14 rows, 14 columns, 14 letters, checking if everything equals 3… seems a little sus. Maybe the challenge authors are hinting at the number 42, <a href="https://en.m.wikipedia.org/wiki/Phrases_from_The_Hitchhiker%27s_Guide_to_the_Galaxy#Answer_to_the_Ultimate_Question_of_Life,_the_Universe,_and_Everything_(42)" rel="noreferrer" target="_blank">the answer to life and everything in the universe</a>? Is this the true reverse behind this challenge?</s></p><p>Anyway, let’s try to add these constraints to z3. In proper reverse fashion, instead of first checking the user input like the original function, we’ll start with the letters. We’ll collect the indices containing a letter (say <code>'a'</code>), then collect all the input symbols associated with those indices, sum them, and constrain them to three.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Constraint 3: mask constraint.</span>
letters <span class="token operator">=</span> <span class="token string">'abcdefghijklmn'</span>
<span class="token keyword">for</span> l <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
    <span class="token comment"># Find all indices in chars which have letter `l`, then sum the corresponding Int symbols from `inputs`.</span>
    indices <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span> <span class="token keyword">if</span> c <span class="token operator">==</span> l<span class="token punctuation">]</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>z3<span class="token punctuation">.</span>Sum<span class="token punctuation">(</span><span class="token punctuation">[</span>inputs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Great! Three down, one to go.</p><h3 id="the-fourth-guard-wonky-jumps-and-guesswork" tabindex="-1"><a class="md-anchor" href="#the-fourth-guard-wonky-jumps-and-guesswork" aria-hidden="true"></a> The Fourth Guard: Wonky Jumps and Guesswork</h3><p>Here's a snippet of the fourth guard:</p><p><a class="lightbox-single" title="Decompiled output of the fourth guard." href="/img/posts/ctf/ductf22/assets/ezpz-rev-test4-1548w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/ctf/ductf22/assets/ezpz-rev-test4-1548w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1548 / 1300" alt="Decompiled output of the fourth guard." title="Decompiled output of the fourth guard." srcset="/img/posts/ctf/ductf22/assets/ezpz-rev-test4-256w.webp 256w, /img/posts/ctf/ductf22/assets/ezpz-rev-test4-512w.webp 512w, /img/posts/ctf/ductf22/assets/ezpz-rev-test4-1024w.webp 1024w, /img/posts/ctf/ductf22/assets/ezpz-rev-test4-1548w.webp 1548w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1548px"></a></p><p>The first half is understandable... But the rest... Hoh! What an eye sore! What’s the jump doin— I can’t even— ugnahfpwifhlqufjcjwalfhwowjrvkaufjwp.</p><p>As far as my monkey brain understands, the function iterates through every grid cell, and if it equals 1, performs some complicated check in an inner loop. At this point, I tried to understand what the inner loop was doing. Not much success. Looking at the decompiled output, keep in mind that <code>0xfffffff1</code> is only the <em>unsigned</em> interpretation. There is also the <em>signed</em> interpretation, which in this case is -15.</p><p>I then trained my eyes on the other "magic constants" in the inner loop and focused all my reverse powers by staring the numbers down. -1, -15, -14, -13, 1, 15, 14, 13. Hmm…</p><p><a class="lightbox-single" title="Charging... Focusing reverse energy... Ultrascan activated..." href="/img/posts/ctf/ductf22/assets/reverse-ultrascan-577w.webp"><img class="mb-2 rw center jw-50" src="/img/posts/ctf/ductf22/assets/reverse-ultrascan-577w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 577 / 433" alt="Squinting meme." title="Charging... Focusing reverse energy... Ultrascan activated..." srcset="/img/posts/ctf/ductf22/assets/reverse-ultrascan-256w.webp 256w, /img/posts/ctf/ductf22/assets/reverse-ultrascan-512w.webp 512w, /img/posts/ctf/ductf22/assets/reverse-ultrascan-577w.webp 577w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 577px"></a></p><p>Ooh! Perhaps it’s checking adjacent cells orthodiagonally (i.e. orthogonal + diagonal)? If you’ve implemented a Minesweeper game before, you’ll know where I’m going :P. Indexing <code>i - 14</code> would pick the cell above cell <code>i</code>, since each row is 14 cells wide. Similarly, <code>i + 14</code> would pick the cell below. <code>i + 15</code> would pick the bottom-right cell, and <code>i - 1</code> would pick the left cell. Interesting!</p><p>The other complicated checks, I presume, are out-of-bound checks. For example, if we’re at <code>i == 0</code> (the top-left corner), then the only adjacent cells are <code>i + 1</code>, <code>i + 14</code>, and <code>i + 15</code>. Anything else would go outside the array. After guessing this, I didn’t bother figuring out whether the decompiled loops actually follow this logic. <s>Terrible software engineering practice, but eh, we’re playing reverse, so might as well try it.</s></p><p>To the solver! For each symbol, we’ll add constraints saying, “If this cell is 1, its surrounding cells can’t be 1.” We’ll use <code>z3.Implies</code> to encode this logic. We only consider cells orthodiagonal to the current cell and within grid bounds.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Constraint 4: check orthodiagonal adjacents.</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> sym <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> index <span class="token operator">%</span> size
    y <span class="token operator">=</span> index <span class="token operator">//</span> size

    <span class="token comment"># Build list of adjacent indices. Bounds checking mania.</span>
    orthodiag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> x <span class="token operator">&lt;</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
            orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> y <span class="token operator">&lt;</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
        orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> x <span class="token operator">&lt;</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
            orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> x <span class="token operator">&lt;</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
        orthodiag <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    
    <span class="token comment"># If this cell is 1 --&gt; surrounding cells can't be one.</span>
    <span class="token keyword">for</span> od <span class="token keyword">in</span> orthodiag<span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>z3<span class="token punctuation">.</span>Implies<span class="token punctuation">(</span>sym <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> inputs<span class="token punctuation">[</span>index <span class="token operator">+</span> od<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>And with that, we’ve defeated the four guards! Huzzah!</p><h3 id="the-final-touch" tabindex="-1"><a class="md-anchor" href="#the-final-touch" aria-hidden="true"></a> The Final Touch</h3><p>All that’s left is to let z3 solve our constraints and generate concrete values for our symbols. We’ll push these concrete values into a <code>payload</code> variable and print it out.</p><div class="code-toolbar"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Construct payload.</span>
payload <span class="token operator">=</span> <span class="token string">''</span>
m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> sym <span class="token keyword">in</span> inputs<span class="token punctuation">:</span>
    payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
<span class="token comment"># 0101000000001000000101010000101000000001000000000101000110100000000100000010101000000100000000100100001010100000001000000010101000101000000000000000101010010101000000000000000001010100010101000000</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">Python</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>We obtained a z3 model from the solver by calling <code>s.model()</code> and evaluated our symbols to produce concrete integer 1s and 0s by calling <code>m.eval(sym).as_long()</code>.</p><p>After feeding this to the server, we obtain the flag. Yippee!</p><p>For an “easy” challenge, I definitely spent too much time on this. I wasted some time switching between a pure z3 logic solver and a full-blown angr solver, finding out angr was taking too long, and spamming Ctrl+Z. I could’ve spent this time sleeping instead. 😕</p><div class="alert alert-success d-flex align-items-start"><i class="fas fa-lightbulb ms-1 me-3 mt-1 fs-4" role="img"></i><div class="alert-content flex-fill mt-0"><p>One of the difficulties of reverse is trying to understand both the high-level aspects and low-level aspects. Sometimes skimming through the program structure helps. Other times, getting deep into the nitty-gritty aspects may help us recognise some familiar elements. This challenge was a fun little exercise to practice these two approaches.</p></div></div><h2 id="solve-script" tabindex="-1"><a class="md-anchor" href="#solve-script" aria-hidden="true"></a> Solve Script</h2><script src="https://gist.github.com/TrebledJ/81c30da2909c4a3767aa7ab52698fa8f.js"></script><h2 id="flag" tabindex="-1"><a class="md-anchor" href="#flag" aria-hidden="true"></a> Flag</h2><p>Payload</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">0101000000001000000101010000101000000001000000000101000110100000000100000010101000000100000000100100001010100000001000000010101000101000000000000000101010010101000000000000000001010100010101000000</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>Flag</p><div class="code-toolbar"><pre data-lang-off="" class="language-text" tabindex="0"><code class="language-text">DUCTF{gr1d_puzzl3s_ar3_t00_ez_r1ght?}</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="DownUnderCTF 2022 – ezpz-rev" data-url="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="DownUnderCTF 2022 – ezpz-rev" data-url="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="DownUnderCTF 2022 – ezpz-rev" data-url="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="DownUnderCTF 2022 – ezpz-rev" data-url="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="DownUnderCTF 2022 – ezpz-rev" data-url="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="DownUnderCTF 2022 – ezpz-rev" data-url="https://trebledj.me/posts/ductf-2022-ezpz-rev/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/arbitrary-code-execution-for-breakfast/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/arbitrary-code-execution-for-breakfast/"><img class="post-img-blurred-bg" src="/img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for Sharing is Caring: Arbitrary Code Execution for Breakfast" srcset="/img/posts/infosec/cpp-deserialization/assets/popashell-256w.webp 256w, /img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp 512w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for Sharing is Caring: Arbitrary Code Execution for Breakfast" srcset="/img/posts/infosec/cpp-deserialization/assets/popashell-256w.webp 256w, /img/posts/infosec/cpp-deserialization/assets/popashell-512w.webp 512w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Sharing is Caring: Arbitrary Code Execution for Breakfast</h2><div class="post-summary"><p>A CTF challenge exploring binary exploitation in C++, gadget mania, and a new form of deserialization attack.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/pwn/" itemprop="keywords">pwn</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading – Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/attack-of-the-zip/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/attack-of-the-zip/"><img class="post-img-blurred-bg" src="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 337" alt="Thumbnail for From Compression to Compromise: Unmasking Zip File Threats" srcset="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-256w.webp 256w, /img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 500 / 337" alt="Thumbnail for From Compression to Compromise: Unmasking Zip File Threats" srcset="/img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-256w.webp 256w, /img/posts/infosec/attack-of-the-zip/assets/attack-of-the-zip-thumbnail-500w.webp 500w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 500px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">From Compression to Compromise: Unmasking Zip File Threats</h2><div class="post-summary"><p>Deep dive into zip file attacks and mitigations (with examples!).</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/hkcert-2023-decompetition-vitamin-cpp/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/hkcert-2023-decompetition-vitamin-cpp/"><img class="post-img-blurred-bg" src="/img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for HKCERT CTF 2023 – Decompetition: Vitamin&nbsp;C++" srcset="/img/posts/ctf/hkcert23/assets/vitamin-cpp-256w.webp 256w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp 512w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for HKCERT CTF 2023 – Decompetition: Vitamin&nbsp;C++" srcset="/img/posts/ctf/hkcert23/assets/vitamin-cpp-256w.webp 256w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-512w.webp 512w, /img/posts/ctf/hkcert23/assets/vitamin-cpp-640w.webp 640w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">HKCERT CTF 2023 – Decompetition: Vitamin&nbsp;C++</h2><div class="post-summary"><p>A beginner-friendly writeup to reverse-engineering C++ a lá decompetition. Years of complex shenanigans condensed!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/subtype-metaprogramming-is-mostly-harmless/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/subtype-metaprogramming-is-mostly-harmless/"><img class="post-img-blurred-bg" src="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 249" alt="Thumbnail for N[Subtype Metaprogramming] is N[Mostly Harmless]" srcset="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp 512w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-804w.webp 804w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 249" alt="Thumbnail for N[Subtype Metaprogramming] is N[Mostly Harmless]" srcset="/img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-256w.webp 256w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-512w.webp 512w, /img/posts/programming/concepts/subtype-metaprogramming/assets/thumbnail-804w.webp 804w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title"><sub><sup>N[</sup></sub>Subtype Metaprogramming<sub><sup>]</sup></sub> is <sub><sup>N[</sup></sub>Mostly Harmless<sub><sup>]</sup></sub></h2><div class="post-summary"><p>Inheritance go brrrrrrrr... abusing turing-complete typesystems to write fun programs in Python.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/types/" itemprop="keywords">types</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/hitcon-2023-the-blade/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/hitcon-2023-the-blade/"><img class="post-img-blurred-bg" src="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 206" alt="Thumbnail for HITCON 2023 – The Blade" srcset="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-256w.webp 256w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp 512w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1024w.webp 1024w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1570w.webp 1570w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 206" alt="Thumbnail for HITCON 2023 – The Blade" srcset="/img/posts/ctf/hitcon23/assets/hitcon-thumbnail-256w.webp 256w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-512w.webp 512w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1024w.webp 1024w, /img/posts/ctf/hitcon23/assets/hitcon-thumbnail-1570w.webp 1570w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">HITCON 2023 – The Blade</h2><div class="post-summary"><p>Beginner-friendly writeup for a nifty Rust reversing challenge.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/rust/" itemprop="keywords">rust</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to ctf, reverse">software.security</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/ctf/">ctf</a> <a class="jtag" href="/tags/infosec/">infosec</a> <a class="jtag" href="/tags/reverse/">reverse</a> <a class="jtag" href="/tags/pentesting/">pentesting</a> <a class="jtag" href="/tags/pwn/">pwn</a> <a class="jtag" href="/tags/cryptography/">cryptography</a> <a class="jtag" href="/tags/cve/">cve</a> <a class="jtag" href="/tags/redteam/">redteam</a> <a class="jtag" href="/tags/stego/">stego</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to programming">software.general</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/programming/">programming</a> <a class="jtag" href="/tags/software-engineering/">software-engineering</a> <a class="jtag" href="/tags/web/">web</a> <a class="jtag" href="/tags/aoc/">aoc</a> <a class="jtag" href="/tags/apps/">apps</a> <a class="jtag" href="/tags/dsp/">dsp</a> <a class="jtag" href="/tags/programming-languages/">programming-languages</a> <a class="jtag" href="/tags/linux/">linux</a> <a class="jtag" href="/tags/performance/">performance</a> <a class="jtag" href="/tags/functional/">functional</a> <a class="jtag" href="/tags/types/">types</a> <a class="jtag" href="/tags/windows/">windows</a> <a class="jtag" href="/tags/ai/">ai</a> <a class="jtag" href="/tags/metaprogramming/">metaprogramming</a> <a class="jtag" href="/tags/oop/">oop</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to python">software.programming-language</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/cpp/">cpp</a> <a class="jtag" href="/tags/python/">python</a> <a class="jtag" href="/tags/c/">c</a> <a class="jtag" href="/tags/haskell/">haskell</a> <a class="jtag" href="/tags/js/">js</a> <a class="jtag" href="/tags/qt/">qt</a> <a class="jtag" href="/tags/rust/">rust</a> <a class="jtag" href="/tags/qml/">qml</a> <a class="jtag" href="/tags/sql/">sql</a> <a class="jtag" href="/tags/java/">java</a> <a class="jtag" href="/tags/scala/">scala</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to writeup">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p>Comments are back! Privacy-focused; without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion— before AI invades social media, world leaders declare war on guppies, and what little humanity left is lost to time.</p><script defer src="/js/comentario.min.js"></script><script>if(window.location.hash.startsWith("#comentario")){const a=document.getElementById("comments");a&&a.scrollIntoView({behavior:"smooth"})}</script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://infosec.exchange/@trebledj" target="_blank"><i class="social-icon fab fa-mastodon" style="color:rgb(99, 101, 255) !important;"></i> </a><a rel="me noreferrer" href="https://x.com/trebledjjj" target="_blank"><i class="social-icon fab fa-twitter" style="color:rgb(99, 101, 255) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2026&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/YmP0cUsv-I.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>