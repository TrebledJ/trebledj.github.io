<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757) - TrebledJ's Pages</title><meta name="description" content="When security by obscurity breaks..."><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="trebledj,reverse engineering a siemens programmable logic controller for funs and vulns (cve-2024-54089, cve-2024-54090 &amp;amp; cve-2025-40757),when security by obscurity breaks...,infosec,research,embedded,pentesting,reverse,c,cpp,writeup"><meta name="robots" content="index,follow"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-Wv9Tjjg7Y7X5sBbP5AXqAQJA6+eewSRUjoPhNczfpnM=' 'sha256-FBtdNYnNdsvTKcrNIznI+jwGwhW3pNA5x/yQUw8jOPA=' 'sha256-5e8R4YC3Atf/5McNMkFk4TZYUtMEItdy9ikt1KUoPSc=' 'sha256-qlkNkQyGC5u9Brt4wwVi0MsPO/hVdrz3rzXuWYIkAbM=' 'sha256-J+ryCgKrW+QOH4xdCyPd6R5W3u9wJkXayR7KvtlnCnQ=' 'sha256-Deekn20h+++EarpL0nFQLX7JSJv7s/2W9f988ZFAh14=' comments.trebledj.me code.jquery.com cdn.jsdelivr.net gist.github.com static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com github.githubassets.com; font-src 'self' data: comments.trebledj.me cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data: comments.trebledj.me; frame-src 'self' *.soundcloud.com; connect-src 'self' comments.trebledj.me wss://comments.trebledj.me cloudflareinsights.com formcarry.com;"><link href="/feeds/posts.xml" rel="alternate" title="RSS Feed for TrebledJ's Pages" type="application/rss+xml"><meta property="og:site_name" content="TrebledJ's Pages"><meta property="og:type" content="article"><meta property="og:title" content="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757) - TrebledJ's Pages"><meta property="twitter:title" content="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757) - TrebledJ's Pages"><meta property="og:description" content="When security by obscurity breaks...

Under the sweltering heat of the Hong Kong summer, we entered a looming building and kicked off what was supposed to be a simple penetration test. Little did we know..."><meta property="twitter:description" content="When security by obscurity breaks...

Under the sweltering heat of the Hong Kong summer, we entered a looming building and kicked off what was supposed to be a simple penetration test. Little did we know..."><meta property="og:url" content="https://trebledj.me/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://trebledj.me/img/posts/infosec/siemens-cves/assets/thumbnail-576w.webp"><meta property="twitter:image" content="https://trebledj.me/img/posts/infosec/siemens-cves/assets/thumbnail-576w.webp"><meta property="article:published_time" content="2025-09-12T00:00:00.000Z"><meta property="article:author" content="TrebledJ"><meta property="article:section" content="cybersecurity"><meta property="article:tag" content="infosec"><meta property="article:tag" content="research"><meta property="article:tag" content="embedded"><meta property="article:tag" content="pentesting"><meta property="article:tag" content="reverse"><meta property="article:tag" content="c"><meta property="article:tag" content="cpp"><meta property="article:tag" content="writeup"><script type="application/ld+json">{"@context": "https://schema.org","@type": "WebSite","name": "TrebledJ's Pages","url": "https://trebledj.me"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/cb/css/icons-6e60ae6c5e022aba.css"><link rel="stylesheet" href="/cb/x2ljFSZBUH.css" media="print"><style></style><script>document.querySelectorAll('link[media|="print"]').forEach(e=>{e.addEventListener("load",()=>e.media="all"),e.sheet&&(e.media="all")})</script><script>const defaultTheme="dark";let icon=void 0;var reloadDisqus=void 0;function modeInit(){var e=localStorage.getItem("theme");setMode("dark"===e?"dark":"light"===e?"light":defaultTheme)}function modeInitIcon(){icon=document.getElementById("mode-switch-icon"),isLightTheme()&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun"),icon.classList.add("mode-switch-transform"))}function isLightTheme(){return"light"===localStorage.getItem("theme")}function modeSwitcher(){var e=localStorage.getItem("theme");"dark"===e?(setMode("light"),reloadDisqus&&reloadDisqus()):"light"===e?(setMode("dark"),reloadDisqus&&reloadDisqus()):setMode(defaultTheme)}function setMode(e){"dark"===e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):"light"===e&&(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")),icon&&(icon.classList.toggle("fa-moon"),icon.classList.toggle("fa-sun"),icon.classList.toggle("mode-switch-transform"))}modeInit(),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mode-switch").addEventListener("click",()=>{modeSwitcher()})})</script><script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><link rel="stylesheet" href="/css/comments.css"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="canonical" href="https://blog.darklab.hk/2025/09/12/reverse-engineering-a-siemens-programmable-logic-controller-for-funs-and-vulns/"></head><body><header><nav class="navbar navbar-expand-md py-2"><div class="container-fluid justify-content-between align-items-center"><button aria-controls="navbar-container" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler shadow-none" data-bs-target="#navbar-container" data-bs-toggle="collapse" type="button"><span id="navbar-toggler-icon"><i class="fas fa-bars"></i></span></button> <a class="navbar-brand no-decoration" href="/">TrebledJ's Pages</a><div class="navbar-collapse collapse" id="navbar-container"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li><li class="nav-item"><a class="nav-link" href="/music">Music</a></li></ul><ul class="navbar-nav"><li><a class="nav-link me-2" data-bs-toggle="modal" data-bs-target="#search-modal" aria-label="Search..." role="button"><i class="fas fa-search nav-icon"></i></a></li><li><a class="nav-link" id="mode-switch" aria-label="Theme Switch" role="button"><i id="mode-switch-icon" class="fas fa-moon nav-icon"></i></a><script>modeInitIcon()</script></li></ul></div></div></nav><div id="scroll-progress-bar"></div></header><div id="top-of-the-morning-to-you"></div><div id="search-modal" class="modal fade wide-modal" aria-hidden="true" aria-label="Search" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header pb-2 d-flex flex-row justify-content-between"><div class="container-fluid ps-0" id="search-box-container"><input type="text" autofocus class="container-fluid" id="search-box" placeholder="Search"> <i class="fas fa-search"></i></div><button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button></div><div class="modal-body" id="search-results-list"></div></div></div></div><button id="btn-back-to-top" class="btn btn-lg" type="button" aria-label="Back to Top"><i class="fas fa-arrow-up"></i></button><div id="btn-mobile-toc" class="dropup"><button type="button" class="btn btn-lg" data-bs-toggle="dropdown" aria-label="Content"><i class="fas fa-list-ul"></i></button><ul class="dropdown-menu toc-container"><li><nav class="toc"><ol><li><a href="#background">Background</a></li><li><a href="#hidden-in-http">Hidden in HTTP</a></li><li><a href="#toying-with-telnet">Toying with Telnet</a></li><li><a href="#a-peek-at-memory-and-some-deja-vu">A Peek at Memory and Some Deja Vu</a></li><li><a href="#taking-a-trip-down-memory-lane">Taking a Trip Down Memory Lane</a><ol><li><a href="#loading-memory">Loading Memory</a></li><li><a href="#libc-an-exercise-in-reverse-engineering">libc: An Exercise in Reverse Engineering</a></li><li><a href="#a-note-on-rtos">A Note on RTOS</a></li><li><a href="#uncovering-the-encryption">Uncovering the Encryption</a></li></ol></li><li><a href="#bac-net-to-the-future">BAC(net) to the Future</a></li><li><a href="#let-s-recap">Let’s Recap</a></li><li><a href="#mitigations">Mitigations</a></li><li><a href="#acknowledgements">Acknowledgements</a></li></ol></nav></li></ul></div><div class="main-container"><div class="page-container col-lg-12"><div class="container-lg px-0"><article class="jw-100 post-article" itemscope itemtype="http://schema.org/BlogPosting"><div class="row flex-row-reverse gx-lg-5"><div class="col-lg-4 d-none d-lg-block"><div class="dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2025-09-12T08:00:00.000+08:00">2025‑09‑12</span></span></div><div class="d-flex flex-row align-items-center"></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">10 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/research/" itemprop="keywords">research</a> </span><span><a class="jtag" href="/tags/embedded/" itemprop="keywords">embedded</a> </span><span><a class="jtag" href="/tags/pentesting/" itemprop="keywords">pentesting</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/c/" itemprop="keywords">c</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div><br><div id="toc-sidebar" class="sticky-right dim-deep dim-if-dark"><div class="toc-container"><span><a id="toc-content" href="javascript:void(0);">Content</a></span><nav class="toc"><ol><li><a href="#background">Background</a></li><li><a href="#hidden-in-http">Hidden in HTTP</a></li><li><a href="#toying-with-telnet">Toying with Telnet</a></li><li><a href="#a-peek-at-memory-and-some-deja-vu">A Peek at Memory and Some Deja Vu</a></li><li><a href="#taking-a-trip-down-memory-lane">Taking a Trip Down Memory Lane</a><ol><li><a href="#loading-memory">Loading Memory</a></li><li><a href="#libc-an-exercise-in-reverse-engineering">libc: An Exercise in Reverse Engineering</a></li><li><a href="#a-note-on-rtos">A Note on RTOS</a></li><li><a href="#uncovering-the-encryption">Uncovering the Encryption</a></li></ol></li><li><a href="#bac-net-to-the-future">BAC(net) to the Future</a></li><li><a href="#let-s-recap">Let’s Recap</a></li><li><a href="#mitigations">Mitigations</a></li><li><a href="#acknowledgements">Acknowledgements</a></li></ol></nav><hr></div><div class="toc-link-container"><span><a href="#related">Related Posts</a></span></div><div class="toc-link-container"><span><a href="#comments">Comments</a></span></div></div></div><div class="col-lg-8 post-body-container"><div class="article-header"><h1 class="post-title" itemprop="name headline">Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp; CVE-2025-40757)</h1><p class="post-desc" itemprop="alternativeHeadline">When security by obscurity breaks...</p><div class="d-lg-none dim-deep"><div class="metadata-container d-flex"><div class="d-flex flex-row align-items-center"><span><i class="fas fa-calendar post-meta-icon me-1"></i> </span><span class="fs-7 post-posted-date">Posted on <span itemprop="datePublished" content="2025-09-12T08:00:00.000+08:00">2025‑09‑12</span></span></div><div class="d-flex flex-row align-items-center"></div><div class="d-flex flex-row align-items-center"><span><i class="far fa-clock post-meta-icon me-1"></i> </span><span class="fs-7">10 minute read</span></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><span><i class="fas fa-tag post-meta-icon me-1 mt-2"></i></span><div class="tag-list d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/research/" itemprop="keywords">research</a> </span><span><a class="jtag" href="/tags/embedded/" itemprop="keywords">embedded</a> </span><span><a class="jtag" href="/tags/pentesting/" itemprop="keywords">pentesting</a> </span><span><a class="jtag" href="/tags/reverse/" itemprop="keywords">reverse</a> </span><span><a class="jtag" href="/tags/c/" itemprop="keywords">c</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/writeup/" itemprop="keywords">writeup</a></span></div></div></div></div><hr><div class="post-body text-content" itemprop="articleBody text"><div class="post-preamble"><p><em>This post is a personal mirror. The canonical post can be found on the DarkLab blog: <a href="https://blog.darklab.hk/2025/09/12/reverse-engineering-a-siemens-programmable-logic-controller-for-funs-and-vulns/" rel="noreferrer" target="_blank">https://blog.darklab.hk/2025/09/12/reverse-engineering-a-siemens-programmable-logic-controller-for-funs-and-vulns/</a></em></p><hr></div><p>Under the sweltering heat of the Hong Kong summer, we entered a looming building and kicked off what was supposed to be a simple penetration test. Little did we know, this ordeal would lead to panic-stricken emails, extra reports, and a few new CVEs.</p><p>This is a tale of the unexpected discovery of three CVEs in a Siemens logic controller, reverse engineering a bespoke architecture, and an authentication bypass obscured by proprietary file formats.</p><ul><li><strong><code>CVE-2024-54089</code></strong> – Weak Encryption Mechanism Vulnerability in Siemens Apogee PXC and Talon TC Devices</li><li><strong><code>CVE-2024-54090</code></strong> – Out-of-Bounds Read Vulnerability in Siemens Apogee PXC and Talon TC Devices</li><li><strong><code>CVE-2025-40757</code></strong> – Information Disclosure Vulnerability in Siemens Apogee PXC and Talon TC Devices</li></ul><h2 id="background" tabindex="-1"><a class="md-anchor" href="#background" aria-hidden="true"></a> Background</h2><p>Our story begins with a simple network penetration test. The objective was to test our client’s internal network for potential vulnerabilities which could allow an attacker to take over systems from the perimeter, affect internal systems, and/or pivot to other networks. After a bit of mundane scanning and spreadsheet wrestling, we came across a few devices marked as <em>Operational Technology</em> (OT).</p><p><a class="lightbox-single" title="Nessus detected BACnet devices on the network." href="/img/posts/infosec/siemens-cves/assets/001-nessus-1183w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/001-nessus-1183w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1183 / 244" alt="Nessus detected BACnet devices on the network." title="Nessus detected BACnet devices on the network." srcset="/img/posts/infosec/siemens-cves/assets/001-nessus-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/001-nessus-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/001-nessus-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/001-nessus-1183w.webp 1183w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1183px"></a></p><p><a class="lightbox-single" title="Nessus detected BACnet devices on the network." href="/img/posts/infosec/siemens-cves/assets/002-nessus-1169w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/002-nessus-1169w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1169 / 221" alt="Nessus detected BACnet devices on the network." title="Nessus detected BACnet devices on the network." srcset="/img/posts/infosec/siemens-cves/assets/002-nessus-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/002-nessus-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/002-nessus-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/002-nessus-1169w.webp 1169w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1169px"></a></p><p class="caption"><sup>Nessus detected BACnet devices on the network.</sup></p><p><a class="lightbox-single" title="An example of a PLC." href="/img/posts/infosec/siemens-cves/assets/003-plc-600w.webp"><img class="rw float-right m-1 jw-50 p-2" src="/img/posts/infosec/siemens-cves/assets/003-plc-600w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 600 / 600" alt="An example of a PLC." title="An example of a PLC." srcset="/img/posts/infosec/siemens-cves/assets/003-plc-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/003-plc-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/003-plc-600w.webp 600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 600px"></a></p><p>Meet the Siemens Apogee/Talon PXC Modular: a programmable logic controller (PLC) designed to automate building controls, monitoring, and energy management. These devices are primarily used in heating, ventilation, air conditioning (HVAC) systems which may have complex requirements depending on the weather, season, and time of day.</p><p>PLCs are like the managers of a building automation system. Just as managers oversee teams, allocate resources, and report to higher ups, PLCs monitor sensor inputs, execute logic, and send alerts and telemetry back to a central system or workstation.</p><p>Corporate analogies aside, quick scans of the device revealed interesting ports: telnet, HTTP, and BACnet (UDP/47808).</p><h2 id="hidden-in-http" tabindex="-1"><a class="md-anchor" href="#hidden-in-http" aria-hidden="true"></a> Hidden in HTTP</h2><p>Analysis of the HTTP server quickly revealed the presence of a path traversal bug in the HTTP server, which we later validated to be <code>CVE-2017-9947</code>. This 7-year-old vulnerability enables remote attackers with network access to the integrated HTTP server to obtain information stored on the FAT file system.</p><p>Exploitation of <code>CVE-2017-9947</code> led to enumeration of the following files stored within the directory:</p><p><a class="lightbox-single" title="Directory listing from path traversal." href="/img/posts/infosec/siemens-cves/assets/004-path-traversal-1214w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/004-path-traversal-1214w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1214 / 495" alt="Directory listing from path traversal." title="Directory listing from path traversal." srcset="/img/posts/infosec/siemens-cves/assets/004-path-traversal-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/004-path-traversal-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/004-path-traversal-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/004-path-traversal-1214w.webp 1214w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1214px"></a></p><p>A few files piqued our interest, and we downloaded these with a special parameter. Upon opening 7002[.]db, we uncovered what appeared to be a proprietary hex format. Initially, we paid no heed to this mishmash of bytes; but later on we will discover how this information could be abused. As pentesters, time is of the essence, so we'll make a mental note and move on for now.</p><p><a class="lightbox-single" title="Proprietary hex." href="/img/posts/infosec/siemens-cves/assets/005-dbfile-561w.webp"><img class="mb-2 rw center jw-90" src="/img/posts/infosec/siemens-cves/assets/005-dbfile-561w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 561 / 478" alt="Proprietary hex." title="Proprietary hex." srcset="/img/posts/infosec/siemens-cves/assets/005-dbfile-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/005-dbfile-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/005-dbfile-561w.webp 561w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 561px"></a></p><p class="caption"><sup><code>python custom_decode_script.py 7002.db | xxd</code>.</sup></p><h2 id="toying-with-telnet" tabindex="-1"><a class="md-anchor" href="#toying-with-telnet" aria-hidden="true"></a> Toying with Telnet</h2><p>The telnet service was password-protected, but with a bit of enumeration, we identified a <a href="https://manualzz.com/doc/23480006/talon-firmware-user-s-manual?p=96" rel="noreferrer" target="_blank">user manual</a> specifying three (3) default credentials: <em>HIGH:HIGH</em>, <em>MED:MED</em>, and <em>LOW:LOW</em>. (In hindsight: duh, facepalm.) The first set of default credentials (<em>HIGH:HIGH</em>) rendered itself useless (for now), though the subsequent two sets enabled successful login to the telnet service.</p><p><a class="lightbox-single" title="We're in!" href="/img/posts/infosec/siemens-cves/assets/006-login-med-741w.webp"><img class="mb-2 rw center jw-75" src="/img/posts/infosec/siemens-cves/assets/006-login-med-741w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 741 / 279" alt="We're in!" title="We're in!" srcset="/img/posts/infosec/siemens-cves/assets/006-login-med-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/006-login-med-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/006-login-med-741w.webp 741w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 741px"></a></p><p class="caption"><sup>We're in!</sup></p><p>After a bit of exploration, we found we had permission to dump memory as <em>MED</em>!</p><p><a class="lightbox-single" title="Dump memory from range 0 to 0x100." href="/img/posts/infosec/siemens-cves/assets/007-dump-mem-1106w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/007-dump-mem-1106w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1106 / 624" alt="Dump memory from range 0 to 0x100." title="Dump memory from range 0 to 0x100." srcset="/img/posts/infosec/siemens-cves/assets/007-dump-mem-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/007-dump-mem-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/007-dump-mem-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/007-dump-mem-1106w.webp 1106w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1106px"></a></p><p>And here comes our first finding: what happens if we dump memory at a higher address?</p><p><a class="lightbox-single" title="Dump memory from range 0xdeadbeef to 0xdeadbef0." href="/img/posts/infosec/siemens-cves/assets/008-dump-deadbeef-644w.webp"><img class="mb-2 rw center jw-60" src="/img/posts/infosec/siemens-cves/assets/008-dump-deadbeef-644w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 644 / 145" alt="Dump memory from range 0xdeadbeef to 0xdeadbef0." title="Dump memory from range 0xdeadbeef to 0xdeadbef0." srcset="/img/posts/infosec/siemens-cves/assets/008-dump-deadbeef-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/008-dump-deadbeef-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/008-dump-deadbeef-644w.webp 644w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 644px"></a></p><p>Oh no.</p><p>Immediately, we double checked BACnet objects. Originally, over 900 objects were observed— now, only 17 remain. Needless to say, availability has gone out the window.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/009-readobjects-909w.webp"><img class="mb-2 rw center jw-90" src="/img/posts/infosec/siemens-cves/assets/009-readobjects-909w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 909 / 351" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/009-readobjects-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/009-readobjects-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/009-readobjects-909w.webp 909w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 909px"></a></p><p class="caption"><sup>Current state of BACnet objects; only hardware debug information remains.</sup></p><p>Out of curiosity, we also tried logging into telnet as <em>HIGH</em> with the default password. This time, it worked!</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/010-login-as-high-763w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/010-login-as-high-763w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 763 / 176" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/010-login-as-high-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/010-login-as-high-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/010-login-as-high-763w.webp 763w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 763px"></a></p><p class="caption"><sup>We are <em>HIGH</em>!</sup></p><p>Oh no.</p><p>Let’s recap. We were initially unable to login as <em>HIGH</em>, but could login as <em>MED</em>. When we inputted a large address into the Dump Memory function, we lost the telnet connection. Further enumeration showed 99% of BACnet objects were missing, and the password for <em>HIGH</em> was reset.</p><p>Fast forward several months, and our discovery was formally recognized as CVE-2024-54090:</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/011-cve-oob-991w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/011-cve-oob-991w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 991 / 321" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/011-cve-oob-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/011-cve-oob-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/011-cve-oob-991w.webp 991w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 991px"></a></p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/012-who-would-win-800w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/012-who-would-win-800w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 800 / 319" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/012-who-would-win-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/012-who-would-win-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/012-who-would-win-800w.webp 800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 800px"></a></p><h2 id="a-peek-at-memory-and-some-deja-vu" tabindex="-1"><a class="md-anchor" href="#a-peek-at-memory-and-some-deja-vu" aria-hidden="true"></a> A Peek at Memory and Some Deja Vu</h2><p>After taking all the necessary screenshots for the first finding, we proceeded to double down on the Dump Memory function. What else could we uncover?<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup></p><p>We determined the memory range to be <code>0</code> to <code>0x03FF'FFFF</code>, which precisely correlates with the 64MB SDRAM listed in the <a href="https://bacnetinternational.net/catalog/manu/siemens/149487_PXCModular.pdf" rel="noreferrer" target="_blank">Technical Spec</a>. After obtaining the full dump, it’s time to see what’s inside! A simple <code>strings</code> (or <code>od</code>) operation revealed some familiar faces…</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/013-memdump-strings-highlighted-408w.webp"><img class="mb-2 rw center jw-50" src="/img/posts/infosec/siemens-cves/assets/013-memdump-strings-highlighted-408w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 408 / 412" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/013-memdump-strings-highlighted-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/013-memdump-strings-highlighted-408w.webp 408w" sizes="(max-width: 256px) 256px, 408px"></a></p><p class="caption"><sup><code>od -A x -S 4 dump.bin | less</code>. The <code>od</code> command will attach the memory location too; quite useful when reversing alongside another tool.</sup></p><p>Huh, curious! These are similar to the strings we previously saw in the .db file. On a whim, we tried changing our <em>MED</em> password and dumping the <code>0xc10f99</code> region. And sure enough, instead of <code>#kjD.</code>, new values appeared. Not only that, but other values around the region <em>remain unchanged</em>, which suggests this particular memory location is tied to the password we just changed.</p><p>At this point, we hypothesised these values to be encrypted passwords. If <code>kjD.</code> is our password for <em>MED</em>, then perhaps <code>1237</code> and <code>f}W</code> are the passwords for <em>HIGH</em> and <em>LOW</em> respectively? After a quick test, we confirmed <code>f}W</code> is likely the encrypted password for <em>LOW</em>. So where does that leave us with <code>1237</code>?</p><p>On another whim, we tried logging in as <em>HIGH</em> with the password <code>1234</code>, and… we’re in?! (again)</p><p>WHAT?!</p><p>In utter disbelief, we toyed around with other passwords, and well— you can see the results for yourself.</p><div class="table-container"><table><thead><tr><th>Plaintext</th><th>Ciphertext</th></tr></thead><tbody><tr><td>1234</td><td>1237</td></tr><tr><td>123456</td><td>123453</td></tr><tr><td>000000</td><td>000005</td></tr><tr><td>111</td><td>113</td></tr><tr><td>111111</td><td>111114</td></tr><tr><td>aaaaaa</td><td>-FjiF-</td></tr><tr><td>bbbbbb</td><td>-EijE-</td></tr></tbody></table></div><p class="caption"><sup>Sample plaintext/ciphertext pairs. Notice how passwords comprised solely of digits are easily guessable.</sup></p><p>This leads us to our second finding, CVE-2024-54089; a weak password encryption mechanism. At this point, it was confirmed an attacker could guess certain passwords.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/014-cve-weak-enc-968w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/014-cve-weak-enc-968w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 968 / 304" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/014-cve-weak-enc-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/014-cve-weak-enc-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/014-cve-weak-enc-968w.webp 968w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 968px"></a></p><p>In the next few sections, we will show how we discovered how to <strong>decrypt</strong> <em>any</em> password. We initially attempted to reverse the encryption with a black-box approach and tried our hands at differential cryptanalysis. After much deliberation and regret at not having played more cryptography-style CTF challenges, we decided it was time for a different approach.</p><h2 id="taking-a-trip-down-memory-lane" tabindex="-1"><a class="md-anchor" href="#taking-a-trip-down-memory-lane" aria-hidden="true"></a> Taking a Trip Down Memory Lane</h2><p>To solidify the impact of our finding (and to properly crack the xor-based slop), we proceeded to reverse-engineer the memory dump.</p><h3 id="loading-memory" tabindex="-1"><a class="md-anchor" href="#loading-memory" aria-hidden="true"></a> Loading Memory</h3><p>While <code>strings</code> and <code>od</code> can provide clues, they do so without much context. We loaded the entire 64MB memory dump into Ghidra and were greeted with this marvellous junk:</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/015-load-first-1275w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/015-load-first-1275w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1275 / 282" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/015-load-first-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/015-load-first-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/015-load-first-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/015-load-first-1275w.webp 1275w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1275px"></a></p><p>Oops, wrong endian. Let’s try loading the same file with big endian instead.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/016-load-bigendian-751w.webp"><img class="mb-2 rw center jw-70" src="/img/posts/infosec/siemens-cves/assets/016-load-bigendian-751w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 751 / 297" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/016-load-bigendian-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/016-load-bigendian-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/016-load-bigendian-751w.webp 751w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 751px"></a></p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/017-load-bigendian-1506w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/017-load-bigendian-1506w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1506 / 530" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/017-load-bigendian-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/017-load-bigendian-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/017-load-bigendian-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/017-load-bigendian-1506w.webp 1506w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1506px"></a></p><p>That’s more like it!</p><p>PowerPC supports both big and little endian, which determine the order of bytes being interpreted. If we specify the wrong endian, the disassembler cannot correctly parse instructions. Apparently, this particular PLC uses big endian.</p><p>From here, we can hunt for more vulnerabilities or dig deeper into our previous findings. For now, we’ll stick to reverse engineering the encryption algorithm. But where do we start?</p><h3 id="libc-an-exercise-in-reverse-engineering" tabindex="-1"><a class="md-anchor" href="#libc-an-exercise-in-reverse-engineering" aria-hidden="true"></a> libc: An Exercise in Reverse Engineering</h3><p>Without symbols, standard C functions are expressed as mumbo jumbo. While these are tedious to reverse, it does help stretch our reversing brains a bit. For instance, the following function has over 600 cross-references (XREFs). If we can identify this function, we’ll have an easier time reversing other parts of code. What do you think this function is?</p><div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">void</span> <span class="token function">FUN_008ba294</span><span class="token punctuation">(</span>undefined <span class="token operator">*</span>param_1<span class="token punctuation">,</span> undefined <span class="token operator">*</span>param_2<span class="token punctuation">,</span> uint param_3<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
  param_1 <span class="token operator">=</span> param_1 <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
  param_2 <span class="token operator">=</span> param_2 <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> param_3 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span> param_3 <span class="token operator">=</span> param_3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    param_2 <span class="token operator">=</span> param_2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> 
    param_1 <span class="token operator">=</span> param_1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> 
    <span class="token operator">*</span>param_1 <span class="token operator">=</span> <span class="token operator">*</span>param_2<span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
  <span class="token keyword">return</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> </code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">C</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>This is indeed <code>memcpy</code>. This copies <code>param3</code>-bytes from the memory at <code>param2</code> to the memory at <code>param1</code>. The actual decompiled function is slightly more complicated with optimisations for copying the buffer by words (4 bytes) instead of byte-by-byte. To make our lives easier, we’ll edit the function signature with the appropriate names and types.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/018-memcpy-1745w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/018-memcpy-1745w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1745 / 808" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/018-memcpy-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/018-memcpy-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/018-memcpy-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/018-memcpy-1745w.webp 1745w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1745px"></a></p><p>Here’s another function (over 1200 XREFs). What could this be?</p><div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">FUN_008ba680</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>param_1<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
  <span class="token keyword">char</span> cVar1<span class="token punctuation">;</span> 
  uint <span class="token operator">*</span>puVar2<span class="token punctuation">;</span> 
  <span class="token keyword">char</span> <span class="token operator">*</span>pcVar3<span class="token punctuation">;</span> 
  uint <span class="token operator">*</span>puVar4<span class="token punctuation">;</span> 
  uint uVar5<span class="token punctuation">;</span> 
   
  uVar5 <span class="token operator">=</span> <span class="token number">4U</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>param_1 <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span> 
  pcVar3 <span class="token operator">=</span> param_1<span class="token punctuation">;</span> 
  <span class="token keyword">while</span><span class="token punctuation">(</span> true <span class="token punctuation">)</span> <span class="token punctuation">{</span> 
     <span class="token keyword">if</span> <span class="token punctuation">(</span>uVar5 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
       puVar2 <span class="token operator">=</span> <span class="token punctuation">(</span>uint <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pcVar3 <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token keyword">do</span> <span class="token punctuation">{</span> 
          puVar4 <span class="token operator">=</span> puVar2<span class="token punctuation">;</span> 
          puVar2 <span class="token operator">=</span> puVar4 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> 
          uVar5 <span class="token operator">=</span> <span class="token operator">*</span>puVar2<span class="token punctuation">;</span> 
       <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>uVar5 <span class="token operator">+</span> <span class="token number">0xfefefeff</span> <span class="token operator">&amp;</span> <span class="token operator">~</span>uVar5 <span class="token operator">&amp;</span> <span class="token number">0x80808080</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       pcVar3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>puVar4 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token keyword">do</span> <span class="token punctuation">{</span> 
          pcVar3 <span class="token operator">=</span> pcVar3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> 
       <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>pcVar3 <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token keyword">return</span> pcVar3 <span class="token operator">+</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>param_1<span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
     cVar1 <span class="token operator">=</span> <span class="token operator">*</span>pcVar3<span class="token punctuation">;</span> 
     pcVar3 <span class="token operator">=</span> pcVar3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> 
     <span class="token keyword">if</span> <span class="token punctuation">(</span>cVar1 <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> 
     uVar5 <span class="token operator">=</span> uVar5 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
  <span class="token keyword">return</span> pcVar3 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>param_1<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span class="lang">C</span></div><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" title="Copy Code"></button></div></div></div><p>*Hint: What is being returned and how is it computed? *</p><p>Some lines might seem scary, but let’s work with what we observe and know:</p><ul><li><code>param_1</code> operates on a <code>char*</code> and the null byte <code>\0</code> is checked, so this is likely a string operation.</li><li>The return statement <code>pcVar3 - 1 - param_1</code> is a good clue that the function is doing some index-of or counting operation since <code>param_1</code> is the start of the string. Analysing the code, no other special operation is performed aside from incrementing <code>pcVar3</code> and <code>pcVar4</code>.</li><li>Hence, ignoring the weird constants in the nested while-loop, we can conclude with relative certainty that this is our good friend <strong><code>strlen</code></strong>.</li><li>For the curious, the <code>uVar5 + 0xfefefeff &amp; ~uVar5 &amp; 0x80808080</code> magic is some bitwise trickery to <a href="https://graphics.stanford.edu/~seander/bithacks.html#HasLessInWord" rel="noreferrer" target="_blank">check for null bytes in a word</a>.</li></ul><p>We continued hacking away at familiar functions before slowly moving on to complex higher level functions.</p><h3 id="a-note-on-rtos" tabindex="-1"><a class="md-anchor" href="#a-note-on-rtos" aria-hidden="true"></a> A Note on RTOS</h3><p>We tried finding the encryption function through different approaches. While noodling around, we came across the thread function running the telnet server (think: the main function / entrypoint of the thread). We were unable to proceed in drilling down to our target (<em>shakes fist</em>— curse you indirection!), but this still posed a good opportunity to observe how the PLC works at the embedded level, and to revisit concepts of embedded software.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/019-telnet-rx-thread-812w.webp"><img class="mb-2 rw center jw-90" src="/img/posts/infosec/siemens-cves/assets/019-telnet-rx-thread-812w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 812 / 765" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/019-telnet-rx-thread-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/019-telnet-rx-thread-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/019-telnet-rx-thread-812w.webp 812w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 812px"></a></p><p class="caption"><sup>By correlating strings and the number 23 (the default telnet port), we determined functions relevant to socket programming.</sup></p><p>For a bare metal system to handle multithreading, a common approach is to use an RTOS (Real-Time Operating System). The RTOS is often provided as a library/API containing threading and synchronisation primitives. It is also common to allocate space for a stack then call some <code>create_task</code> function with a function pointer to the entrypoint of the thread.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/020-setup-tasks-1111w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/020-setup-tasks-1111w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1111 / 499" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/020-setup-tasks-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/020-setup-tasks-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/020-setup-tasks-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/020-setup-tasks-1111w.webp 1111w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1111px"></a></p><p>Once in a while, we come across interesting bits and pieces. As a side quest, we took a peek at the other thread functions, and uncovered the code for a debug server with a peculiar choice of port…</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/021-dbg-srv-648w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/021-dbg-srv-648w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 648 / 810" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/021-dbg-srv-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/021-dbg-srv-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/021-dbg-srv-648w.webp 648w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 648px"></a></p><p>Our nmap scans did not reveal this port, so it is likely an artefact from internal testing. Still an interesting find though!</p><h3 id="uncovering-the-encryption" tabindex="-1"><a class="md-anchor" href="#uncovering-the-encryption" aria-hidden="true"></a> Uncovering the Encryption</h3><p>After much trial and error, we were able to find the encryption function.</p><p>We started by again, searching for common phrases associated with login. This time we tried searching for one of the default users: <em>HIGH</em>. In one instance, the string was embedded among other strings such as <code>"newPassword"</code>, <code>"oldPassword"</code>, and <code>"UserAccountPasswordReset"</code> which suggests some kind of password-related activity.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/022-pswdreset-1751w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/022-pswdreset-1751w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1751 / 849" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/022-pswdreset-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/022-pswdreset-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/022-pswdreset-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/022-pswdreset-1751w.webp 1751w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1751px"></a></p><p>We followed XREFs to a relevant function and got our hands dirty.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/023-reset-password-1274w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/023-reset-password-1274w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1274 / 310" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/023-reset-password-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/023-reset-password-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/023-reset-password-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/023-reset-password-1274w.webp 1274w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1274px"></a></p><p>Inside the <code>reset_password</code> function, we identified two similar code flows which operate on the old password and new password. In the screenshot below, the old password is converted to bytes and validated before being copied into the buffer at <code>param_1 + 0x291</code>. Later on, the same process is applied to the new password which is copied to <code>param_1 + 0x17a</code>.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/024-reset-password-906w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/024-reset-password-906w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 906 / 569" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/024-reset-password-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/024-reset-password-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/024-reset-password-906w.webp 906w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 906px"></a></p><p>As suspected, the code eventually calls a function on each buffer, which we confirmed performs in-place encryption— the very thing we were looking for!</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/025-reset-password-862w.webp"><img class="mb-2 rw center jw-100" src="/img/posts/infosec/siemens-cves/assets/025-reset-password-862w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 862 / 837" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/025-reset-password-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/025-reset-password-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/025-reset-password-862w.webp 862w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 862px"></a></p><p>The actual encryption process is rather straightforward to reverse. First, the password is converted to UPPERCASE.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/026-reset-password-727w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/026-reset-password-727w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 727 / 911" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/026-reset-password-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/026-reset-password-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/026-reset-password-727w.webp 727w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 727px"></a></p><p>It then performs multiple xor operations on the string, looping through each character. Each byte is xored with a variety of numbers. And interestingly, byte <code>0x2a</code> (<a href="https://simple.wikipedia.org/wiki/42_(answer)" rel="noreferrer" target="_blank">42</a>) shows up multiple times. Coincidence?</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/027-xor-42-561w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/027-xor-42-561w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 561 / 76" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/027-xor-42-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/027-xor-42-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/027-xor-42-561w.webp 561w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 561px"></a></p><p>Once we know the encryption process, it was trivial to reverse the decryption due to the use of xor.</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/028-looks-inside-501w.webp"><img class="mb-2 rw center jw-60" src="/img/posts/infosec/siemens-cves/assets/028-looks-inside-501w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 501 / 499" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/028-looks-inside-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/028-looks-inside-501w.webp 501w" sizes="(max-width: 256px) 256px, 501px"></a></p><p>For security reasons, we will not disclose the full algorithm here, but the gist is that we confirmed the algorithm is xor-based with a hard-coded key. An attacker with knowledge of the algorithm can <strong>decrypt <em>any encrypted password on any affected device</em></strong>.</p><h2 id="bac-net-to-the-future" tabindex="-1"><a class="md-anchor" href="#bac-net-to-the-future" aria-hidden="true"></a> BAC(net) to the Future</h2><p>This writeup would not be complete without a juicy OT attack. After reporting the first two vulnerabilities, we realised there was an obscure information leak hiding in plain sight…</p><p>BACnet is a building automation protocol which exposes an API to read/modify settings of a device. It typically runs on UDP/47808 (<code>0xBAC0</code>) and is designed for lightweight and flexible communication between building controllers. We used <a href="https://github.com/JoelBender/bacpypes/tree/master" rel="noreferrer" target="_blank">JoelBender’s <code>bacpypes</code></a> Python library to interface with BACnet. (Check out <a href="https://bacnet.org/wp-content/uploads/sites/4/2022/06/The-Language-of-BACnet-1.pdf" rel="noreferrer" target="_blank">The Language of BACnet</a> to learn more about BACnet basics.)</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/029-bacpypes-objects-903w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/029-bacpypes-objects-903w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 903 / 803" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/029-bacpypes-objects-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/029-bacpypes-objects-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/029-bacpypes-objects-903w.webp 903w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 903px"></a></p><p class="caption"><sup>BACnet objects found by querying with bacpypes.</sup></p><p>We followed this process when enumerating BACnet:</p><ol><li>Gather the Device ID. (nmap, Nessus, port scan)</li><li>List objects on the device: <a href="https://github.com/JoelBender/bacpypes/blob/a7f2f41068aa06278602d3bf0cb9a3e16eeaf857/samples/ReadObjectList.py" rel="noreferrer" target="_blank">./samples/ReadObjectList.py</a></li><li>Select objects and list properties: <a href="https://github.com/JoelBender/bacpypes/blob/a7f2f41068aa06278602d3bf0cb9a3e16eeaf857/samples/ReadAllProperties.py" rel="noreferrer" target="_blank">./samples/ReadAllProperties.py</a></li></ol><p>From here, we tested individual properties for read/write capability. Suffice to say, BACnet network security hardly meets modern standards, but that is not our focus for this post.</p><p>Instead, we turn our attention to a few interesting BACnet objects specific to our targets:</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/030-bacnet-file-811w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/030-bacnet-file-811w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 811 / 404" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/030-bacnet-file-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/030-bacnet-file-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/030-bacnet-file-811w.webp 811w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 811px"></a></p><p>Look familiar? Using a modified version of <a href="https://github.com/JoelBender/bacpypes/blob/a7f2f41068aa06278602d3bf0cb9a3e16eeaf857/samples/ReadWriteFile.py" rel="noreferrer" target="_blank">bacpypes’ ReadWriteFile.py</a>, we downloaded the files over BACnet. And surprise surprise— it holds the same contents as the .db found earlier in the HTTP server. But as we realised before, these files actually contain encrypted passwords; and since BACnet by nature does not have authentication, this means devices are susceptible to <strong>unauthenticated information disclosure</strong>. <em>Anybody</em> on the network can slurp out encrypted passwords. Alas, meet <code>CVE-2025-40757</code>:</p><p><a class="lightbox-single" title="" href="/img/posts/infosec/siemens-cves/assets/031-cve-3-1312w.webp"><img class="mb-2 rw center jw-80" src="/img/posts/infosec/siemens-cves/assets/031-cve-3-1312w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 1312 / 366" alt="" title="" srcset="/img/posts/infosec/siemens-cves/assets/031-cve-3-256w.webp 256w, /img/posts/infosec/siemens-cves/assets/031-cve-3-512w.webp 512w, /img/posts/infosec/siemens-cves/assets/031-cve-3-1024w.webp 1024w, /img/posts/infosec/siemens-cves/assets/031-cve-3-1312w.webp 1312w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, (max-width: 1024px) 1024px, 1312px"></a></p><p>The implications are huge! An attacker on the network could perform an <strong>authentication bypass</strong> by chaining the above issues: read the encrypted password from BACnet, decrypt/guess the plaintext, and login to telnet as a <em>HIGH</em> (admin) user. Even if telnet were disabled, the passwords could be used for spraying across other systems.</p><p>Once an attacker can login as <em>HIGH</em>, they could (conceptually) execute arbitrary assembly instructions with the built-in Write Memory feature or modify the embedded HTML to include an XSS snippet! More concerningly, they could compromise availability by tampering with device settings.</p><p>If anything, this goes to show how security by obscurity is insufficient.</p><h2 id="let-s-recap" tabindex="-1"><a class="md-anchor" href="#let-s-recap" aria-hidden="true"></a> Let’s Recap</h2><p>TLDR:</p><ul><li>We discovered <em>MED</em>/<em>HIGH</em> users can cause the affected device to enter a cold-start state, severely impacting availability. (<code>CVE-2024-54090</code>)</li><li>We reverse-engineered the encryption mechanism for telnet passwords and confirmed it was xor-based. No encrypted passwords are safe. Moreover, if a password contains only digits, it is easily guessable in its encrypted form. Decryption works across affected devices due to a hard-coded key. (<code>CVE-2024-54089</code>)</li><li>We discovered an Information Disclosure vulnerability where encrypted passwords are disclosed over a BACnet file object. (<code>CVE-2025-40757</code>)</li><li>By chaining <code>CVE-2025-40757</code> and <code>CVE-2024-54089</code>, we can perform an authentication bypass, allowing one to login as any user and tamper with the device.</li></ul><h2 id="mitigations" tabindex="-1"><a class="md-anchor" href="#mitigations" aria-hidden="true"></a> Mitigations</h2><p>Affected Devices:</p><ul><li>Siemens APOGEE PXC Series (all versions)</li><li>Siemens TALON TC Series (all versions)</li></ul><p>As of writing, no fix is planned by Siemens. The following mitigations and temporary workarounds can be applied instead:</p><ol><li>Disable telnet. According to Siemens, telnet should be disabled by default, but in our experience, it is not uncommon for site administrators to enable it for convenience. We recommend disabling telnet to mitigate these vulnerabilities.</li><li>Change the default password for all accounts (<em>HIGH</em>, <em>MED</em>, <em>LOW</em>) even if unused. Choose strong passwords containing a mix of letters and digits.</li></ol><ul><li>Do <strong>not</strong> choose passwords comprised solely of digits.</li><li>Note that this does not prevent attackers with knowledge of the encryption algorithm from decrypting the passwords.</li><li>Avoid password reuse. Do not use the same passwords as your workstations and other models.</li></ul><ol start="3"><li>Apply detective controls such as network monitoring to identify suspicious traffic.</li></ol><h2 id="acknowledgements" tabindex="-1"><a class="md-anchor" href="#acknowledgements" aria-hidden="true"></a> Acknowledgements</h2><p>Special thanks to Siemens ProductCERT team for coordinated disclosure. For more information on these vulnerabilities, please read the advisories published by Siemens.</p><ul><li><a href="https://cert-portal.siemens.com/productcert/html/ssa-615116.html" rel="noreferrer" target="_blank"><strong><code>CVE-2024-54089</code></strong></a> – Weak Encryption Mechanism Vulnerability in Siemens Apogee PXC and Talon TC Devices</li><li><a href="https://cert-portal.siemens.com/productcert/html/ssa-615116.html" rel="noreferrer" target="_blank"><strong><code>CVE-2024-54090</code></strong></a> – Out-of-Bounds Read Vulnerability in Siemens Apogee PXC and Talon TC Devices</li><li><a href="https://cert-portal.siemens.com/productcert/html/ssa-916339.html" rel="noreferrer" target="_blank"><strong><code>CVE-2025-40757</code></strong></a> – Information Disclosure Vulnerability in Siemens Apogee PXC and Talon TC Devices</li></ul><hr class="footnotes-sep"><b>Footnotes</b><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>It is important to caveat that we did not have the firmware for this controller, nor was Ghidra MCP available at the time, so our testing was very much black box. Further, we faced several roadblocks: 1) All symbols, libc or otherwise, needed to be reversed manually. 2) Ghidra flow detection is a bit buggy with PowerPC. 3) Code may be incomplete, since it may be overwritten with data or loaded dynamically.<br><br>Any function/variable names you see in our reversing process are a best guess based on limited information and patterns. In hindsight, our testers recognized there could have been alternative approaches taken, such as grabbing an appropriate libc.so and applying offsets, or reading up on prior research on Nucleus RTOS (which seems to be the underlying RTOS). <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section></div><a id="end-of-article"></a><br><script defer src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><div class="post-share dim-gentle mb-3 d-flex flex-row align-items-center"><div class="d-flex flex-row flex-wrap align-items-center gap-3"><span>Share&nbsp;on</span> <a class="no-decoration" data-sharer="reddit" data-title="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757)" data-url="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><span class="fs-4"><i class="fab fa-reddit"></i> </span></a><a class="no-decoration" data-sharer="telegram" data-title="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757)" data-url="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><span class="fs-4"><i class="fab fa-telegram"></i> </span></a><a class="no-decoration" data-sharer="whatsapp" data-title="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757)" data-url="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><span class="fs-4"><i class="fab fa-whatsapp"></i> </span></a><a class="no-decoration" data-sharer="linkedin" data-title="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757)" data-url="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><span class="fs-4"><i class="fab fa-linkedin"></i> </span></a><a class="no-decoration" data-sharer="vk" data-title="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757)" data-url="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><span class="fs-4"><i class="fab fa-vk"></i> </span></a><a class="no-decoration" data-sharer="twitter" data-title="Reverse Engineering a Siemens Programmable Logic Controller for Funs and Vulns (CVE-2024-54089, CVE-2024-54090 &amp;amp; CVE-2025-40757)" data-url="/posts/reversing-a-siemens-plc-for-funs-and-vulns/"><span class="fs-4"><i class="fab fa-twitter"></i> </span></a><a id="copy-link-button" class="no-decoration" data-bs-toggle="tooltip" data-bs-trigger="click" title="Link copied!"><span class="fs-4"><i class="fas fa-link"></i></span></a></div></div><hr><div id="post-author-container" class="d-flex justify-content-between align-items-center gap-3" itemprop="author" itemscope itemtype="https://schema.org/Person"><img src="/img/profile-icon.jpg" class="profile-img" alt="" loading="lazy" decoding="async" itemprop="image"><div class="author-info d-flex flex-column gap-1"><p class="profile-name" itemprop="name">TrebledJ</p><p class="profile-bio" itemprop="description">Passionate problem-solver, pentester, and autodidact. I thrive on learning new things and enjoy passing it on. When not immersed in bughunting or programming, I can be found taking walks, composing a short tune, and occasionally indulging in CTF challenges.</p></div></div><hr class="section-sep"><div id="related" class="jw-100"><h3><i class="fas fa-circle-nodes me-2"></i>Related Posts</h3><div class="row gx-3 mt-4"><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/output-invariant-prompt-injection/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/output-invariant-prompt-injection/"><img class="post-img-blurred-bg" src="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs" srcset="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-256w.webp 256w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp 512w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1024w.webp 1024w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs" srcset="/img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-256w.webp 256w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-512w.webp 512w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1024w.webp 1024w, /img/posts/infosec/output-invariant-prompt-injection/assets/thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Output-Invariant and Time-Based Testing – Practical Techniques for Black-Box Enumeration of LLMs</h2><div class="post-summary"><p>Abusing inherent context and sluggishness in LLMs for stealthy enumeration of prompt injection points.</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/ai/" itemprop="keywords">ai</a> </span><span><a class="jtag" href="/tags/notes/" itemprop="keywords">notes</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/boomlang-blue-team-strikes-back-et-cvss-and-dllmodules/"><img class="post-img-blurred-bg" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 404" alt="Thumbnail for 5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules" srcset="/img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-256w.webp 256w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-512w.webp 512w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1024w.webp 1024w, /img/posts/misc/satire/2025/assets/weekend-tech-reads-thumbnail-1536w.webp 1536w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">5 Weekend Reads You Missed: BOOMlang v2, Blue Team Strikes Back, ET, CVSS 4.1, and DLLModules</h2><div class="post-summary"><p>Breaking news, awesome stuff happened!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/satire/" itemprop="keywords">satire</a> </span><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/delay-and-interactive-pause-in-multithreaded-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/delay-and-interactive-pause-in-multithreaded-python/"><img class="post-img-blurred-bg" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 384" alt="Thumbnail for Delay and Interactive Pause in Multi-Threaded Python" srcset="/img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-256w.webp 256w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-512w.webp 512w, /img/posts/programming/mini-projects/interactive-pause-python/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Delay and Interactive Pause in Multi-Threaded Python</h2><div class="post-summary"><p>It's like musical chairs for threads (except no one gets left behind)!</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/programming/" itemprop="keywords">programming</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a> </span><span><a class="jtag" href="/tags/tutorial/" itemprop="keywords">tutorial</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/twelve-days-to-secure-your-systems/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/twelve-days-to-secure-your-systems/"><img class="post-img-blurred-bg" src="/img/posts/infosec/secure-your-santa/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for 12 Days of Christmas – Reflections from a Pentester" srcset="/img/posts/infosec/secure-your-santa/assets/thumbnail-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/thumbnail-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/secure-your-santa/assets/thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 512" alt="Thumbnail for 12 Days of Christmas – Reflections from a Pentester" srcset="/img/posts/infosec/secure-your-santa/assets/thumbnail-256w.webp 256w, /img/posts/infosec/secure-your-santa/assets/thumbnail-512w.webp 512w, /img/posts/infosec/secure-your-santa/assets/thumbnail-1024w.webp 1024w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">12 Days of Christmas – Reflections from a Pentester</h2><div class="post-summary"><p>Secure Your Janky Systems, 2024 Edition</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/software-engineering/" itemprop="keywords">software-engineering</a> </span><span><a class="jtag" href="/tags/web/" itemprop="keywords">web</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/abusing-server-side-rendering-in-drogon/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/abusing-server-side-rendering-in-drogon/"><img class="post-img-blurred-bg" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 288" alt="Thumbnail for Dynamic Views Loading – Abusing Server Side Rendering in Drogon" srcset="/img/posts/infosec/drogon-csp/assets/drogon-thumbnail-256w.webp 256w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-512w.webp 512w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1024w.webp 1024w, /img/posts/infosec/drogon-csp/assets/drogon-thumbnail-1600w.webp 1600w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Dynamic Views Loading – Abusing Server Side Rendering in Drogon</h2><div class="post-summary"><p>What could go wrong releasing a C++ web server with "live reload" into the wild?</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/cpp/" itemprop="keywords">cpp</a> </span><span><a class="jtag" href="/tags/ctf/" itemprop="keywords">ctf</a></span></div></div></div></div></article></div><div class="related-col-flex-auto-4"><article class="post-minified-preview"><a href="/posts/automating-boolean-sql-injection-with-python/"></a><div class="d-flex flex-column"><a class="post-thumbnail" href="/posts/automating-boolean-sql-injection-with-python/"><img class="post-img-blurred-bg" src="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 273" alt="Thumbnail for Automating Boolean-Based SQL Injection with Python" srcset="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-256w.webp 256w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp 512w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1024w.webp 1024w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1800w.webp 1800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"><div class="post-img-container d-flex jw-100 h-100"><img class="post-img-contain" src="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp" loading="lazy" decoding="async" style="aspect-ratio: auto 512 / 273" alt="Thumbnail for Automating Boolean-Based SQL Injection with Python" srcset="/img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-256w.webp 256w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-512w.webp 512w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1024w.webp 1024w, /img/posts/infosec/automating-boolean-sqli/assets/automating-boolean-sqli-thumbnail-1800w.webp 1800w" sizes="(max-width: 256px) 256px, (max-width: 512px) 512px, 512px"></div></a><div class="post-content d-flex flex-column justify-content-between"><div><h2 class="post-title">Automating Boolean-Based SQL Injection with Python</h2><div class="post-summary"><p>How to be efficiently lazy at finding hidden gems in predictable places –&nbsp;Database Edition</p></div></div><div class="metadata-tag-container d-flex flex-row align-items-top"><div class="tag-list mt-2 d-flex flex-row flex-wrap align-items-center"><span><a class="jtag" href="/tags/infosec/" itemprop="keywords">infosec</a> </span><span><a class="jtag" href="/tags/sql/" itemprop="keywords">sql</a> </span><span><a class="jtag" href="/tags/python/" itemprop="keywords">python</a></span></div></div></div></div></article></div></div><hr><h3><i class="fas fa-tags me-2"></i>Related Tags</h3><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to c, cpp">software.programming-language</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/cpp/">cpp</a> <a class="jtag" href="/tags/python/">python</a> <a class="jtag" href="/tags/c/">c</a> <a class="jtag" href="/tags/haskell/">haskell</a> <a class="jtag" href="/tags/js/">js</a> <a class="jtag" href="/tags/qt/">qt</a> <a class="jtag" href="/tags/rust/">rust</a> <a class="jtag" href="/tags/qml/">qml</a> <a class="jtag" href="/tags/sql/">sql</a> <a class="jtag" href="/tags/scala/">scala</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to embedded">software.embedded</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/embedded/">embedded</a> <a class="jtag" href="/tags/audio-synthesis-for-dummies/">audio-synthesis-for-dummies</a> <a class="jtag" href="/tags/esp32/">esp32</a> <a class="jtag" href="/tags/iot/">iot</a> <a class="jtag" href="/tags/robotics/">robotics</a> <a class="jtag" href="/tags/stm32/">stm32</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to infosec, pentesting, reverse">software.security</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/ctf/">ctf</a> <a class="jtag" href="/tags/infosec/">infosec</a> <a class="jtag" href="/tags/reverse/">reverse</a> <a class="jtag" href="/tags/pentesting/">pentesting</a> <a class="jtag" href="/tags/pwn/">pwn</a> <a class="jtag" href="/tags/cryptography/">cryptography</a> <a class="jtag" href="/tags/redteam/">redteam</a> <a class="jtag" href="/tags/stego/">stego</a></span></div><div class="mt-3"><h4><abbr data-bs-placement="top" data-bs-toggle="tooltip" title="Related to research, writeup">misc</abbr></h4><span class="d-flex flex-wrap"><a class="jtag" href="/tags/writeup/">writeup</a> <a class="jtag" href="/tags/notes/">notes</a> <a class="jtag" href="/tags/tutorial/">tutorial</a> <a class="jtag" href="/tags/reflection/">reflection</a> <a class="jtag" href="/tags/hkust/">hkust</a> <a class="jtag" href="/tags/project/">project</a> <a class="jtag" href="/tags/experience/">experience</a> <a class="jtag" href="/tags/faith/">faith</a> <a class="jtag" href="/tags/meta/">meta</a> <a class="jtag" href="/tags/learning/">learning</a> <a class="jtag" href="/tags/mathematics/">mathematics</a> <a class="jtag" href="/tags/cheatsheet/">cheatsheet</a> <a class="jtag" href="/tags/research/">research</a> <a class="jtag" href="/tags/satire/">satire</a> <a class="jtag" href="/tags/essay/">essay</a> <a class="jtag" href="/tags/reading/">reading</a></span></div></div><hr class="section-sep"><div class="container-md mt-4 p-4"><a id="comments"></a><p><em>Comments are back! Privacy-focused, without ads, bloatware 🤮, and trackers. Be one of the first to contribute to the discussion — I'd love to hear your thoughts.</em></p><script defer src="https://trebledj.me/js/comentario.min.js"></script><comentario-comments id="comentario" auto-init="false" no-fonts="true" css-override="false" theme="dark"></comentario-comments></div><br></div></div></article></div></div></div><footer class="d-flex flex-column gap-2"><div class="d-flex flex-row gap-3 mx-auto" style="width:fit-content;"><a rel="me noreferrer" href="https://github.com/TrebledJ" target="_blank"><i class="social-icon fab fa-github" style="color:rgb(150, 60, 180) !important;"></i> </a><a rel="me noreferrer" href="https://stackoverflow.com/users/10239789/trebledj" target="_blank"><i class="social-icon fab fa-stack-overflow" style="color:rgb(236, 124, 34) !important;"></i> </a><a rel="me noreferrer" href="https://www.codingame.com/profile/8444100ecb9723c1ec542346b0630aaa2821532" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/codingame.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://soundcloud.com/trebledj" target="_blank"><i class="social-icon fab fa-soundcloud" style="color:rgb(237, 110, 30) !important;"></i> </a><a rel="me noreferrer" href="https://musescore.com/user/20636901" target="_blank"><i class="social-icon d-flex flex-column"><img src="/img/logos/musescore.webp" alt="" loading="lazy" decoding="async"></i></a><a rel="me noreferrer" href="https://discordapp.com/users/220427982798454794" target="_blank"><i class="social-icon fab fa-discord" style="color:rgb(84, 100, 235) !important;"></i> </a><a rel="me" href="mailto:trebledjjj@gmail.com"><i class="social-icon fas fa-envelope"></i> </a><a rel="me" href="/feeds"><i class="social-icon fas fa-square-rss"></i></a></div><p>Copyright&nbsp;©&nbsp;2025&nbsp;TrebledJ • <a href="/privacy-policy">Privacy&nbsp;Policy</a> • <a href="https://github.com/TrebledJ/trebledj.github.io?tab=readme-ov-file#credits--appreciation" rel="noreferrer" target="_blank">Credits</a></p></footer><script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js"></script><script>var tocOptions={}</script><script defer src="/cb/MPnrKnjI5w.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;52d99b3d385b4c9a98ac8ad109a95a2a&quot;}"></script></body></html>