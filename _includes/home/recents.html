{% from "post/carousel.html" import render_carousel %}
{% from "tag.html" import render_tag_list %}

<div class="mt-4">
    {# Recent Posts Section #}
    {{render_carousel(collections, "Recent Posts", post_categories, carouselAutoInterval)}}

    {# Recent Music Section #}
    {% if featuredTracks %}
        <h2 class="mb-0">Recent Music</h2>
        <br/>

        <div class="row">
            {% for track_id in featuredTracks %}
                <div class="col-md-6">
                    {# Track #}
                    {% include "track.html" %}

                    {# Find post and extract summary. #}
                    {% for post in collections.composition %}
                        {% if track_id == post.data.track_id %}
                            <h6><a href="{{post.url}}">{{post.data.title}}</a></h6>
                            <div class="d-flex flex-row flex-wrap align-items-center">
                                <span>
                                    <i class="fa fa-tag post-meta-icon me-2"></i>
                                </span>
                                {{render_tag_list(post.data.tags | exclude(['composition', 'music']), 3)}}
                            </div>

                            <div class="my-2">
                                {{post.content | annihilateTags(['sup', 'h1', 'h2', 'h3']) | truncate(300, false, "...") | safe}}
                            </div>
                        {% endif %}
                    {% endfor %}

                    <br/>
                </div>

            {% endfor %}
        </div>
        <br/>
    {% endif %}

    {# Recent Projects and Experiences Section #}
    {{render_carousel(collections, "Projects and Experiences", project_categories, carouselAutoInterval)}}
</div>